{"title":"Code-execution flaw in VMware has a severity rating of 9.8 out of 10","link":"https://arstechnica.com/?p=1745264","date":1614289698000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><h4>MASS SCANNING THE INTERNET —</h4><h2 itemprop=\"description\">Thousands of servers running vCenter server could be in for a nasty surprise.</h2></div><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2020/12/red-alert-800x533.jpg\" alt=\"Stock photo of a glowing red emergency light\"><figcaption></figcaption></figure><p>Hackers are mass-scanning the Internet in search of VMware servers with a newly disclosed code-execution vulnerability that has a severity rating of 9.8 out of a possible 10.</p><p>CVE-2021-21974, as the security flaw is tracked, is a remote code-execution vulnerability in VMware vCenter server, an application for Windows or Linux that administrators use to enable and manage virtualization of large networks. Within a day of <a href=\"https://www.vmware.com/security/advisories/VMSA-2021-0002.html\" rel=\"nofollow\">VMware issuing a patch</a>, proof-of-concept exploits <a href=\"https://gist.github.com/milo2012/9ba4ac8bb0dfa59497d02b27d820eeb5\">appeared</a> from <a href=\"https://github.com/NS-Sp4ce/CVE-2021-21972\">at</a> <a href=\"http://noahblog.360.cn/vcenter-6-5-7-0-rce-lou-dong-fen-xi/\">least</a> <a href=\"https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC\">six</a> <a href=\"https://github.com/horizon3ai/CVE-2021-21972\">different</a> <a href=\"https://github.com/yaunsky/CVE-2021-21972\">sources</a>. The severity of the vulnerability, combined with the availability of working exploits for both Windows and Linux machines, sent hackers scrambling to actively find vulnerable servers.</p><p>“We’ve detected mass scanning activity targeting vulnerable VMware vCenter servers (<a href=\"https://vmware.com/security/advisories/VMSA-2021-0002.html\" rel=\"nofollow\">https://vmware.com/security/advisories/VMSA-2021-0002.html</a>),” researcher Troy Mursch of Bad Packets wrote.</p><p>Mursch said that the BinaryEdge search engine found almost <a href=\"https://twitter.com/bad_packets/status/1364672466707128320\">15,000 vCenter servers</a> exposed to the Internet, while Shodan searches revealed <a href=\"https://www.shodan.io/search?query=http.title%3A%22ID_VC_Welcome%22\">about 6,700</a>. The mass scanning is aiming to identify servers that have not yet installed the patch, which VMware released on Tuesday.</p><h2>Unfettered code execution, no authorization required</h2><p>CVE-2021-21972 allows hacker with no authorization to upload files to vulnerable vCenter servers that are publicly accessible over port 443, researchers from security firm Tenable <a href=\"https://www.tenable.com/blog/cve-2021-21972-vmware-vcenter-server-remote-code-execution-vulnerability?utm_source=charge&amp;utm_medium=social&amp;utm_campaign=internal-comms\" rel=\"nofollow\">said</a>. Successful exploits will result in hackers gaining unfettered remote code-execution privileges in the underlying operating system. The vulnerability stems from a lack of authentication in the vRealize Operations plugin, which is installed by default.</p><p>The flaw has received a severity score of 9.8 out of 10.0 on the Common Vulnerability Scoring System Version 3.0. Mikhail Klyuchnikov, the Positive Technologies researcher who discovered the vulnerability and privately reported it to VMware, compared the risk posed by CVE-2021-21972 to that of <a href=\"https://arstechnica.com/information-technology/2020/01/unpatched-citrix-vulnerability-now-exploited-patch-weeks-away/\">CVE-2019-19781</a>, a critical vulnerability in the Citrix Application Delivery Controller.</p><p>The Citrix flaw came under active attack last year in <a href=\"https://arstechnica.com/information-technology/2020/09/patient-dies-after-ransomware-attack-reroutes-her-to-remote-hospital/\">ransomware attacks on hospitals</a>, and according to a criminal indictment filed by the Justice Department, in <a href=\"https://arstechnica.com/tech-policy/2020/09/china-sponsored-hackers-charged-for-a-decade-of-alleged-hacks-on-game-makers/\">intrusions into game and software makers</a> by hackers backed by the Chinese government.</p><p>In a <a href=\"https://www.ptsecurity.com/ww-en/about/news/vmware-fixes-dangerous-vulnerabilities-that-threaten-many-large-companies/\">blog post</a> earlier this week, Klyuchnikov wrote:</p><blockquote><p>In our opinion, the RCE vulnerability in the vCenter Server can pose no less a threat than the infamous vulnerability in Citrix (CVE-2019-19781). The error allows an unauthorized user to send a specially crafted request, which will later give them the opportunity to execute arbitrary commands on the server. After receiving such an opportunity, the attacker can develop this attack, successfully move through the corporate network, and gain access to the data stored in the attacked system (such as information about virtual machines and system users). If the vulnerable software can be accessed from the Internet, this will allow an external attacker to penetrate the company’s external perimeter and also gain access to sensitive data. Once again, I would like to note that this vulnerability is dangerous, as it can be used by any unauthorized user.</p></blockquote><p>The researcher provided technical details <a href=\"https://swarm.ptsecurity.com/unauth-rce-vmware/\">here</a>.</p><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/02/vcenter-exploitation.png\" width=\"1007\" height=\"790\"><figcaption><p>Positive Technologies</p></figcaption></figure><p>CVE-2021-21972 affects vCenter Server versions 6.5, 6.7, and 7.01. Users running one of these versions should update to 6.5 U3n, 6.7 U3l, or 7.0 U1c as soon as possible. Those who can’t immediately install a patch should implement <a href=\"https://kb.vmware.com/s/article/82374\">these workarounds</a>, which involve changing a compatibility matrix file and setting the vRealize plugin to incompatible. Admins who have vCenter servers directly exposed to the Internet should strongly consider curbing the practice or at least using a VPN.</p></div></div>","author":"Dan Goodin","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"acdc6f2c8023301c3e5775ffe4ecfab1062a1d9c21219b6b04c17f655057adde","category":"Tech"}