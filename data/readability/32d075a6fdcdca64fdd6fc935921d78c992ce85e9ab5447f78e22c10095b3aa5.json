{"title":"[Dart] สรุปจาก session เรื่อง Why null safety ?","link":"https://www.somkiat.cc/dart-why-null-safety/","date":1621586753000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart00.jpg\" alt=\"\" width=\"526\" height=\"308\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart00.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart00-300x176.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart00-768x451.jpg 768w\" sizes=\"(max-width: 526px) 100vw, 526px\"></figure><p>ใน Flutter 2.2 นั้น <strong><a href=\"https://dart.dev/null-safety/understanding-null-safety\" target=\"_blank\" rel=\"noreferrer noopener\">Null Safety</a></strong> จากภาษา Dart จะเป็นค่า default ให้เลย<br>เนื่องจากก่อนหน้านี้จะต้องทำการ migrate project ตามความต้องการ<br>ดังนั้นเรามาทำความเข้าใจกันว่า<br>ทำไมต้อง Null Safty ด้วย<br>มาจาก VDO ในงาน Google I/O 2021 เรื่อง <strong><a rel=\"noreferrer noopener\" href=\"https://www.youtube.com/watch?v=tP9TcrUZoIs\" target=\"_blank\">Why null safety ?</a></strong><br>เป็นอีก session ที่ชอบมาก ๆ<br>จึงสรุปไว้นิดหน่อย</p><p><strong>เริ่มจาก code ของ Dart จะมีตัวแปร 2 แบบคือ</strong></p><ul><li>Nullable</li><li>Non Nullable</li></ul><p>ตัวอย่างเช่น<br>ถ้าเป็น Non Nullable แต่ดันส่งค่า null เข้าไป<br>จะมี error ดังนี้ ซึ่งเป็น compile time error</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart01.jpg\" alt=\"\" width=\"418\" height=\"241\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart01.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart01-300x173.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart01-768x444.jpg 768w\" sizes=\"(max-width: 418px) 100vw, 418px\"></figure><p><strong>ในทางกลับกัน ถ้ากำหนดให้เป็น Nullable แล้ว พยายามเข้าถึงค่านั้นตรง ๆ</strong></p><p>ก็จะเกิด compile error เช่นกัน เพราว่า อาจจะเกิดปัญหาได้ เพราะว่ามีโอกาสเป็น nullดังนั้นมีโอกาสเกิด NullPointer Exception (NPE) ได้<br><strong><em>ปล. nullable คือการใส่ ? หลังชื่อ type นั่นเอง</em></strong></p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart02.jpg\" alt=\"\" width=\"421\" height=\"236\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart02.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart02-300x169.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart02-768x433.jpg 768w\" sizes=\"(max-width: 421px) 100vw, 421px\"></figure><p><strong>การทำงานนั้น ต้องการ feedback loop ที่รวดเร็ว</strong></p><p>จึงทำการ compile change หลังจากที่แก้ไข<br>หรือเปลี่ยงแปลง code เลยแสดงการทำงานดังรูป</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart03.jpg\" alt=\"\" width=\"417\" height=\"227\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart03.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart03-300x164.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart03-768x419.jpg 768w\" sizes=\"(max-width: 417px) 100vw, 417px\"></figure><p><strong>เปลี่ยนมาให้เร็วขึ้น</strong></p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart04.jpg\" alt=\"\" width=\"415\" height=\"241\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart04.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart04-300x174.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart04-768x446.jpg 768w\" sizes=\"(max-width: 415px) 100vw, 415px\"></figure><p><strong>ส่วนพวก Type checking ยิ่งเร็วมาก ๆ</strong><br>เพราะว่า Dart เป็น static type อยู่แล้ว<br>ทำให้การตรวจสอบง่ายและเร็วขึ้น</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart05.jpg\" alt=\"\" width=\"414\" height=\"237\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dart05.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart05-300x172.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dart05-768x440.jpg 768w\" sizes=\"(max-width: 414px) 100vw, 414px\"></figure><p><strong>หลังจากมี Null Safety ขึ้นมาแล้ว</strong></p><p>การทำงานของ compiler จะลดน้อยลง<br>นั่นคือการทำงานเร็วขึ้นนั่นเอง</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/Screen-Shot-2564-05-21-at-15.05.14-1024x501.png\" alt=\"\" width=\"563\" height=\"275\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/Screen-Shot-2564-05-21-at-15.05.14-1024x501.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/05/Screen-Shot-2564-05-21-at-15.05.14-300x147.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/Screen-Shot-2564-05-21-at-15.05.14-768x375.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/05/Screen-Shot-2564-05-21-at-15.05.14.png 1260w\" sizes=\"(max-width: 563px) 100vw, 563px\"></figure><p><strong>แต่การใช้งานก็ต้องระวังด้วยเช่นกัน เพราะว่า ถ้าใช้ผิดก็เกิดปัญหาได้เช่นกัน</strong></p><p>ยกตัวอย่างการ force cast แบบนี้</p><div itemprop=\"text\" id=\"gist109620636\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-demo02-dart-L1\" data-line-number=\"1\"></td><td id=\"file-demo02-dart-LC1\"><span>main</span>(<span>List</span><span>&lt;</span><span>String</span><span>&gt;</span> args) {</td></tr><tr><td id=\"file-demo02-dart-L2\" data-line-number=\"2\"></td><td id=\"file-demo02-dart-LC2\"><span>// Nullable</span></td></tr><tr><td id=\"file-demo02-dart-L3\" data-line-number=\"3\"></td><td id=\"file-demo02-dart-LC3\"><span>String</span><span>?</span> name;</td></tr><tr><td id=\"file-demo02-dart-L4\" data-line-number=\"4\"></td><td id=\"file-demo02-dart-LC4\"><span>if</span> (args.isNotEmpty) {</td></tr><tr><td id=\"file-demo02-dart-L5\" data-line-number=\"5\"></td><td id=\"file-demo02-dart-LC5\">name <span>=</span> args[<span>0</span>];</td></tr><tr><td id=\"file-demo02-dart-L6\" data-line-number=\"6\"></td><td id=\"file-demo02-dart-LC6\"><span>print</span>(name);</td></tr><tr><td id=\"file-demo02-dart-L7\" data-line-number=\"7\"></td><td id=\"file-demo02-dart-LC7\">}</td></tr><tr><td id=\"file-demo02-dart-L8\" data-line-number=\"8\"></td><td id=\"file-demo02-dart-LC8\"><span>print</span>(name);</td></tr><tr><td id=\"file-demo02-dart-L9\" data-line-number=\"9\"></td><td id=\"file-demo02-dart-LC9\">}</td></tr><tr><td id=\"file-demo02-dart-L10\" data-line-number=\"10\"></td><td id=\"file-demo02-dart-LC10\"></td></tr><tr><td id=\"file-demo02-dart-L11\" data-line-number=\"11\"></td><td id=\"file-demo02-dart-LC11\"><span>String</span> <span>ack</span>(<span>bool</span> value) {</td></tr><tr><td id=\"file-demo02-dart-L12\" data-line-number=\"12\"></td><td id=\"file-demo02-dart-LC12\"><span>var</span> response <span>=</span> {<span>true</span><span>:</span> <span>'yes'</span>, <span>false</span><span>:</span> <span>'no'</span>};</td></tr><tr><td id=\"file-demo02-dart-L13\" data-line-number=\"13\"></td><td id=\"file-demo02-dart-LC13\"><span>// ใช้เมื่อมั่นใจเท่านั้นว่ามีค่าเสมอ มิเช่นนั้นจะเกิด NPE ขึ้นได้</span></td></tr><tr><td id=\"file-demo02-dart-L14\" data-line-number=\"14\"></td><td id=\"file-demo02-dart-LC14\"><span>return</span> response[value]<span>!</span>;</td></tr><tr><td id=\"file-demo02-dart-L15\" data-line-number=\"15\"></td><td id=\"file-demo02-dart-LC15\">}</td></tr></tbody></table></div><p><strong>ดังนั้นถ้าใครยังไม่ใช้ ก็ใช้ได้แล้วนะ</strong></p><p>จะเจอสัญลักษณะเพิ่มมาอีก 2 ตัวคือ ? และ !<br>รวมทั้งตัวแปรประกาศขึ้นมา แต่ไม่ทำการ initial ค่าให้ ก็ error ด้วย<br>ดังนั้นลอง migrate หรือเปลี่ยนกันดูครับ<br>ผมเพิ่งเปลี่ยนไป 1 project สนุกสนานมาก ๆ</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"32d075a6fdcdca64fdd6fc935921d78c992ce85e9ab5447f78e22c10095b3aa5","category":"Thai"}