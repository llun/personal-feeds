{"title":"Attackers are trying awfully hard to backdoor iOS developers’ Macs","link":"https://arstechnica.com/?p=1750544","date":1616072440000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><h4>CHECK FOR RUN SCRIPTS —</h4><h2 itemprop=\"description\">XcodeSpy uses malicious Xcode project to install the EggShell backdoor.</h2></div><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/02/mac-800x534.jpg\" alt=\"Close-up photograph of Mac keyboard and toolbar.\"><figcaption></figcaption></figure><p>Researchers said they’ve found a trojanized code library in the wild that attempts to install advanced surveillance malware on the Macs of iOS software developers.</p><p>It came in the form of a malicious project the attacker wrote for Xcode, a developer tool that Apple makes freely available to developers writing&nbsp;apps for&nbsp;iOS&nbsp;or another Apple OS. The project was a copy of <a href=\"https://github.com/potato04/TabBarInteraction\">TabBarInteraction</a>, a legitimate open source project that makes it easier for developers to animate iOS tab bars based on user interaction. An Xcode project is a repository for all the files, resources, and information needed to build an app.</p><h2>Walking on eggshells</h2><p>Alongside the legitimate code was an obfuscated script, known as a “Run Script.” The script, which got executed whenever the developer build was launched, contacted an attacker-controlled server to download and install a custom version of <a href=\"https://github.com/neoneggplant/EggShell\">EggShell</a>, an open source back door that spies on users through their mic, camera and keyboard.</p><p>Researchers with SentinelOne, the security firm that discovered the trojanized project, have named it XcodeSpy. They say they’ve uncovered two variants of the customized EggShell dropped by the malicious project. Both were uploaded to VirusTotal using the Web interface from Japan, the first one last August 5, and the second one on the following October 13.</p><p>“The later sample was also found in the wild in late 2020 on a victim’s Mac in the United States,” SentinelOne researcher Phil Stokes wrote in a blog post <a href=\"https://www.sentinelone.com/blog/\">Thursday</a>. “For reasons of confidentiality, we are unable to provide further details about the ITW [in the wild] incident. However, the victim reported that they are repeatedly targeted by North Korean APT actors and the infection came to light as part of their regular threat hunting activities.”</p><p>So far, company researchers are aware of only one in-the-wild case, from a US-based organization. Indications from the SentinelOne analysis suggest the campaign was \"in operation at least between July and October 2020 and may also have targeted developers in Asia.\"</p><h2>Developers under attack</h2><p>Thursday’s post came two months after researchers for both Microsoft and Google said that hackers backed by the North Korean government were actively trying to infect security researchers' computers. To win researchers’ trust, the hackers spent weeks building Twitter personas and developing working relationships online.</p><p>Eventually, the fake Twitter profiles asked the researchers to use Internet Explorer to open a webpage. Those who took the bait would find that their fully patched Windows 10 machine installed a malicious service and an in-memory backdoor. Microsoft <a href=\"https://arstechnica.com/gadgets/2021/03/microsoft-patches-critical-0day-that-north-korea-used-to-target-researchers/\">patched the vulnerability</a> last week.</p><p>Besides using the watering-hole attack, the hackers also sent targeted developers a Visual Studio Project purportedly containing source code for a proof-of-concept exploit. Stashed inside the project was custom malware that contacted the attackers' control server.</p><h2>Obfuscated malice</h2><p>Experienced developers have long known the importance of checking for the presence of malicious Run Scripts before using a third-party Xcode project. While detecting the scripts isn’t hard, XcodeSpy attempted to make the job harder by encoding the script.</p><figure><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/xcodespy-script-obfuscated.jpg\" data-height=\"635\" data-width=\"1247\"><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/xcodespy-script-obfuscated-640x326.jpg\" width=\"640\" height=\"326\" srcset=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/xcodespy-script-obfuscated.jpg 2x\"></a><figcaption><p>SentinelOne</p></figcaption></figure><p>When decoded, it was clear the script contacted a server at cralev[.]me and sent the mysterious command mdbcmd through a reverse shell built in to the server.</p><figure><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/xcodespy-script-unobfuscated.jpg\" data-height=\"527\" data-width=\"1246\"><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/xcodespy-script-unobfuscated-640x271.jpg\" width=\"640\" height=\"271\" srcset=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/xcodespy-script-unobfuscated.jpg 2x\"></a><figcaption><p>SentinelOne</p></figcaption></figure><p>The only warning a developer would get after running the Xcode project would be something that looks like this:</p><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/warning.png\" width=\"260\" height=\"334\"><figcaption><p>Patrick Wardle</p></figcaption></figure><p>SentinelOne provides a script that makes it easy for developers to find Run Scripts in their projects. Thursday’s post also provides indicators of compromise to help developers figure out if they’ve been targeted or infected.</p><h2>A vector for malice</h2><p>It’s not the first time Xcode has been used in a malware attack. Last August, researchers uncovered Xcode projects available online that embedded exploits for what at the time were two Safari zero-day vulnerabilities. As soon as one of the XCSSET projects was opened and built, a <a href=\"https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf\">TrendMicro analysis</a> found, the malicious code would run on the developers’ Macs.</p><p>And in 2015, researchers <a href=\"https://arstechnica.com/information-technology/2015/09/xcodeghost-apps-haunting-ios-app-store-more-numerous-than-first-reported/\">found 4,000 iOS apps</a> that had been infected by XcodeGhost, the name given to a tampered version of Xcode that circulated primarily in Asia. Apps that were compiled with XcodeGhost could be used by attackers to read and write to the device clipboard, open specific URLs and exfiltrate data.</p><p>In contrast to XcodeGhost, which infected apps, XcodeSpy targeted developers. Given the quality of the surveillance backdoor XcodeSpy installed, it wouldn’t be much of a stretch for the attackers to eventually deliver malware to users of the developer’s software as well.</p><p>“There are other scenarios with such high-value victims,” SentinelOne’s Stokes wrote. “Attackers could simply be trawling for interesting targets and gathering data for future campaigns, or they could be attempting to gather AppleID credentials for use in other campaigns that use malware with valid Apple Developer code signatures. These suggestions do not exhaust the possibilities, nor are they mutually exclusive.”</p></div></div>","author":"Dan Goodin","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"0e80db1ebabd0f4d068b62587190ce3f7fb2117cd1ebcbd4a121d188eceaf90b","category":"Tech"}