{"title":"ว่าด้วยเรื่องของ Serial ใน PostgreSQL","link":"https://www.somkiat.cc/serial-in-postgresql/","date":1615533239000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/03/postgresql.jpeg\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/03/postgresql.jpeg 800w, https://www.somkiat.cc/wp-content/uploads/2021/03/postgresql-300x150.jpeg 300w, https://www.somkiat.cc/wp-content/uploads/2021/03/postgresql-768x384.jpeg 768w\" sizes=\"(max-width: 800px) 100vw, 800px\"></figure><p>พอดีนั่งอ่านหนังสือไปเรื่อย ๆ<br>ก็เจอคำถามใน <strong><a rel=\"noreferrer noopener\" href=\"https://www.facebook.com/groups/584867114995854/permalink/1900049303477622\" target=\"_blank\">facebook เรื่องของการ กำหนด Primary key ใน PostgreSQL</a></strong><br>ซึ่งมีทั้งการใช้ Serial, Primary key และ Constraint<br>จึงลองไปดูการทำงานของ Serial หน่อยว่าเป็นอย่างไร ?</p><p><strong>ปกติแล้วนั้น serial ใน PostgreSQL มันคือ</strong></p><p>auto increment ใน MySQL/SQLite นั่นเอง<br>มักจะใช้งานแบบนี้</p><div itemprop=\"text\" id=\"gist108408824\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-1-txt-L1\" data-line-number=\"1\"></td><td id=\"file-1-txt-LC1\">create table test (</td></tr><tr><td id=\"file-1-txt-L2\" data-line-number=\"2\"></td><td id=\"file-1-txt-LC2\">id serial</td></tr><tr><td id=\"file-1-txt-L3\" data-line-number=\"3\"></td><td id=\"file-1-txt-LC3\">)</td></tr></tbody></table></div><p><strong>การทำงานภายในจะเป็นดังนี้</strong></p><div itemprop=\"text\" id=\"gist108408824\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-2-txt-L1\" data-line-number=\"1\"></td><td id=\"file-2-txt-LC1\">CREATE SEQUENCE test_id_seq;</td></tr><tr><td id=\"file-2-txt-L2\" data-line-number=\"2\"></td><td id=\"file-2-txt-LC2\"></td></tr><tr><td id=\"file-2-txt-L3\" data-line-number=\"3\"></td><td id=\"file-2-txt-LC3\">CREATE TABLE table_name (</td></tr><tr><td id=\"file-2-txt-L4\" data-line-number=\"4\"></td><td id=\"file-2-txt-LC4\">id integer NOT NULL DEFAULT nextval('test_id_seq')</td></tr><tr><td id=\"file-2-txt-L5\" data-line-number=\"5\"></td><td id=\"file-2-txt-LC5\">);</td></tr><tr><td id=\"file-2-txt-L6\" data-line-number=\"6\"></td><td id=\"file-2-txt-LC6\"></td></tr><tr><td id=\"file-2-txt-L7\" data-line-number=\"7\"></td><td id=\"file-2-txt-LC7\">ALTER SEQUENCE test_id_seq OWNED BY test.id;</td></tr></tbody></table></div><p><strong>Data type ที่ PostgreSQL มีให้เลือกคือ</strong></p><ul><li>SMALLSERIAL ค่าระหว่าง 1-32,767</li><li>SERIAL ค่าระหว่าง 1-2,147,483,647</li><li>BIGSERIAL ค่าระหว่าง 1-9,223,372,036,854,775,807</li></ul><p><strong>โดยที่การทำงานของ Serial เป็นดังนี้</strong><br>ค่าของ sequence number <strong>จะเริ่มที่ 1 และเพิ่มครั้งละ 1</strong><br>Constraint ที่มาพร้อมคือ <strong>NOT NULL</strong><br>ส่วน Primary หรือ Unique key ไม่จำเป็นต้องใส่<br>มันขึ้นอยู่ที่ความต้องการของเราเอง</p><p><strong>ถ้าเป็น Primary Key ง่าย ๆ ก็ใช้งานแบบนี้</strong></p><div itemprop=\"text\" id=\"gist108408824\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-3-txt-L1\" data-line-number=\"1\"></td><td id=\"file-3-txt-LC1\">create table test (</td></tr><tr><td id=\"file-3-txt-L2\" data-line-number=\"2\"></td><td id=\"file-3-txt-LC2\">id serial primary key</td></tr><tr><td id=\"file-3-txt-L3\" data-line-number=\"3\"></td><td id=\"file-3-txt-LC3\">)</td></tr></tbody></table></div><p><strong>แต่ถ้าเป็น composite key ก็ใช้งาน constraint จะเหมาะสมกว่า</strong></p><div itemprop=\"text\" id=\"gist108408824\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-4-txt-L1\" data-line-number=\"1\"></td><td id=\"file-4-txt-LC1\">CREATE TABLE test (</td></tr><tr><td id=\"file-4-txt-L2\" data-line-number=\"2\"></td><td id=\"file-4-txt-LC2\">id1 serial NOT NULL,</td></tr><tr><td id=\"file-4-txt-L3\" data-line-number=\"3\"></td><td id=\"file-4-txt-LC3\">id2 serial NOT NULL,</td></tr><tr><td id=\"file-4-txt-L4\" data-line-number=\"4\"></td><td id=\"file-4-txt-LC4\">CONSTRAINT test_pk PRIMARY KEY (id1, id2)</td></tr><tr><td id=\"file-4-txt-L5\" data-line-number=\"5\"></td><td id=\"file-4-txt-LC5\">);</td></tr></tbody></table></div><p>ลองใช้งานกันดูครับ</p><p><strong>Reference Websites</strong></p><p><a href=\"https://www.postgresql.org/docs/9.1/datatype-numeric.html\" target=\"_blank\" rel=\"noreferrer noopener\">PostgreSQL Documentation :: Numeric Type</a></p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"5b9044b8d3f9f7d2637b72a161686216ae1f9d26cba09f3ac9ebfb27b71d330f","category":"Thai"}