{"title":"ว่าง ๆ มาลองเล่น Go 1.16 rc 1 กันหน่อย","link":"https://www.somkiat.cc/go-1-16-rc-1/","date":1611997366000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>January 30, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/01/golang-1024x576.jpg\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/01/golang-1024x576.jpg 1024w, https://www.somkiat.cc/wp-content/uploads/2021/01/golang-300x169.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/01/golang-768x432.jpg 768w, https://www.somkiat.cc/wp-content/uploads/2021/01/golang.jpg 1280w\" sizes=\"(max-width: 1024px) 100vw, 1024px\"></figure><p>เห็นว่า Go เพิ่มปล่อย <strong><a rel=\"noreferrer noopener\" href=\"https://groups.google.com/g/golang-announce/c/U_FUHY4wuSc/m/3_Vw3oqpAgAJ?pli=1\" target=\"_blank\">version 1.16 RC 1</a></strong> มาให้ลองใช้งานกัน<br>ก็เลยลองเล่นกันหน่อยว่า มีอะไรที่เปลี่ยนแปลงไปบ้าง<br>ในการใช้งานทั่วไป มาดูกัน</p><p>โดยก่อนหน้าที่อธิบายเรื่อง <a rel=\"noreferrer noopener\" href=\"https://www.somkiat.cc/go-embed/\" target=\"_blank\">Embed package</a> ไปแล้ว</p><p><strong>ในการทดสอบ ถ้าเจอ code ใช้ในงาน os.Exit(int) แล้ว การทดสอบนั้นจะ fail ทันที</strong></p><p>ซึ่งแตกต่างจากเดิมคือ ไม่สนใจ<br>ทำให้การทดสอบนั้น ๆ ผ่าน</p><p>รวมทั้งการ run test ได้ต้อง runใน project ที่เป็น go module เท่านั้น</p><div itemprop=\"text\" id=\"gist107648793\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-2-txt-L1\" data-line-number=\"1\"></td><td id=\"file-2-txt-LC1\">// ทำการ run test ใน project ที่ไม่ใช่ go module</td></tr><tr><td id=\"file-2-txt-L2\" data-line-number=\"2\"></td><td id=\"file-2-txt-LC2\">$go1.16rc1 test</td></tr><tr><td id=\"file-2-txt-L3\" data-line-number=\"3\"></td><td id=\"file-2-txt-LC3\"></td></tr><tr><td id=\"file-2-txt-L4\" data-line-number=\"4\"></td><td id=\"file-2-txt-LC4\">go: cannot find main module; see 'go help modules'</td></tr><tr><td id=\"file-2-txt-L5\" data-line-number=\"5\"></td><td id=\"file-2-txt-LC5\"></td></tr><tr><td id=\"file-2-txt-L6\" data-line-number=\"6\"></td><td id=\"file-2-txt-LC6\"></td></tr><tr><td id=\"file-2-txt-L7\" data-line-number=\"7\"></td><td id=\"file-2-txt-LC7\">// เมื่อทดสอบเจอ code ที่ใช้งาน os.Exit()</td></tr><tr><td id=\"file-2-txt-L8\" data-line-number=\"8\"></td><td id=\"file-2-txt-LC8\">$go1.16rc1 test</td></tr><tr><td id=\"file-2-txt-L9\" data-line-number=\"9\"></td><td id=\"file-2-txt-LC9\"></td></tr><tr><td id=\"file-2-txt-L10\" data-line-number=\"10\"></td><td id=\"file-2-txt-LC10\">panic: unexpected call to os.Exit(0) during test [recovered]</td></tr><tr><td id=\"file-2-txt-L11\" data-line-number=\"11\"></td><td id=\"file-2-txt-LC11\">panic: unexpected call to os.Exit(0) during test</td></tr><tr><td id=\"file-2-txt-L12\" data-line-number=\"12\"></td><td id=\"file-2-txt-LC12\"></td></tr><tr><td id=\"file-2-txt-L13\" data-line-number=\"13\"></td><td id=\"file-2-txt-LC13\">goroutine 8 [running]:</td></tr><tr><td id=\"file-2-txt-L14\" data-line-number=\"14\"></td><td id=\"file-2-txt-LC14\">testing.tRunner.func1.2(0x111acc0, 0x116c410)</td></tr></tbody></table></div><p><strong>เพิ่ม env ตัวใหม่ชื่อว่า GOVCS เข้ามา</strong></p><p>สำหรับกำหนดว่า จะทำการ download source code ของ library ต่าง ๆ มาจากไหน<br>โดยค่า default คือ git และ hg</p><p><strong>เพิ่ม Package ใหม่ชื่อว่า io/fs เข้ามา สำหรับการอ่านไฟล์และ directory เท่านั้น</strong></p><p>โดยการใช้งานผ่าน interface ชื่อว่า fs.FS ดังนี้</p><div itemprop=\"text\" id=\"gist107648793\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-fs-go-L1\" data-line-number=\"1\"></td><td id=\"file-fs-go-LC1\"><span>type</span> <span>FS</span> <span>interface</span> {</td></tr><tr><td id=\"file-fs-go-L2\" data-line-number=\"2\"></td><td id=\"file-fs-go-LC2\"><span>// Open opens the named file.</span></td></tr><tr><td id=\"file-fs-go-L3\" data-line-number=\"3\"></td><td id=\"file-fs-go-LC3\"><span>//</span></td></tr><tr><td id=\"file-fs-go-L4\" data-line-number=\"4\"></td><td id=\"file-fs-go-LC4\"><span>// When Open returns an error, it should be of type *PathError</span></td></tr><tr><td id=\"file-fs-go-L5\" data-line-number=\"5\"></td><td id=\"file-fs-go-LC5\"><span>// with the Op field set to \"open\", the Path field set to name,</span></td></tr><tr><td id=\"file-fs-go-L6\" data-line-number=\"6\"></td><td id=\"file-fs-go-LC6\"><span>// and the Err field describing the problem.</span></td></tr><tr><td id=\"file-fs-go-L7\" data-line-number=\"7\"></td><td id=\"file-fs-go-LC7\"><span>//</span></td></tr><tr><td id=\"file-fs-go-L8\" data-line-number=\"8\"></td><td id=\"file-fs-go-LC8\"><span>// Open should reject attempts to open names that do not satisfy</span></td></tr><tr><td id=\"file-fs-go-L9\" data-line-number=\"9\"></td><td id=\"file-fs-go-LC9\"><span>// ValidPath(name), returning a *PathError with Err set to</span></td></tr><tr><td id=\"file-fs-go-L10\" data-line-number=\"10\"></td><td id=\"file-fs-go-LC10\"><span>// ErrInvalid or ErrNotExist.</span></td></tr><tr><td id=\"file-fs-go-L11\" data-line-number=\"11\"></td><td id=\"file-fs-go-LC11\"><span>Open</span>(<span>name</span> <span>string</span>) (<span>File</span>, <span>error</span>)</td></tr><tr><td id=\"file-fs-go-L12\" data-line-number=\"12\"></td><td id=\"file-fs-go-LC12\">}</td></tr></tbody></table></div><p>ยังไม่พอนะ ได้เตรียม <strong><a rel=\"noreferrer noopener\" href=\"https://tip.golang.org/pkg/testing/fstest/\" target=\"_blank\">package testing/fstest</a></strong> ใช้สำหรับการทดสอบให้อีกด้วย<br>ซึ่งจะทำการจำลองในหน่วยความจำให้แทน<br>ทำให้การทดสอบง่ายขึ้นไปอีก</p><p>ส่วน package <strong><a rel=\"noreferrer noopener\" href=\"https://tip.golang.org/pkg/io/ioutil/\" target=\"_blank\">io/ioutil</a></strong> นั้นถูก deprecated แล้ว<br>ใครใช้งานอยู่หรือคิดจะใช้งาน ก็เปลี่ยนได้แล้ว</p><p>จากที่ทดสอบการ build พบว่า ขนาดของไฟล์ binary ที่ได้เล็กลงอีกแล้ว !!</p><p>อ่านการเปลี่ยนแปลงเพิ่มได้ที่ <strong><a href=\"https://tip.golang.org/doc/go1.16\" target=\"_blank\" rel=\"noreferrer noopener\">Go 1.16 Release Notes</a></strong></p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"6800485181c4fc6c593f34bf9cb8e432a3fd718f738719e1103d3b5da780ffcf","category":"Thai"}