{"title":"There’s a vexing mystery surrounding the 0-day attacks on Exchange servers","link":"https://arstechnica.com/?p=1748741","date":1615468176000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><header><h4>overachievers —</h4><h2 itemprop=\"description\">A half-dozen groups exploiting the same 0-days is unusual, if not unprecedented.</h2></header><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/02/zeroday-800x534.jpg\" alt=\"The phrase Zero Day can be spotted on a monochrome computer screen clogged with ones and zeros.\"><figcaption></figcaption></figure><p>The Microsoft Exchange vulnerabilities that allow hackers to take over Microsoft Exchange servers are under attack by no fewer than 10 advanced hacking groups, six of which began exploiting them before Microsoft released a patch, researchers reported Wednesday. That raises a vexing mystery: how did so many separate threat actors have working exploits before the security flaws became publicly known?</p><p>Researchers say that as many as 100,000 mail servers around the world have been compromised, with those for the <a href=\"https://www.eba.europa.eu/cyber-attack-european-banking-authority-update-3\">European Banking Authority</a> and <a href=\"https://www.reuters.com/article/norway-cyber/update-3-norways-parliament-hit-by-new-hack-attack-idUSL8N2L855J\">Norwegian Parliament</a> being disclosed in the past few days. Once attackers gain the ability to execute code on the servers, they install web shells, which are browser-based windows that provide a means for remotely issuing commands and executing code.</p><p>When Microsoft issued emergency patches on March 2, the company said the vulnerabilities were being exploited in limited and targeted attacks by a state-backed hacking group in China known as Hafnium. On Wednesday, ESET provided a starkly different assessment. Of the 10 groups ESET products have recorded exploiting vulnerable servers, six of those APTs—short for advanced persistent threat actors—began hijacking servers while the critical vulnerabilities were still unknown to Microsoft.</p><p>It’s not often a so-called zero-day vulnerability is exploited by two groups in unison, but it happens. A zero-day under attack by six APTs simultaneously, on the other hand, is highly unusual, if not unprecedented.</p><p>“Our ongoing research shows that not only Hafnium has been using the recent RCE vulnerability in Exchange, but that multiple APTs have access to the exploit, and some even did so prior to the patch release,” ESET researchers Matthieu Faou, Mathieu Tartare, and Thomas Dupuy wrote in a <a href=\"https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/\">Wednesday post</a>. “It is still unclear how the distribution of the exploit happened, but it is inevitable that more and more threat actors, including ransomware operators, will have access to it sooner or later.”</p><figure><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/eset-timeline.png\" data-height=\"641\" data-width=\"1200\"><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/eset-timeline-640x342.png\" width=\"640\" height=\"342\" srcset=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/eset-timeline.png 2x\"></a><figcaption><p>ESET</p></figcaption></figure><h2>Beyond unlikely</h2><p>The mystery is compounded by this: within a day of Microsoft issuing the patches, at least three more APTs joined the fray. A day later, another one was added to the mix. While it’s possible those four groups reverse engineered the fixes, developed weaponized exploits, and deployed them at scale, those types of activities usually take time. A 24-hour window is on the short side.</p><p>There’s no clear explanation for the mass exploitation by so many different groups, leaving researchers few alternatives other than to speculate.</p><p>“It would seem that while the exploits were originally used by Hafnium, something made them share the exploit with other groups around the time the associated vulnerabilities were getting parched by Microsoft,” Costin Raiu, director of the Global Research and Analysis Team at Kaspersky Lab, told me. “This could suggest a certain degree of cooperation between these groups, or it may also suggest the exploits were available for sale in certain markets and the potential of them getting patched resulted in a drop of price, allowing others to acquire it as well.”</p><p>Juan Andres Guerrero-Saade, principal threat researcher at security firm SentinelOne, arrived at largely the same assessment.</p><p>“The idea that six groups coming from the same region would independently discover the same chain of vulnerabilities and develop the same exploit is beyond unlikely,” he wrote in a direct message. “The simpler explanation is that there's (a) an exploit seller in common, (b) an unknown source (like a forum) available to all of these, or (c) a common entity that organizes these different hacking groups and provided them the exploit to ease their activities (say, China's Ministry of State Security).”</p><h2>Naming names</h2><p>The six groups ESET identified exploiting the vulnerabilities when they were still zero-days are:</p><ul><li><b>Hafnium:</b> The group, which Microsoft said is state sponsored and based in China, was exploiting the vulnerabilities by early January.</li><li><b>Tick (also known as Bronze Butler and RedBaldKnight):</b> On February 28, two days before Microsoft issued patches, this group used the vulnerabilities to compromise the Web server of an East Asian IT services company. Tick has been active since 2018 and targets organizations mostly in Japan but also in South Korea, Russia, and Singapore.</li><li><b>LuckyMouse (APT27 and Emissary Panda):</b> On March 1, this cyberespionage group known to have breached multiple government networks in Central Asia and the Middle East compromised the email server of a governmental entity in the Middle East.</li><li><b>Calypso (with ties to <a href=\"https://st.drweb.com/static/new-www/news/2020/july/Study_of_the_APT_attacks_on_state_institutions_in_Kazakhstan_and_Kyrgyzstan_en.pdf\">Xpath</a>):</b> On March 1, this group compromised the email servers of governmental entities in the Middle East and South America. In the following days, it went on to target organizations in Africa, Asia, and Europe. Calypso targets governmental organizations in these regions.</li><li><b>Websiic:</b> On March 1, this APT, which ESET had never seen before, targeted mail servers belonging to seven Asian companies in the IT, telecommunications, and engineering sectors and one governmental body in Eastern Europe.</li><li><b>Winnti (aka APT 41 and Barium):</b> Just hours before Microsoft released the emergency patches on March 2, ESET data shows this group compromising the email servers of an oil company and a construction equipment company, both based in East Asia.</li></ul><p>ESET said it saw four other groups exploiting the vulnerabilities in the days immediately following Microsoft's release of the patch on March 2. Two unknown groups started the day after. Two other groups, known as Tonto and Mikroceen, began on March 3 and March 4, respectively.</p><h2>China and beyond</h2><p>Joe Slowik, senior security researcher at security firm DomainTools, published his <a href=\"https://www.domaintools.com/resources/blog/examining-exchange-exploitation-and-its-lessons-for-defenders\">own analysis</a> on Wednesday and noted that three of the APTs ESET saw exploiting the vulnerabilities ahead of the patches—Tick, Calypso, and Winnti—have previously been linked to hacking sponsored by the People’s Republic of China. Two other APTs ESET saw exploiting the vulnerabilities a day after the patches—Tonto and Mikroceen—also have ties to the PRC, the researcher said.</p><p>Slowik produced the following timeline:</p><figure><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/domain-tools-timeline.png\" data-height=\"469\" data-width=\"1200\"><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/domain-tools-timeline-640x250.png\" width=\"640\" height=\"250\" srcset=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/domain-tools-timeline.png 2x\"></a><figcaption><p>DomainTools</p></figcaption></figure><p>The timeline includes three exploitation clusters that security firm FireEye <a href=\"https://www.fireeye.com/blog/threat-research/2021/03/detection-response-to-exploitation-of-microsoft-exchange-zero-day-vulnerabilities.html\">has said</a> were exploiting the Exchange vulnerabilities since January. FireEye referred to the groups as UNC2639, UNC2640, and UNC2643 and didn’t tie the clusters to any known APTs or say where they were located.</p><p>Because different security firms use different names for the same threat actors, it's not clear if the groups identified by FireEye overlap with those seen by ESET. If they were distinct, the number of threat actors exploiting the Exchange vulnerabilities prior to a patch would be even higher.</p><h2>A range of organizations under siege</h2><p>The tracking of the APTs came as the FBI and the Cybersecurity and Infrastructure Security Agency issued an <a href=\"https://www.ic3.gov/Media/News/2021/210310.pdf\">advisory</a> on Wednesday that said threat groups are exploiting organizations including local governments, academic institutions, non-governmental organizations, and business entities in a range of industries, including agriculture, biotechnology, aerospace, defense, legal services, power utilities, and pharmaceutical.</p><p>“This targeting is consistent with previous targeting activity by Chinese cyber actors,” the advisory stated. With security firm Palo Alto Networks <a href=\"https://unit42.paloaltonetworks.com/remediation-steps-for-the-microsoft-exchange-server-vulnerabilities/\">reporting</a> on Tuesday that an estimated 125,000 Exchange servers worldwide were vulnerable, CISA and FBI officials’ call for organizations to patch took on an extra measure of urgency.</p><p>Both ESET and security firm Red Canary have seen exploited Exchange servers that were infected with DLTMiner, a piece of malware that allows attackers to mine cryptocurrency using the computing power and electricity of infected machines. ESET, however, said it wasn’t clear if the actors behind those infections had actually exploited the vulnerabilities or simply taken over servers that had already been hacked by someone else.</p><p>With so many of the pre-patch exploits coming from groups tied to the Chinese government, the hypothesis from SentinalOne’s Guerrero-Saade—that a PRC entity provided the exploits to multiple hacking groups ahead of the patches—seems to be the simplest explanation. That theory is further supported by two other PRC-related groups—Tonto and Mikroceen—being among the first to exploit the vulnerabilities following Microsoft’s emergency release.</p><p>Of course, it’s possible that the half-dozen APTs that exploited the vulnerabilities while they were still zero-days independently discovered the vulnerabilities and developed weaponized exploits. If that’s the case, it’s likely a first, and hopefully a last.</p></div></div></div>","author":"Dan Goodin","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"21a07dd36bc81e028dc40a3b539b8f04dbd4acbd3ceffffb665698f41e6aaf5d","category":"Tech"}