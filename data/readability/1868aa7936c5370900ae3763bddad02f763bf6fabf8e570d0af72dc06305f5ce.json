{"title":"สรุปขั้นตอนการสร้าง Docker Image ของระบบที่พัฒนาด้วยภาษา Dart","link":"https://www.somkiat.cc/docker-and-dart/","date":1617689993000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>April 6, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a>, <a href=\"https://www.somkiat.cc/category/tools/\" rel=\"category tag\">Tools</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/04/docker-dart.jpg\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/04/docker-dart.jpg 900w, https://www.somkiat.cc/wp-content/uploads/2021/04/docker-dart-300x160.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/04/docker-dart-768x410.jpg 768w\" sizes=\"(max-width: 900px) 100vw, 900px\"></figure><p>จากบทความของ <strong><a href=\"https://medium.com/google-cloud/build-slim-docker-images-for-dart-apps-ee98ea1d1cf7\" target=\"_blank\" rel=\"noreferrer noopener\">Google Cloud เรื่อง Build slim Docker images for Dart apps</a></strong><br>จากบทความอธิบายวิธีการสร้าง Dockerfile ของระบบงานที่พัฒนาด้วยภาษา Dart<br>เพื่อลดขนาดของ Docker Image ให้เล็กลง<br>และเหมาะสมกับการ run ในโลกของ Container</p><p><strong>เนื่องจาก <a href=\"https://hub.docker.com/r/google/dart\" target=\"_blank\" rel=\"noreferrer noopener\">base image ของ Dart</a> นั้นมีขนาดที่ใหญ่เกินไป</strong></p><p>นั่นคือมีขนาดใหญ่กว่า 600 MB<br>ยกตัวอย่างของการใช้งาน base image ปกติ</p><div itemprop=\"text\" id=\"gist108846121\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-dockerfile-L1\" data-line-number=\"1\"></td><td id=\"file-dockerfile-LC1\"><span>FROM</span> google/dart</td></tr><tr><td id=\"file-dockerfile-L2\" data-line-number=\"2\"></td><td id=\"file-dockerfile-LC2\"><span>WORKDIR</span> /app</td></tr><tr><td id=\"file-dockerfile-L3\" data-line-number=\"3\"></td><td id=\"file-dockerfile-LC3\"><span>COPY</span> . .</td></tr><tr><td id=\"file-dockerfile-L4\" data-line-number=\"4\"></td><td id=\"file-dockerfile-LC4\"><span>CMD</span> [<span>\"dart\"</span>, <span>\"run\"</span>, <span>\"1.dart\"</span>]</td></tr><tr><td id=\"file-dockerfile-L5\" data-line-number=\"5\"></td><td id=\"file-dockerfile-LC5\"></td></tr><tr><td id=\"file-dockerfile-L6\" data-line-number=\"6\"></td><td id=\"file-dockerfile-LC6\"></td></tr><tr><td id=\"file-dockerfile-L7\" data-line-number=\"7\"></td><td id=\"file-dockerfile-LC7\"><span><span>#</span> Size of image</span></td></tr><tr><td id=\"file-dockerfile-L8\" data-line-number=\"8\"></td><td id=\"file-dockerfile-LC8\">REPOSITORY TAG IMAGE ID CREATED SIZE</td></tr><tr><td id=\"file-dockerfile-L9\" data-line-number=\"9\"></td><td id=\"file-dockerfile-LC9\">demo latest f5a4e8b624c1 27 seconds ago 723MB</td></tr></tbody></table></div><p><strong>ดังนั้นจึงทำการแก้ไข เพื่อปรับปรุง</strong></p><p>ด้วยการสร้าง Docker Image ที่สร้างจาก scratch กันไปเลย<br>อยู่ที่ <strong><a href=\"https://github.com/subfuzion/dart-docker-slim/blob/main/Dockerfile\" target=\"_blank\" rel=\"noreferrer noopener\">subfuzion/dart-docker-slim</a></strong><br>จึงนำมาใช้งานดังนี้ เขียนด้วย Docker Multi-stage build<br>โดยขนาดของ image เหลือเพียง 40 MB เท่านั้น</p><div itemprop=\"text\" id=\"gist108846121\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-dockerfile_2-L1\" data-line-number=\"1\"></td><td id=\"file-dockerfile_2-LC1\">FROM google/dart</td></tr><tr><td id=\"file-dockerfile_2-L2\" data-line-number=\"2\"></td><td id=\"file-dockerfile_2-LC2\">WORKDIR /app</td></tr><tr><td id=\"file-dockerfile_2-L3\" data-line-number=\"3\"></td><td id=\"file-dockerfile_2-LC3\">COPY . .</td></tr><tr><td id=\"file-dockerfile_2-L4\" data-line-number=\"4\"></td><td id=\"file-dockerfile_2-LC4\"></td></tr><tr><td id=\"file-dockerfile_2-L5\" data-line-number=\"5\"></td><td id=\"file-dockerfile_2-LC5\">FROM subfuzion/dart-scratch</td></tr><tr><td id=\"file-dockerfile_2-L6\" data-line-number=\"6\"></td><td id=\"file-dockerfile_2-LC6\">COPY --from=0 /usr/lib/dart/bin/dart /usr/lib/dart/bin/dart</td></tr><tr><td id=\"file-dockerfile_2-L7\" data-line-number=\"7\"></td><td id=\"file-dockerfile_2-LC7\">COPY --from=0 /app /app</td></tr><tr><td id=\"file-dockerfile_2-L8\" data-line-number=\"8\"></td><td id=\"file-dockerfile_2-LC8\">EXPOSE 3000</td></tr><tr><td id=\"file-dockerfile_2-L9\" data-line-number=\"9\"></td><td id=\"file-dockerfile_2-LC9\">ENTRYPOINT [\"/usr/lib/dart/bin/dart\", \"/app/1.dart\"]</td></tr><tr><td id=\"file-dockerfile_2-L10\" data-line-number=\"10\"></td><td id=\"file-dockerfile_2-LC10\"></td></tr><tr><td id=\"file-dockerfile_2-L11\" data-line-number=\"11\"></td><td id=\"file-dockerfile_2-LC11\"></td></tr><tr><td id=\"file-dockerfile_2-L12\" data-line-number=\"12\"></td><td id=\"file-dockerfile_2-LC12\"></td></tr><tr><td id=\"file-dockerfile_2-L13\" data-line-number=\"13\"></td><td id=\"file-dockerfile_2-LC13\"># Size of image</td></tr><tr><td id=\"file-dockerfile_2-L14\" data-line-number=\"14\"></td><td id=\"file-dockerfile_2-LC14\">REPOSITORY TAG IMAGE ID CREATED SIZE</td></tr><tr><td id=\"file-dockerfile_2-L15\" data-line-number=\"15\"></td><td id=\"file-dockerfile_2-LC15\">demo latest 6cb107ab0d6a 4 seconds ago 39.7MB</td></tr></tbody></table></div><p>เป็นอีกวิธีการที่น่าสนใจครับ<br>ตามจริงเรายังสามารถใช้ dart compile ได้<br>รวมทั้ง dart2native ได้อีก</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"1868aa7936c5370900ae3763bddad02f763bf6fabf8e570d0af72dc06305f5ce","category":"Thai"}