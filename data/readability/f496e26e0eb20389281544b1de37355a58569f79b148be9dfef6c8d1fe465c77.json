{"title":"Torvalds warns the world: Don’t use the Linux 5.12-rc1 kernel","link":"https://arstechnica.com/?p=1747460","date":1614971422000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><header><h4>haha, swap writes go brrrrrt —</h4><h2 itemprop=\"description\">Please, <em>please</em> don't use cowboy kernels in production—especially not this one!</h2></header><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/untrustworthy-penguin-800x450.jpg\" alt=\"Penguins aren't all equally trustworthy.\"><figcaption><p><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/untrustworthy-penguin.jpg\" data-height=\"1153\" data-width=\"2048\">Enlarge</a> <span>/</span> Penguins aren't all equally trustworthy.</p></figcaption></figure><p>In a message to the Linux Kernel Mailing List <a href=\"https://lwn.net/ml/linux-kernel/CAHk-=wjnzdLSP3oDxhf9eMTYo7GF-QjaNLBUH1Zk3c4A7X75YA@mail.gmail.com/\">yesterday</a>, founding developer Linus Torvalds warned the world not to use the 5.12-rc1 kernel in his public git tree.</p><blockquote><p>Hey peeps - some of you may have already noticed that in my public git tree, the \"v5.12-rc1\" tag has magically been renamed to \"v5.12-rc1-dontuse\". It's still the same object, it still says \"v5.12-rc1\" internally and it is still is signed by me, but the user-visible name of the tag has changed.</p></blockquote><p>As it turns out, when Linus Torvalds flags some code <code>dontuse</code>, he really means it—the problem with this 5.12 release candidate broke swapfile handling in a very unpleasant way. Specifically, the updated code would lose the proper offset pointing to the beginning of the swapfile. Again, in Torvalds' own words, \"swapping still happened, but it happened to the wrong part of the filesystem, with the obvious catastrophic end results.\"</p><p>If your imagination is insufficient, this means that when the kernel paged contents of memory out to disk, the data would land on random parts of the same disk and partition the swapfile lived on... not as files, mind you, but as garbage spewed directly to raw sectors on the disk. This means overwriting not only data in existing files, but also rather large chunks of metadata whose corruption would likely render the entire filesystem unmountable and unusable.</p><p>Torvalds goes on to point out that if you aren't using swap at all, this problem wouldn't bite you. And if you're using swap partitions, rather than swap&nbsp;<em>files</em>, you'd be similarly unaffected. Unfortunately, he then reminds us that while he knows an absolute ton about the kernel, he isn't necessarily all that familiar with all the plumbing a normal end user is concerned with:</p><blockquote><p>And, as far as I know, all the normal distributions set things up with swap partitions, not files, because honestly, swapfiles tend to be slower and have various other complexity issues.</p></blockquote><p><em>Many&nbsp;</em>distributions still default to swap partitions, rather than files. But&nbsp;Ubuntu—which is perhaps the single most widely deployed Linux distribution on the planet—has been&nbsp;<a href=\"https://www.omgubuntu.co.uk/2016/12/ubuntu-17-04-drops-swaps-swap-partitions-swap-files\">installing swapfiles by default</a> for more than four years now. If you're an Ubuntu user (or user of an Ubuntu-derived distro, such as Mint), you've probably got a swapfile, and this bug would probably trash your entire root filesystem.</p><p>Torvalds' warning matters above and beyond what individual users might do with a release candidate kernel, however. It's even more important that kernel developers not base their own work around that release and potentially carry a&nbsp;<em>very</em> nasty bug forward further down the line.</p><blockquote><p>I want to make sure that nobody starts new topic branches using that 5.12-rc1 tag. I know a few developers tend to go \"Ok, rc1 is out, I got all my development work into this merge window, I will now fast-forward to rc1 and&nbsp; use that as a base for the next release\". Don't do it this time. It may work perfectly well for you because you have the common partition setup, but it can end up being a horrible base for anybody else that might end up bisecting into that area.</p></blockquote><p>This also leads into one of my own rather frequent warnings to fellow Linux users: don't blindly leap ahead into cowboy code that hasn't yet been sufficiently tested. Linux kernel release candidates are&nbsp;<em>usually</em> very, very solid, and it's tempting to dive into new features as early as possible—but doing so can have very, very ugly consequences. And many of those consequences could have been avoided by waiting for the code to enter production status in the first place.</p></div></div></div>","author":"Jim Salter","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"f496e26e0eb20389281544b1de37355a58569f79b148be9dfef6c8d1fe465c77","category":"Tech"}