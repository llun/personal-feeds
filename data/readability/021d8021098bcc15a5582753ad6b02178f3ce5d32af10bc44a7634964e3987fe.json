{"title":"Apple M1-native malware has already begun to appear","link":"https://arstechnica.com/?p=1743050","date":1613586674000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><h4>brand new seamy underbelly —</h4><h2 itemprop=\"description\">Security researcher Patrick Wardle discovered M1-native malware targeting macOS.</h2></div><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/02/virus-3497220_1920-800x480.jpg\" alt=\"A stylish emblem which reads \" virus=\"\" alert.=\"\"><figcaption><p><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/02/virus-3497220_1920.jpg\" data-height=\"1152\" data-width=\"1920\">Enlarge</a> <span>/</span> GoSearch22 isn't, technically speaking, any sort of \"virus.\" But it's certainly not anything you'd want on your shiny new M1 Mac.</p></figcaption></figure><p>Last year, Apple released Macbooks and Mac Minis powered by a new ARM CPU—the Apple M1. A few months later, malware authors are already targeting the new hardware directly. Wired <a href=\"https://www.wired.com/story/apple-m1-malware/\">interviewed</a>&nbsp;Mac security research Patrick Wardle, who discovered an M1-native version of the long-running, Mac-targeted <a href=\"https://www.cybereason.com/blog/targetingedge-mac-os-x-pirrit-malware-adware-still-active\">Pirrit</a> adware family.</p><h2>Apple M1, malware, and you</h2><p>ARM CPUs have a very different Instruction Set Architecture (ISA) than traditional x86 desktop and laptop CPUs do, which means that software designed for one ISA can't run on the other without help. M1 Macs can run x86 software with a translation layer called Rosetta, but native M1 apps of course run much faster—as we can see by <a href=\"https://arstechnica.com/gadgets/2020/11/google-chrome-is-available-as-an-apple-m1-native-app-today/\">comparing</a> Rosetta-translated Google Chrome to the M1 native version.</p><p>When it comes to malware, Apple users have long benefited from the minority status of their platform. Ten years ago, macOS's operating system <a href=\"https://gs.statcounter.com/os-market-share/desktop/worldwide/2011\">marketshare</a>&nbsp;was only 6.5%, and few malware authors bothered to target it at all—but today, that marketshare is <a href=\"https://gs.statcounter.com/os-market-share/desktop/worldwide\">approaching</a>&nbsp;20%. That increase in popularity has brought malware vendors along with it; the macOS malware <a href=\"https://www.macworld.co.uk/feature/mac-viruses-list-3668354/\">ecosystem</a> is still tiny and relatively crude compared to the one plaguing Windows, but it's very real.</p><p>The incentive for malware authors to target M1 directly isn't enormous—most existing macOS malware will run on an M1-equipped Mac just fine, via Rosetta 2. Malware authors also don't generally care much about performance—your CPU cycles don't cost them anything, after all. But there are still some benefits to targeting the new hardware directly—the more efficient malware code is, the less likely the owners of the computers it infects will notice it and/or care enough to root it out.</p><h2>Finding M1-native malware</h2><p>Wardle used a researcher account at <a href=\"https://www.virustotal.com/gui/home/search\">VirusTotal</a>&nbsp;to look for instances of M1-native malware. The actual <a href=\"https://objective-see.com/blog/blog_0x62.html\">search</a> he used was `type:macho tag:arm tag:64bits tag:multi-arch tag:signed positives:2+`—which translates to \"signed Apple multi-architecture executables which include 64-bit ARM code, and have been flagged by at least two anti-virus engines.\"</p><p>This search, unfortunately, mostly produces iOS-targeted malware with support for more than one ARM architecture—but it narrowed things down enough for Wardle to manually weed through the results. He eventually found a Safari extension called <code>GoSearch22</code>. The application bundle's <code>Info.plist</code>&nbsp;file confirmed that it was indeed a macOS (not iOS) application.</p><p>The app was&nbsp;signed with Apple developer ID <code>hongsheng_yan</code>&nbsp;in November 2020—but we don't know whether Apple notarized it, since Apple has since revoked its certificate. With that certificate revoked, this version of GoSearch22 won't run on macOS anymore—unless and until its authors manage to sign it with another developer key, at least.</p><p>We can also surmise that this malware app did infect real macOS users in the wild prior to that certificate revocation—otherwise, it's extremely unlikely it would have been user-submitted to VirusTotal in the first place.</p><h2>What does GoSearch22 do?</h2><p>The M1-native malware Wardle found triggered 24 separate malware detection engines. Seventeen of those 24 positives were \"generic\"—but the remaining seven matched it with signatures for the <a href=\"https://macos.checkpoint.com/families/Pirrit/\">Pirrit</a> adware family.</p><p>Pirrit is an extremely long-running malware family which began on Windows, but was eventually ported to macOS. Its presence on macOS was first <a href=\"https://objective-see.com/blog/blog_0x0E.html\">published</a> by researcher Amit Serper in 2016, with a notable follow-up from Serper in <a href=\"https://www.cybereason.com/blog/targetingedge-mac-os-x-pirrit-malware-adware-still-active\">2017</a>.</p><p>If you're interested in where all the bodies are buried—for the Pirrit code itself, and for the TargetingEdge company which proliferates it—I highly recommend Serper's very detailed and informative write-ups. But if you're just looking for the short version: Pirrit variants display unwanted ads, and they're downright&nbsp;<em>nasty</em> about it.</p><p>Once a user has installed whatever shiny Trojan the Pirrit variant in question came wrapped in—which might be a fake video player, PDF reader, or apparently-benign Safari extension—the user's default search engine is changed to something nasty and unhelpful, their web browser usage is tracked, and their visited webpages are infested with unwanted ads.</p><p>This is all bad enough on its own; but Pirrit also uses the full stable of malware tricks to stay installed, avoid detection, and make life generally difficult for anyone trying to \"interfere\" with it. It seeks out and removes applications and browser extensions that could interfere with it, hides from attempts to find it by staying out of the Applications directory, gains root access to the Macs it's installed on, and heavily obfuscates its code in the attempt to make it more difficult to both detect and analyze.</p></div></div>","author":"Jim Salter","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"021d8021098bcc15a5582753ad6b02178f3ce5d32af10bc44a7634964e3987fe","category":"Tech"}