{"title":"Ransomware operators are piling on already hacked Exchange servers","link":"https://arstechnica.com/?p=1751780","date":1616535927000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><h4>PIG PILE —</h4><h2 itemprop=\"description\">The fallout from the Microsoft Exchange server crisis isn't abating just yet.</h2></div><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2016/04/ransom-note-640x360.jpg\" alt=\"A stylized ransom note asks for bitcoin in exchange for stolen data.\"><figcaption></figcaption></figure><p>Microsoft Exchange servers compromised in a first round of attacks are getting infected for a second time by a ransomware gang that is trying to profit from a rash of exploits that caught organizations around the world flat-footed.</p><p>The ransomware—known as Black Kingdom, DEMON, and DemonWare—is demanding $10,000 for the recovery of encrypted data, security researchers said. The malware is getting installed on Exchange servers that were previously infected by attackers exploiting a critical vulnerability in the Microsoft email program. Attacks started while the vulnerability was still a zero-day. Even after Microsoft <a href=\"https://arstechnica.com/information-technology/2021/03/microsoft-issues-emergency-patches-for-4-exploited-0days-in-exchange/\">issued an emergency patch</a>, as many as 100,000 servers that didn’t install it in time <a href=\"https://arstechnica.com/gadgets/2021/03/tens-of-thousands-of-us-organizations-hit-in-ongoing-microsoft-exchange-hack/\">were infected</a>.</p><h2>Opportunity knocks</h2><p>The hackers behind those attacks installed a web shell that allowed anyone who knew the URL to completely control the compromised servers. Black Kingdom was <a href=\"https://www.speartip.com/resources/black-kingdom-ransomware-exploiting-exchange-vulnerabilities/\">spotted last week</a> by Security firm SpearTip. Marcus Hutchins, a security researcher at security firm Kryptos Logic, reported on Sunday that the malware <a href=\"https://twitter.com/MalwareTechBlog/status/1373634465340264451\">didn’t actually encrypt files</a>.</p><p>On Tuesday morning, Microsoft Threat Intelligence Analyst Kevin Beaumont reported that a Black Kingdom attack “does indeed <a href=\"https://twitter.com/GossiTheDog/status/1374327687901220865\">encrypt files</a>.</p><p>Security firm Arete on Monday also <a href=\"https://www.areteir.com/black-kingdom-returns-to-exploit-zero-day-vulnerabilities-in-unpatched-microsoft-exchange-servers/\">disclosed Black Kingdom attacks</a>.</p><p>Black Kingdom was <a href=\"https://blog.redteam.pl/2020/06/black-kingdom-ransomware.html\">spotted last June</a> by security firm RedTeam. The ransomware was taking hold of servers that failed to patch a critical vulnerability in the Pulse VPN software. Black Kingdom also <a href=\"https://any.run/report/63d6c419a8229bc7fc2089a2899d27bac746de0e96368e2a49d7c7754abd29f4/649fff18-14f5-4544-8d04-0a981d2e0c79\">made an appearance</a> at the beginning of last year.</p><p>Brett Callow, a security analyst at Emsisoft, said it wasn’t clear why one of the recent Black Kingdom attacks failed to encrypt data.</p><p>“The initial version encrypted files, while a subsequent version simply renamed them,” he wrote in an email. “Whether both versions are being simultaneously operated is not clear. Nor is it clear why they altered their code—perhaps because the renaming (fake encryption) process would not be detected or blocked by security products?”</p><p>He added that one version of the ransomware is using an encryption method that in many cases allows the data to be restored without paying a ransom. He asked that the method not be detailed to prevent the operators of the ransomware from fixing the flaw.</p><h2>Patching isn’t enough</h2><p>Neither Arete nor Beaumont said if Black Kingdom attacks were hitting servers that had yet to install Microsoft’s emergency patch or if the attackers were simply taking over poorly secured web shells installed earlier by a different group.</p><p>Two weeks ago, Microsoft reported that a separate strain of ransomware named DearCry was taking hold of servers that had been infected by Hafnium. Hafnium is the name the company gave to state-sponsored hackers in China that were the first to use ProxyLogon, the name given to a chain of exploits that gains complete control over vulnerable Exchange servers.</p><p>Security firm SpearTip, however, said that the ransomware was targeting servers “after initial exploitation of the available Microsoft exchange vulnerabilities.” The group installing the competing DearCry ransomware also piggybacked.</p><p>Black Kingdom comes as the number of vulnerable servers in the US dropped to less than 10,000, <a href=\"https://www.politico.com/newsletters/weekly-cybersecurity/2021/03/22/the-latest-microsoft-exchange-numbers-794134\">according to</a> Politico, which cited a National Security Council spokesperson. There were about 120,000 vulnerable systems earlier this month.</p><p>As the follow-on ransomware attacks underscore, patching servers isn’t anywhere near a full solution to the ongoing Exchange server crisis. Even when severs install the security updates, they can still be infected with ransomware if any web shells remain.</p><p>Microsoft is urging affected organizations that don’t have experienced security staff to run <a href=\"https://msrc-blog.microsoft.com/2021/03/15/one-click-microsoft-exchange-on-premises-mitigation-tool-march-2021/\">this</a> one-click mitigation script.</p></div></div>","author":"Dan Goodin","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"c93258be6e0e564a5b109a0e36420cc949bf3cd482dfe7870d7a918757b6f3ca","category":"Tech"}