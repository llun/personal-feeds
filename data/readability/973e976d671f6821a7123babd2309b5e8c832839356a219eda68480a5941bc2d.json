{"title":"ลองใช้งาน Smocker สำหรับการทำ HTTP Mock Server","link":"https://www.somkiat.cc/http-mock-server-with-smocker/","date":1625326777000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-1024x603.png\" alt=\"\" width=\"546\" height=\"321\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-1024x603.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-300x177.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-768x452.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock.png 1352w\" sizes=\"(max-width: 546px) 100vw, 546px\"></figure><div><p>ในการพัฒนาระบบงาน มักจะมีการใช้งาน service อื่น ๆ<br>ผ่าน HTTP protocol ด้วยเสมอ<br>เราจะเรียก service เหล่านั้นว่า dependency</p><p>บ่อยครั้งที่การ integration test มักจะมีปัญหา<br>ดังนั้นจึงต้องทำการจำลอง service เหล่านั้นขึ้นมา<br>เพื่อให้เราสามารถพัฒนาและทดสอบไปได้อย่างราบรื่น<br>หนึ่งในเครื่องมือที่น่าสนใจและลองใช้งานหน่อยคือ <strong><a rel=\"noreferrer noopener\" href=\"https://smocker.dev/\" target=\"_blank\">Smocker</a></strong></p></div><p><strong>Smocker นั้นสามารถทำได้ดังนี้</strong></p><ul><li>Static mock server</li><li>Dynamic mock server</li><li>Proxy</li></ul><p>โดยที่ Smocker มี use case ในการใช้งานดังนี้</p><p><strong>1. ทำตัวเป็น API gateway</strong></p><p>เพื่อทำการจำลอง service ที่ต้องการ<br>รวมทั้งสามารถเรียกใช้งาน service จริงได้อีก</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-01-1024x312.png\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-01-1024x312.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-01-300x92.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-01-768x234.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-01-1536x469.png 1536w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-01-2048x625.png 2048w\" sizes=\"(max-width: 1024px) 100vw, 1024px\"></figure><p><strong>2. ทำตัวเป็น http proxy ก็ได้</strong></p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-02-1024x443.png\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-02-1024x443.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-02-300x130.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-02-768x332.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-02-1536x665.png 1536w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-02.png 1982w\" sizes=\"(max-width: 1024px) 100vw, 1024px\"></figure><p><strong>อีกอย่างที่น่าสนใจคือ พัฒนาด้วยภาษา Go นะ</strong></p><p>แถมมีหน้า UI ในการจัดการแบบง่าย ๆ อีกด้วย</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/07/screenshot-mocks-1024x512.png\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/07/screenshot-mocks-1024x512.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/07/screenshot-mocks-300x150.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/07/screenshot-mocks-768x384.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/07/screenshot-mocks.png 1400w\" sizes=\"(max-width: 1024px) 100vw, 1024px\"></figure><p><strong>การติดตั้งก็มีแบบง่าย ๆ หลายแบบ</strong></p><p>ยกตัวอย่างเช่น Docker กันเลย</p><div itemprop=\"text\" id=\"gist110462616\" translate=\"no\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-1-txt-L1\" data-line-number=\"1\"></td><td id=\"file-1-txt-LC1\">$docker container run -d \\</td></tr><tr><td id=\"file-1-txt-L2\" data-line-number=\"2\"></td><td id=\"file-1-txt-LC2\">-p 8080:8080 \\</td></tr><tr><td id=\"file-1-txt-L3\" data-line-number=\"3\"></td><td id=\"file-1-txt-LC3\">-p 8081:8081 \\</td></tr><tr><td id=\"file-1-txt-L4\" data-line-number=\"4\"></td><td id=\"file-1-txt-LC4\">--name smocker \\</td></tr><tr><td id=\"file-1-txt-L5\" data-line-number=\"5\"></td><td id=\"file-1-txt-LC5\">thiht/smocker</td></tr><tr><td id=\"file-1-txt-L6\" data-line-number=\"6\"></td><td id=\"file-1-txt-LC6\"></td></tr><tr><td id=\"file-1-txt-L7\" data-line-number=\"7\"></td><td id=\"file-1-txt-LC7\"></td></tr><tr><td id=\"file-1-txt-L8\" data-line-number=\"8\"></td><td id=\"file-1-txt-LC8\">Unable to find image 'thiht/smocker:latest' locally</td></tr><tr><td id=\"file-1-txt-L9\" data-line-number=\"9\"></td><td id=\"file-1-txt-LC9\">latest: Pulling from thiht/smocker</td></tr><tr><td id=\"file-1-txt-L10\" data-line-number=\"10\"></td><td id=\"file-1-txt-LC10\">540db60ca938: Already exists</td></tr><tr><td id=\"file-1-txt-L11\" data-line-number=\"11\"></td><td id=\"file-1-txt-LC11\">3c197fa92a79: Pull complete</td></tr><tr><td id=\"file-1-txt-L12\" data-line-number=\"12\"></td><td id=\"file-1-txt-LC12\">6a07bf4b3b9f: Pull complete</td></tr><tr><td id=\"file-1-txt-L13\" data-line-number=\"13\"></td><td id=\"file-1-txt-LC13\">Digest: sha256:12c89dd1859d5a2e8f17d22c5fc1056860bef5dac0a7ad65f9c7e05b1209fba1</td></tr><tr><td id=\"file-1-txt-L14\" data-line-number=\"14\"></td><td id=\"file-1-txt-LC14\">Status: Downloaded newer image for thiht/smocker:latest</td></tr></tbody></table></div><p>ลองสร้าง Mock API ในรูปแบบของ YAML แบบง่าย ๆ<br>ซึ่งเป็นแบบ <strong>Static mock server</strong></p><div itemprop=\"text\" id=\"gist110462616\" translate=\"no\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-api-yml-L1\" data-line-number=\"1\"></td><td id=\"file-api-yml-LC1\">- <span>request</span>:</td></tr><tr><td id=\"file-api-yml-L2\" data-line-number=\"2\"></td><td id=\"file-api-yml-LC2\"><span>method</span>: <span>GET</span></td></tr><tr><td id=\"file-api-yml-L3\" data-line-number=\"3\"></td><td id=\"file-api-yml-LC3\"><span>path</span>: <span>/user/1</span></td></tr><tr><td id=\"file-api-yml-L4\" data-line-number=\"4\"></td><td id=\"file-api-yml-LC4\"><span>response</span>:</td></tr><tr><td id=\"file-api-yml-L5\" data-line-number=\"5\"></td><td id=\"file-api-yml-LC5\"><span>headers</span>:</td></tr><tr><td id=\"file-api-yml-L6\" data-line-number=\"6\"></td><td id=\"file-api-yml-LC6\"><span>Content-Type</span>: <span>application/json</span></td></tr><tr><td id=\"file-api-yml-L7\" data-line-number=\"7\"></td><td id=\"file-api-yml-LC7\"><span>body</span>: <span>&gt;</span></td></tr><tr><td id=\"file-api-yml-L8\" data-line-number=\"8\"></td><td id=\"file-api-yml-LC8\"><span>{</span></td></tr><tr><td id=\"file-api-yml-L9\" data-line-number=\"9\"></td><td id=\"file-api-yml-LC9\"><span>\"id\": 1,</span></td></tr><tr><td id=\"file-api-yml-L10\" data-line-number=\"10\"></td><td id=\"file-api-yml-LC10\"><span>\"name\": \"Demo user\"</span></td></tr><tr><td id=\"file-api-yml-L11\" data-line-number=\"11\"></td><td id=\"file-api-yml-LC11\"><span>}</span></td></tr></tbody></table></div><p><strong>นำไปใส่ผ่าน UI ใน port 8081 ได้เลย</strong></p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-03-1024x432.png\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-03-1024x432.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-03-300x127.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-03-768x324.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-03-1536x648.png 1536w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-03-2048x864.png 2048w\" sizes=\"(max-width: 1024px) 100vw, 1024px\"></figure><p><strong>สามารถใช้งานผ่าน port 8080 ได้ดังนี้</strong></p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-04.png\" alt=\"\" width=\"319\" height=\"173\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/07/mock-04.png 846w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-04-300x163.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/07/mock-04-768x418.png 768w\" sizes=\"(max-width: 319px) 100vw, 319px\"></figure><p>ใช้งานง่ายดี ไว้ไปลองแบบ dynamic และ proxy กันบ้าง<br>น่าจะตอบโจทย์หลาย ๆ เรื่องได้อีกมาก</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"973e976d671f6821a7123babd2309b5e8c832839356a219eda68480a5941bc2d","category":"Thai"}