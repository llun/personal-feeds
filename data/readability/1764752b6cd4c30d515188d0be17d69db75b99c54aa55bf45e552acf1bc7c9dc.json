{"title":"At Least 30,000 U.S. Organizations Newly Hacked via Holes in Microsoft’s Email Software","link":"https://krebsonsecurity.com/2021/03/at-least-30000-u-s-organizations-newly-hacked-via-holes-in-microsofts-email-software/","date":1615060965000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><p>At least 30,000 organizations across the United States — including a significant number of small businesses, towns, cities and local governments — have over the past few days been hacked by an unusually aggressive Chinese cyber espionage unit that’s focused on stealing email from victim organizations, multiple sources tell KrebsOnSecurity. The espionage group is exploiting four newly-discovered flaws in <strong>Microsoft Exchange Server</strong> email software, and has seeded hundreds of thousands of victim organizations worldwide with tools that give the attackers total, remote control over affected systems.</p><p><img loading=\"lazy\" src=\"https://krebsonsecurity.com/wp-content/uploads/2021/03/exchange.png\" alt=\"\" width=\"592\" height=\"200\" srcset=\"https://krebsonsecurity.com/wp-content/uploads/2021/03/exchange.png 1072w, https://krebsonsecurity.com/wp-content/uploads/2021/03/exchange-768x259.png 768w\" sizes=\"(max-width: 592px) 100vw, 592px\"></p><p>On March 2, Microsoft <a href=\"https://krebsonsecurity.com/2021/03/microsoft-chinese-cyberspies-used-4-exchange-server-flaws-to-plunder-emails/\" target=\"_blank\" rel=\"noopener\">released emergency security updates</a> to plug four security holes in Exchange Server versions 2013 through 2019 that hackers were actively using to siphon email communications from Internet-facing systems running Exchange.</p><p>In the three days since then, security experts say the same Chinese cyber espionage group has dramatically stepped up attacks on any vulnerable, unpatched Exchange servers worldwide.</p><p>In each incident, the intruders have left behind a “web shell,” an easy-to-use, password-protected hacking tool that can be accessed over the Internet from any browser. The web shell gives the attackers administrative access to the victim’s computer servers.</p><p>Speaking on condition of anonymity, two cybersecurity experts who’ve briefed U.S. national security advisors on the attack told KrebsOnSecurity the Chinese hacking group thought to be responsible has seized control over “hundreds of thousands” of Microsoft Exchange Servers worldwide — with each victim system representing approximately one organization that uses Exchange to process email.</p><p>Microsoft said the Exchange flaws are being targeted by a previously unidentified Chinese hacking crew it dubbed “<a href=\"https://blogs.microsoft.com/on-the-issues/2021/03/02/new-nation-state-cyberattacks/\" target=\"_blank\" rel=\"noopener\">Hafnium</a>,” and said the group had been conducting targeted attacks on email systems used by a range of industry sectors, including infectious disease researchers, law firms, higher education institutions, defense contractors, policy think tanks, and NGOs.</p><p>Microsoft’s <a href=\"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\" target=\"_blank\" rel=\"noopener\">initial advisory about the Exchange flaws</a> credited Reston, Va. based<a href=\"https://www.volexity.com/\" target=\"_blank\" rel=\"noopener\"> Volexity </a>for reporting the vulnerabilities. Volexity President <strong>Steven Adair</strong> said the company first saw attackers quietly exploiting the Exchange bugs on Jan. 6, 2021, a day when most of the world was glued to television coverage of <a href=\"https://krebsonsecurity.com/2021/01/all-aboard-the-pequod/\" target=\"_blank\" rel=\"noopener\">the riot at the U.S. Capitol</a>.</p><p>But Adair said that over the past few days the hacking group has shifted into high gear, moving quickly to scan the Internet for Exchange servers that weren’t yet protected by the security updates Microsoft released Tuesday.</p><p>“We’ve worked on dozens of cases so far where web shells were put on the victim system back on Feb. 28 [before Microsoft announced its patches], all the way up to today,” Adair said. “Even if you patched the same day Microsoft published its patches, there’s still a high chance there is a web shell on your server. The truth is, if you’re running Exchange and you haven’t patched this yet, there’s a very high chance that your organization is already compromised.”</p><p>Reached for comment, Microsoft said it is working closely with the <strong>U.S. Cybersecurity &amp; Infrastructure Security Agency</strong> (CISA), other government agencies, and security companies, to ensure it is providing the best possible guidance and mitigation for its customers.</p><p>“The best protection is to apply updates as soon as possible across all impacted systems,” a Microsoft spokesperson said in a written statement. “We continue to help customers by providing additional investigation and mitigation guidance. Impacted customers should contact our support teams for additional help and resources.”</p><p>Meanwhile, CISA has issued <a href=\"https://www.cisa.gov/ed2102\" target=\"_blank\" rel=\"noopener\">an emergency directive</a> ordering all federal civilian departments and agencies running vulnerable Microsoft Exchange servers to either update the software or disconnect the products from their networks.</p><p>Adair said he’s fielded dozens of calls today from state and local government agencies that have identified the backdoors in their Exchange servers and are pleading for help. The trouble is, patching the flaws only blocks the four different ways the hackers are using to get in. But it does nothing to undo the damage that may already have been done.</p><div id=\"attachment_54640\"><p><img aria-describedby=\"caption-attachment-54640\" loading=\"lazy\" src=\"https://krebsonsecurity.com/wp-content/uploads/2021/03/chriskrebstweet.png\" alt=\"\" width=\"599\" height=\"329\"></p><p id=\"caption-attachment-54640\">A tweet from Chris Krebs, former director of the Cybersecurity &amp; Infrastructure Security Agency, responding to a tweet from White House National Security Advisor Jake Sullivan.</p></div><p>White House press secretary <strong>Jen Psaki</strong> <a href=\"https://www.reuters.com/article/uk-usa-cyber-microsoft-idUKKCN2AX23L\" target=\"_blank\" rel=\"noopener\">told reporters today</a> the vulnerabilities found in Microsoft’s widely used Exchange servers were “significant,” and “could have far-reaching impacts.”</p><p>“We’re concerned that there are a large number of victims,” Psaki said.</p><p>By all accounts, rooting out these intruders is going to require an unprecedented and urgent nationwide clean-up effort. Adair and others say they’re worried that the longer it takes for victims to remove the backdoors, the more likely it is that the intruders will follow up by installing additional backdoors, and perhaps broadening the attack to include other portions of the victim’s network infrastructure.</p><p>Security researchers have published several tools for detecting vulnerable servers. One of those tools, a script from Microsoft’s <a href=\"https://twitter.com/gossithedog/\" target=\"_blank\" rel=\"noopener\">Kevin Beaumont</a>, <a href=\"https://github.com/microsoft/CSS-Exchange/blob/main/Security/http-vuln-cve2021-26855.nse\" target=\"_blank\" rel=\"noopener\">is available from Github</a>.</p><p>KrebsOnSecurity has seen portions of a victim list compiled by running such a tool, and it is not a pretty picture. The backdoor web shell is verifiably present on the networks of thousands of U.S. organizations, including banks, credit unions, non-profits, telecommunications providers, public utilities and police, fire and rescue units.</p><p>“It’s police departments, hospitals, tons of city and state governments and credit unions,” said one source who’s working closely with federal officials on the matter. “Just about everyone who’s running self-hosted Outlook Web Access and wasn’t patched as of a few days ago got hit with a zero-day attack.”</p><p>Another government cybersecurity expert who participated in a recent call with multiple stakeholders impacted by this hacking spree worries the cleanup effort required is going to be Herculean.</p><p>“On the call, many questions were from school districts or local governments that all need help,” the source said, speaking on condition they were not identified by name. “If these numbers are in the tens of thousands, how does incident response get done? There are just not enough incident response teams out there to do that quickly.”</p><p>When it released patches for the four Exchange Server flaws on Tuesday, Microsoft emphasized that the vulnerability did not affect customers running its Exchange Online service (Microsoft’s cloud-hosted email for businesses). But sources say the vast majority of the organizations victimized so far are running some form of Internet-facing Microsoft Outlook Web Access (OWA) email systems in tandem with Exchange servers internally.</p><p>“It’s a question worth asking, what’s Microsoft’s recommendation going to be?,” the government cybersecurity expert said. “They’ll say ‘Patch, but it’s better to go to the cloud.’ But how are they securing their non-cloud products? Letting them wither on the vine.”</p><p>The government cybersecurity expert said this most recent round of attacks is uncharacteristic of the kinds of nation-state level hacking typically attributed to China, which tends to be fairly focused on compromising specific strategic targets.</p><p>“Its reckless,” the source said. “It seems out of character for Chinese state actors to be this indiscriminate.”</p><p>Microsoft has said the incursions by Hafnium on vulnerable Exchange servers are in no way connected to the separate <a href=\"https://krebsonsecurity.com/?s=solar+winds&amp;x=0&amp;y=0\" target=\"_blank\" rel=\"noopener\">SolarWinds-related attacks</a>, in which a suspected Russian intelligence group installed backdoors in network management software used by more than 18,000 organizations.</p><p>“We continue to see no evidence that the actor behind SolarWinds discovered or exploited any vulnerability in Microsoft products and services,” the company said.</p><p>Nevertheless, the events of the past few days may well end up far eclipsing the damage done by the SolarWinds intruders.</p><p>This is a fast-moving story, and likely will be updated multiple times throughout the day. Stay tuned.</p><p><strong>Update, 8:27 p.m. ET: </strong><em>Wired</em> cybersecurity reporter <strong>Andy Greenberg</strong> has confirmed hearing the same number of victim numbers cited in this report: “It’s massive. Absolutely massive,” one former national security official with knowledge of the investigation told WIRED. “We’re talking thousands of servers compromised per hour, globally.” Read Greenberg’s account <a href=\"https://www.wired.com/story/china-microsoft-exchange-server-hack-victims/\" target=\"_blank\" rel=\"noopener\">here</a>.</p><p>Also, the first and former director of CISA, <strong>Chris Krebs</strong> (no relation) seems to be <a href=\"https://twitter.com/C_C_Krebs/status/1368004411545579525\" target=\"_blank\" rel=\"noopener\">suggesting on Twitter</a> that the victim numbers cited here are conservative (or just outdated already):</p><p><img loading=\"lazy\" src=\"https://krebsonsecurity.com/wp-content/uploads/2021/03/chriskrebstweet2.png\" alt=\"\" width=\"520\" height=\"743\"></p><p><strong>Update 8:49 p.m. ET:</strong> Included a link to one of the more recommended tools for finding systems vulnerable to this attack.</p><p><strong>Update, 10:17 p.m. ET:</strong> Added mention from Reuters story, which said White House officials are concerned about “a large number of victims.”</p><p><strong>Update, March 6, 10:56 a.m. ET:</strong> CISA’s <a href=\"https://twitter.com/USCERT_gov/status/1368216461571919877\" target=\"_blank\" rel=\"noopener\">Twitter account</a> says the agency “is aware of widespread domestic and international exploitation of Microsoft Exchange Server vulnerabilities and urges scanning Exchange Server logs with <a href=\"https://github.com/microsoft/CSS-Exchange/blob/main/Security/http-vuln-cve2021-26855.nse\" target=\"_blank\" rel=\"noopener\">Microsoft’s detection tool</a> to help determine compromise.”</p><div id=\"attachment_54656\"><p><img aria-describedby=\"caption-attachment-54656\" loading=\"lazy\" src=\"https://krebsonsecurity.com/wp-content/uploads/2021/03/cisatweet.png\" alt=\"\" width=\"592\" height=\"301\"></p><p id=\"caption-attachment-54656\">A tweet today from the U.S. Cybersecurity and Infrastructure Security Agency (CISA).</p></div><p>Tags: <a href=\"https://krebsonsecurity.com/tag/andy-greenberg/\" rel=\"tag\">Andy Greenberg</a>, <a href=\"https://krebsonsecurity.com/tag/chris-krebs/\" rel=\"tag\">Chris Krebs</a>, <a href=\"https://krebsonsecurity.com/tag/hafnium/\" rel=\"tag\">Hafnium</a>, <a href=\"https://krebsonsecurity.com/tag/jen-psaki/\" rel=\"tag\">Jen Psaki</a>, <a href=\"https://krebsonsecurity.com/tag/microsoft-exchange-server-flaws/\" rel=\"tag\">Microsoft Exchange server flaws</a>, <a href=\"https://krebsonsecurity.com/tag/steven-adair/\" rel=\"tag\">Steven Adair</a>, <a href=\"https://krebsonsecurity.com/tag/volexity/\" rel=\"tag\">Volexity</a>, <a href=\"https://krebsonsecurity.com/tag/wired/\" rel=\"tag\">wired</a></p><p><small>This entry was posted on Friday, March 5th, 2021 at 4:07 pm and is filed under <a href=\"https://krebsonsecurity.com/category/latest-warnings/\" rel=\"category tag\">Latest Warnings</a>, <a href=\"https://krebsonsecurity.com/category/comingstorm/\" rel=\"category tag\">The Coming Storm</a>, <a href=\"https://krebsonsecurity.com/category/patches/\" rel=\"category tag\">Time to Patch</a>. You can follow any comments to this entry through the <a href=\"https://krebsonsecurity.com/2021/03/at-least-30000-u-s-organizations-newly-hacked-via-holes-in-microsofts-email-software/feed/\">RSS 2.0</a> feed. You can skip to the end and leave a comment. Pinging is currently not allowed.</small></p></div></div>","author":"John Gruber","siteTitle":"Daring Fireball","siteHash":"fc569638025dadf22a867470f8215f38855cf50e975782a6c989909474292a36","entryHash":"1764752b6cd4c30d515188d0be17d69db75b99c54aa55bf45e552acf1bc7c9dc","category":"Tech"}