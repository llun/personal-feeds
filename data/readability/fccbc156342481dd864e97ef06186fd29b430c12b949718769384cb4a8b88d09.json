{"title":"Go 1.17 เล็กและเร็วขึ้น","link":"https://www.somkiat.cc/go-1-17-small-and-faster/","date":1619763743000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>April 30, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/04/golang-1.17.png\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/04/golang-1.17.png 800w, https://www.somkiat.cc/wp-content/uploads/2021/04/golang-1.17-300x160.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/04/golang-1.17-768x409.png 768w\" sizes=\"(max-width: 800px) 100vw, 800px\"></figure><p>วันนี้ลอง build Go 1.17 ที่อยู่ใน branch หลักของการพัฒนา<br>เพื่อลองให้ความสามารถใหม่ ๆ ก่อน<br>สิ่งหนึ่งที่พบเจอได้ในทุก ๆ version ที่ผ่านมาคือ<br>ขนาดของ binary เล็กลง<br>รวมทั้ง performance ก็เร็วและเสถียรขึ้นกว่าเดิม</p><p><strong>โดยลองสร้าง server ด้วย Echo framework ดู</strong></p><div itemprop=\"text\" id=\"gist109271680\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-server-go-L1\" data-line-number=\"1\"></td><td id=\"file-server-go-LC1\"><span>package</span> main</td></tr><tr><td id=\"file-server-go-L2\" data-line-number=\"2\"></td><td id=\"file-server-go-LC2\"></td></tr><tr><td id=\"file-server-go-L3\" data-line-number=\"3\"></td><td id=\"file-server-go-LC3\"><span>import</span> (</td></tr><tr><td id=\"file-server-go-L4\" data-line-number=\"4\"></td><td id=\"file-server-go-LC4\"><span>\"net/http\"</span></td></tr><tr><td id=\"file-server-go-L5\" data-line-number=\"5\"></td><td id=\"file-server-go-LC5\"></td></tr><tr><td id=\"file-server-go-L6\" data-line-number=\"6\"></td><td id=\"file-server-go-LC6\"><span>\"github.com/labstack/echo/v4\"</span></td></tr><tr><td id=\"file-server-go-L7\" data-line-number=\"7\"></td><td id=\"file-server-go-LC7\">)</td></tr><tr><td id=\"file-server-go-L8\" data-line-number=\"8\"></td><td id=\"file-server-go-LC8\"></td></tr><tr><td id=\"file-server-go-L9\" data-line-number=\"9\"></td><td id=\"file-server-go-LC9\"><span>func</span> <span>main</span>() {</td></tr><tr><td id=\"file-server-go-L10\" data-line-number=\"10\"></td><td id=\"file-server-go-LC10\"><span>e</span> <span>:=</span> <span>echo</span>.<span>New</span>()</td></tr><tr><td id=\"file-server-go-L11\" data-line-number=\"11\"></td><td id=\"file-server-go-LC11\"><span>e</span>.<span>GET</span>(<span>\"/\"</span>, <span>func</span>(<span>c</span> echo.<span>Context</span>) <span>error</span> {</td></tr><tr><td id=\"file-server-go-L12\" data-line-number=\"12\"></td><td id=\"file-server-go-LC12\"><span>return</span> <span>c</span>.<span>String</span>(<span>http</span>.<span>StatusOK</span>, <span>\"Hello, World!\"</span>)</td></tr><tr><td id=\"file-server-go-L13\" data-line-number=\"13\"></td><td id=\"file-server-go-LC13\">})</td></tr><tr><td id=\"file-server-go-L14\" data-line-number=\"14\"></td><td id=\"file-server-go-LC14\"><span>e</span>.<span>Logger</span>.<span>Fatal</span>(<span>e</span>.<span>Start</span>(<span>\":1323\"</span>))</td></tr><tr><td id=\"file-server-go-L15\" data-line-number=\"15\"></td><td id=\"file-server-go-LC15\">}</td></tr></tbody></table></div><p><strong>จากนั้นลองทำการ build เป็นไฟล์ binary พบว่า</strong><br>ขนาดลดลงดังนี้</p><ul><li>Go 1.16.3 มีขนาด 7.327568 mb</li><li>Go 1.17-cb34026a95 มีขนาด 6.586128 mb</li></ul><p><strong>ต่อมาทำการยิง load test ด้วย wrk อย่างละ 3 ครั้ง พบว่า</strong></p><ul><li>Go 1.16.3 ผลที่ได้จะแกว่งไปมา ไม่นิ่ง</li><li>Go 1.17-cb34026a9 ผลที่ได้จะ stable และมีความเร็วสูงกว่าเดิมเล็กน้อย</li></ul><p><strong><em>โดยผลการทำงานถือว่าปรับปรุงได้ค่อนข้างดี</em></strong></p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"fccbc156342481dd864e97ef06186fd29b430c12b949718769384cb4a8b88d09","category":"Thai"}