{"title":"[Dart] เปลี่ยนมาใช้งาน Dio package สำหรับเรียกใช้งาน API","link":"https://www.somkiat.cc/api-client-with-dio/","date":1620114576000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/flutter-dio-http-client.png\" alt=\"\" width=\"545\" height=\"327\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/flutter-dio-http-client.png 655w, https://www.somkiat.cc/wp-content/uploads/2021/05/flutter-dio-http-client-300x180.png 300w\" sizes=\"(max-width: 545px) 100vw, 545px\"></figure><p>สำหรับการพัฒนาระบบด้วยภาษา Dart และ Flutter<br>ต้องมีการทำงานร่วมกับ REST API<br>ซึ่งก็มี package ต่าง ๆ ให้ใช้งาน รวมทั้ง <a rel=\"noreferrer noopener\" href=\"https://pub.dev/packages/http\" target=\"_blank\">http package</a> ที่ Dart official เตรียมไว้ให้<br>แต่พอใช้ไปสักพักอาจจะเบื่อกับการเขียนซ้ำ ๆ<br>ดังนั้น ทำให้ต้องหา package อื่น ๆ มาใช้งานบ้าง<br>หนึ่งใน package ที่ใช้อยู่ในปัจจุบันคือ <strong><a rel=\"noreferrer noopener\" href=\"https://github.com/flutterchina/dio\" target=\"_blank\">Dio</a></strong></p><p><strong>โดยท่ี Dio มีความสามารถที่น่าสนใจและใช้งานง่าย ๆ คือ</strong></p><ul><li>Interceptor</li><li>Global configuration</li><li>Request cancellation</li><li>Request retry</li></ul><p>เมื่อใช้งานไปเรื่อย ๆ จะมีลักษณะคล้าย Axios ใน JavaScript<br>ส่งผลให้การพัฒนามี productivity เพิ่มมากขึ้นกว่าเดิม</p><p><strong>ตัวอย่าง code ของการใช้งานกับ interceptor</strong><a href=\"\"></a></p><div itemprop=\"text\" id=\"gist109327784\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-demo-dart-L1\" data-line-number=\"1\"></td><td id=\"file-demo-dart-LC1\"><span>import</span> <span>'dart:async'</span>;</td></tr><tr><td id=\"file-demo-dart-L2\" data-line-number=\"2\"></td><td id=\"file-demo-dart-LC2\"><span>import</span> <span>\"package:dio/dio.dart\"</span>;</td></tr><tr><td id=\"file-demo-dart-L3\" data-line-number=\"3\"></td><td id=\"file-demo-dart-LC3\"></td></tr><tr><td id=\"file-demo-dart-L4\" data-line-number=\"4\"></td><td id=\"file-demo-dart-LC4\"><span>class</span> <span>Client</span>{</td></tr><tr><td id=\"file-demo-dart-L5\" data-line-number=\"5\"></td><td id=\"file-demo-dart-LC5\"><span>Dio</span> <span>init</span>() {</td></tr><tr><td id=\"file-demo-dart-L6\" data-line-number=\"6\"></td><td id=\"file-demo-dart-LC6\"><span>Dio</span> _dio <span>=</span> <span>new</span> <span>Dio</span>();</td></tr><tr><td id=\"file-demo-dart-L7\" data-line-number=\"7\"></td><td id=\"file-demo-dart-LC7\">_dio.interceptors.<span>add</span>(<span>new</span> <span>ApiInterceptors</span>());</td></tr><tr><td id=\"file-demo-dart-L8\" data-line-number=\"8\"></td><td id=\"file-demo-dart-LC8\">_dio.options.baseUrl <span>=</span> <span>\"&lt;target api&gt;\"</span>;</td></tr><tr><td id=\"file-demo-dart-L9\" data-line-number=\"9\"></td><td id=\"file-demo-dart-LC9\"><span>return</span> _dio;</td></tr><tr><td id=\"file-demo-dart-L10\" data-line-number=\"10\"></td><td id=\"file-demo-dart-LC10\">}</td></tr><tr><td id=\"file-demo-dart-L11\" data-line-number=\"11\"></td><td id=\"file-demo-dart-LC11\">}</td></tr><tr><td id=\"file-demo-dart-L12\" data-line-number=\"12\"></td><td id=\"file-demo-dart-LC12\"></td></tr><tr><td id=\"file-demo-dart-L13\" data-line-number=\"13\"></td><td id=\"file-demo-dart-LC13\"><span>class</span> <span>ApiInterceptors</span> <span>extends</span> <span>Interceptor</span> {</td></tr><tr><td id=\"file-demo-dart-L14\" data-line-number=\"14\"></td><td id=\"file-demo-dart-LC14\"><span>@override</span></td></tr><tr><td id=\"file-demo-dart-L15\" data-line-number=\"15\"></td><td id=\"file-demo-dart-LC15\"><span>Future</span><span>&lt;</span><span>dynamic</span><span>&gt;</span> <span>onRequest</span>(<span>RequestOptions</span> options) <span>async</span> {</td></tr><tr><td id=\"file-demo-dart-L16\" data-line-number=\"16\"></td><td id=\"file-demo-dart-LC16\"><span>// do something before request is sent</span></td></tr><tr><td id=\"file-demo-dart-L17\" data-line-number=\"17\"></td><td id=\"file-demo-dart-LC17\">}</td></tr><tr><td id=\"file-demo-dart-L18\" data-line-number=\"18\"></td><td id=\"file-demo-dart-LC18\"></td></tr><tr><td id=\"file-demo-dart-L19\" data-line-number=\"19\"></td><td id=\"file-demo-dart-LC19\"><span>@override</span></td></tr><tr><td id=\"file-demo-dart-L20\" data-line-number=\"20\"></td><td id=\"file-demo-dart-LC20\"><span>Future</span><span>&lt;</span><span>dynamic</span><span>&gt;</span> <span>onError</span>(<span>DioError</span> dioError) {</td></tr><tr><td id=\"file-demo-dart-L21\" data-line-number=\"21\"></td><td id=\"file-demo-dart-LC21\"><span>// do something to error</span></td></tr><tr><td id=\"file-demo-dart-L22\" data-line-number=\"22\"></td><td id=\"file-demo-dart-LC22\">}</td></tr><tr><td id=\"file-demo-dart-L23\" data-line-number=\"23\"></td><td id=\"file-demo-dart-LC23\"></td></tr><tr><td id=\"file-demo-dart-L24\" data-line-number=\"24\"></td><td id=\"file-demo-dart-LC24\"><span>@override</span></td></tr><tr><td id=\"file-demo-dart-L25\" data-line-number=\"25\"></td><td id=\"file-demo-dart-LC25\"><span>Future</span><span>&lt;</span><span>dynamic</span><span>&gt;</span> <span>onResponse</span>(<span>Response</span> response) <span>async</span> {</td></tr><tr><td id=\"file-demo-dart-L26\" data-line-number=\"26\"></td><td id=\"file-demo-dart-LC26\"><span>// do something before response</span></td></tr><tr><td id=\"file-demo-dart-L27\" data-line-number=\"27\"></td><td id=\"file-demo-dart-LC27\">}</td></tr><tr><td id=\"file-demo-dart-L28\" data-line-number=\"28\"></td><td id=\"file-demo-dart-LC28\">}</td></tr></tbody></table></div><p><strong>หรือจะมีส่วนของ plugin เพิ่มเข้ามาด้วย</strong></p><p>ทำให้เพิ่มความสามารถได้ง่ายตอนนี้มี plugin อยู่ 2 ตัวคือ</p><ul><li>Cookie manager</li><li>HTTP 2 adapter</li></ul><p>ลองใช้งานกันดูนะ</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"28bf1bebde0da194bdf09d33483097e2cf3553198c7462d045b6f3355205ac96","category":"Thai"}