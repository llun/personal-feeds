{"title":"0250 | Scan + upgrade wp-super-cache ทั้งเครื่อง","link":"https://www.icez.net/blog/167464/scan-upgrade-wp-super-cache-in-server","date":1616581668000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"wrap\"><h2><a href=\"https://www.icez.net/blog/167464/scan-upgrade-wp-super-cache-in-server\" rel=\"bookmark\" title=\"Permanent Link: 0250 | Scan + upgrade wp-super-cache ทั้งเครื่อง\">0250 | Scan + upgrade wp-super-cache ทั้งเครื่อง</a></h2><p>March 24th, 2021 by icez | Posted in <a href=\"https://www.icez.net/blog/topics/misc\" rel=\"category tag\">Misc</a> |</p><p>สำหรับ shared hosting หรือ server ที่มี wordpress หลายๆ instance</p><h3>ติดตั้ง wp-cli</h3><div><div><pre><span>curl </span><span><span>-</span><span>O</span></span><span> https</span><span>:</span><span><span>//</span></span><span>raw.githubusercontent.com</span><span><span>/</span></span><span>wp-cli</span><span><span>/</span></span><span>builds</span><span><span>/</span></span><span>gh-pages</span><span><span>/</span></span><span>phar</span><span><span>/</span></span><span>wp-cli.phar </span><span><span>&amp;</span></span><span>amp;</span><span><span>&amp;</span></span><span>amp; \\</span><span>\n</span><span><span>chmod</span></span><span> </span><span>+</span><span>x wp</span><span>-</span><span>cli</span><span>.</span><span>phar </span><span><span>&amp;</span></span><span>amp</span><span>;</span><span><span>&amp;</span></span><span>amp</span><span>;</span><span> \\\n</span><span><span>sudo</span></span><span> </span><span><span>mv</span></span><span> wp</span><span>-</span><span>cli</span><span>.</span><span>phar </span><span><span>/</span></span><span>usr</span><span><span>/</span></span><span>local</span><span><span>/</span></span><span>bin</span><span><span>/</span></span></pre></div><p>curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar &amp;amp;&amp;amp; \\ chmod +x wp-cli.phar &amp;amp;&amp;amp; \\ sudo mv wp-cli.phar /usr/local/bin/</p></div><h3>wp-cli upgrade wp-super-cache</h3><p>ใช้คำสั่ง locate หาเว็บที่มี wp-super-cache แล้วใช้ wp-cli สั่ง upgrade เฉพาะ plugin wp-super-cache สำหรับเว็บที่ไม่ได้ใช้ wp-super-cache 1.7.2 (แก้ version php /คำสั่งด้วยนะคัรบ)</p><div><div><pre><span><span>for</span></span><span> i </span><span><span>in</span></span><span> $</span><span><span>(</span></span><span><span>locate</span></span><span> </span><span><span>/</span></span><span>wp</span><span>-</span><span>content</span><span><span>/</span></span><span>plugins</span><span><span>/</span></span><span>wp</span><span>-</span><span>super</span><span>-</span><span>cache</span><span><span>/</span></span><span>wp</span><span>-</span><span>cache</span><span>.</span><span>php</span><span><span>)</span></span><span>;</span><span> </span><span><span>do</span></span><span> \n&nbsp;\n</span><span><span>rootpath</span></span><span>=</span><span>$</span><span><span>(</span></span><span><span>echo</span></span><span> </span><span><span>$i</span></span><span> </span><span><span>|</span></span><span> </span><span><span>sed</span></span><span> </span><span><span>'s#/wp-content/plugins/wp-super-cache/wp-cache.php##g'</span></span><span><span>)</span></span><span>\n</span><span><span>echo</span></span><span> </span><span><span>$rootpath</span></span><span>\n</span><span><span>cd</span></span><span> </span><span><span>$rootpath</span></span><span>\n</span><span><span>grep</span></span><span> </span><span><span>'Version: 1.7.2'</span></span><span> </span><span>.</span><span><span>/</span></span><span>wp</span><span>-</span><span>content</span><span><span>/</span></span><span>plugins</span><span><span>/</span></span><span>wp</span><span>-</span><span>super</span><span>-</span><span>cache</span><span><span>/</span></span><span>wp</span><span>-</span><span>cache</span><span>.</span><span>php </span><span><span>||</span></span><span> \\\n</span><span><span>sudo</span></span><span> </span><span><span>-</span><span>u</span></span><span> $</span><span><span>(</span></span><span><span>stat</span></span><span> </span><span><span>-</span><span>c</span></span><span> </span><span><span>%</span></span><span>U </span><span>.</span><span><span>)</span></span><span> </span><span><span>--</span></span><span> php7</span><span>.</span><span>3</span><span> $</span><span><span>(</span></span><span><span>which</span></span><span> wp</span><span>-</span><span>cli</span><span>.</span><span>phar</span><span><span>)</span></span><span> plugin update wp</span><span>-</span><span>super</span><span>-</span><span>cache\n&nbsp;\n</span><span><span>done</span></span></pre></div><p>for i in $(locate /wp-content/plugins/wp-super-cache/wp-cache.php); do rootpath=$(echo $i | sed 's#/wp-content/plugins/wp-super-cache/wp-cache.php##g') echo $rootpath cd $rootpath grep 'Version: 1.7.2' ./wp-content/plugins/wp-super-cache/wp-cache.php || \\ sudo -u $(stat -c %U .) -- php7.3 $(which wp-cli.phar) plugin update wp-super-cache done</p></div></div></div>","author":"icez","siteTitle":"icez network","siteHash":"88787adba55f9deb5660f47c4b8baf580eb765815e4a6d536737656e8ab8bde4","entryHash":"650f6d08ddd7d167cc0fbd60d5956c6ef690189ba29a14cf711ca2bcc3c96794","category":"Thai"}