{"title":"Hacker reduces GTA Online load times by roughly 70 percent","link":"https://arstechnica.com/?p=1746111","date":1614623569000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><h4>Load it up â€”</h4><h2 itemprop=\"description\">Homebrewed DLL solves inefficient parsing of in-game shop files.</h2></div><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/gtaoload-800x450.jpg\" alt=\"You could spend less time looking at loading screens like this with a new DLL fix.\"><figcaption><p><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/gtaoload.jpg\" data-height=\"1080\" data-width=\"1920\">Enlarge</a> <span>/</span> You could spend less time looking at loading screens like this with a new DLL fix.</p></figcaption></figure><p>A hacker going by the handle T0st says he has <a href=\"https://nee.lv/2021/02/28/How-I-cut-GTA-Online-loading-times-by-70/\">figured out a core issue</a> that caused longer-than-necessary load times in <em>Grand Theft Auto Online</em> for years. The hacker has released <a href=\"https://github.com/tostercx/GTAO_Booster_PoC\">a proof of concept DLL fix</a> that shortens those lengthy startup times by roughly 70 percent.</p><p><em>Grand Theft Auto Online</em>'s PC load times have been a persistent issue for seven years now, remaining slow despite general improvements to hardware and the game's status as <a href=\"https://arstechnica.com/gaming/2017/08/grand-theft-auto-online-averts-cancellation-by-printing-tons-of-money/\">a continuing lucrative revenue stream for publisher Take Two</a>. An <a href=\"https://www.reddit.com/r/gtaonline/comments/ht4i56/your_average_online_loading_time/\">anonymous Reddit poll last year</a> found that roughly half of players were waiting three to six minutes for the game to load up, and about 35 percent of players waiting even longer to start every session.</p><p>That's not a scientific survey or anything, but even accounting for self-selection and reporting issues, those load times are very long, especially for such an old game. The problem is even harder to understand when the single-player <em>Grand Theft Auto V</em> tends to load many times faster.</p><h2>Saving time with disassembly</h2><p>To get to the bottom of the problem, T0st <a href=\"https://nee.lv/2021/02/28/How-I-cut-GTA-Online-loading-times-by-70/\">writes</a> that they started by profiling their own CPU to try to figure out why the game was maxing out a single CPU thread for over four minutes during loading. After using a tool to dump the <a href=\"https://stackoverflow.com/questions/33239200/whats-the-difference-between-a-process-stack-and-a-cpu-stack\">process stack</a> and disassembling the <em>GTA</em> code as it was running in memory, T0st noticed a set of (somewhat obfuscated) functions that seemed to be parsing a 10MB JSON file with over 63,000 total entires.</p><p>The JSON file in question appeared to be the \"net shop catalog\" that describes every single item <em>GTA Online</em> players can purchase with in-game currency. Parsing a 10MB file shouldn't be <em>too</em> much of a problem for a modern computer, but a few obscure problems in the specific implementation seem to lead to massive slowdowns.</p><p>For one, the specific function used to parse the JSON string (seemingly <a href=\"http://www.cplusplus.com/reference/cstdio/sscanf/\">sscanf</a>, in this case) was apparently running <a href=\"https://www.cplusplus.com/reference/cstring/strlen/\">a time-intensive strlen checking function</a> repeatedly after the read for <em>every single piece of data</em>. Simply caching that string length value to speed up those checks resulted in an over 50 percent reduction in load times on its own, T0st writes.</p><p>After parsing all this JSON data, <em>GTA Online</em> seems to load it into an array in an extremely inefficient way, checking the entire array for duplicates from scratch as it grows. Replacing that process with a <a href=\"https://www.interviewcake.com/concept/java/hash-map\">hash table</a> that can quickly check for duplicates led to a roughly 25 percent load time reduction on its own, T0st writes.</p><p>With these two fixes combined, T0st says&nbsp;<em>GTA Online</em>'s load time went down from six minutes to just under two minutes on the test machine. Those interested in replicating the results can <a href=\"https://github.com/tostercx/GTAO_Booster_PoC\">build a similar DLL from T0st's source code</a>. Players should only do so at their own risk, though, since this kind of modification could easily (and erroneously) set off the game's anti-cheat checks.</p><p>Meanwhile, T0st writes that implementing this fix for all players on Rockstar's side \"shouldn't take more than a day for a single dev to solve.\" Here's hoping the renewed attention this issue is getting will get Rockstar to do so sooner than later.</p></div></div>","author":"Kyle Orland","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"97a98bdac651d54ca456dbe5022600a222010c3fec55dd542e531159c04024e8","category":"Tech"}