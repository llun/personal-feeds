{"title":"ว่าง ๆ ลองมาเล่น .Net 6 Preview 4 กันหน่อย","link":"https://www.somkiat.cc/hello-net-6-preview-4/","date":1622303529000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dotnet-6-1024x577.png\" alt=\"\" width=\"564\" height=\"317\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/05/dotnet-6-1024x577.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/05/dotnet-6-300x169.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/05/dotnet-6-768x433.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/05/dotnet-6.png 1200w\" sizes=\"(max-width: 564px) 100vw, 564px\"></figure><p>ระหว่างรอดูบอล ก็ทำการ <strong><a href=\"https://devblogs.microsoft.com/aspnet/asp-net-core-updates-in-net-6-preview-4\" target=\"_blank\" rel=\"noreferrer noopener\">update และลองใช้งาน .NET 6 Preview 4</a></strong> กันหน่อย<br>จาก blog เปิดตัว พบว่ามีความสามารถเยอะเลย<br>ดังนั้นลองมาสร้าง web application<br>เห็นว่ามี update เรื่อง .Net Hot Reload ด้วย<br>มาเริ่มกันเลย</p><p><strong>ทำการติดตั้งและสร้าง project ง่าย ๆ กันหน่อย</strong></p><p>สร้างแบบ empty project มี C# เพียงไฟล์เดียวเท่านั้น<br>ด้วยคำสั่งดังนี้</p><div itemprop=\"text\" id=\"gist109782677\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-1-txt-L1\" data-line-number=\"1\"></td><td id=\"file-1-txt-LC1\">$dotnet --version</td></tr><tr><td id=\"file-1-txt-L2\" data-line-number=\"2\"></td><td id=\"file-1-txt-LC2\">6.0.100-preview.4.21255.9</td></tr><tr><td id=\"file-1-txt-L3\" data-line-number=\"3\"></td><td id=\"file-1-txt-LC3\"></td></tr><tr><td id=\"file-1-txt-L4\" data-line-number=\"4\"></td><td id=\"file-1-txt-LC4\">$dotnet new web -o hello</td></tr><tr><td id=\"file-1-txt-L5\" data-line-number=\"5\"></td><td id=\"file-1-txt-LC5\"></td></tr><tr><td id=\"file-1-txt-L6\" data-line-number=\"6\"></td><td id=\"file-1-txt-LC6\">Welcome to .NET 6.0!</td></tr><tr><td id=\"file-1-txt-L7\" data-line-number=\"7\"></td><td id=\"file-1-txt-LC7\">---------------------</td></tr><tr><td id=\"file-1-txt-L8\" data-line-number=\"8\"></td><td id=\"file-1-txt-LC8\">SDK Version: 6.0.100-preview.4.21255.9</td></tr><tr><td id=\"file-1-txt-L9\" data-line-number=\"9\"></td><td id=\"file-1-txt-LC9\"></td></tr><tr><td id=\"file-1-txt-L10\" data-line-number=\"10\"></td><td id=\"file-1-txt-LC10\">Telemetry</td></tr><tr><td id=\"file-1-txt-L11\" data-line-number=\"11\"></td><td id=\"file-1-txt-LC11\">---------</td></tr><tr><td id=\"file-1-txt-L12\" data-line-number=\"12\"></td><td id=\"file-1-txt-LC12\">The .NET tools collect usage data in order to help us improve your experience. It is collected by Microsoft and shared with the community. You can opt-out of telemetry by setting the DOTNET_CLI_TELEMETRY_OPTOUT environment variable to '1' or 'true' using your favorite shell.</td></tr><tr><td id=\"file-1-txt-L13\" data-line-number=\"13\"></td><td id=\"file-1-txt-LC13\"></td></tr><tr><td id=\"file-1-txt-L14\" data-line-number=\"14\"></td><td id=\"file-1-txt-LC14\">Read more about .NET CLI Tools telemetry: https://aka.ms/dotnet-cli-telemetry</td></tr><tr><td id=\"file-1-txt-L15\" data-line-number=\"15\"></td><td id=\"file-1-txt-LC15\"></td></tr><tr><td id=\"file-1-txt-L16\" data-line-number=\"16\"></td><td id=\"file-1-txt-LC16\">----------------</td></tr><tr><td id=\"file-1-txt-L17\" data-line-number=\"17\"></td><td id=\"file-1-txt-LC17\">Installed an ASP.NET Core HTTPS development certificate.</td></tr><tr><td id=\"file-1-txt-L18\" data-line-number=\"18\"></td><td id=\"file-1-txt-LC18\">To trust the certificate run 'dotnet dev-certs https --trust' (Windows and macOS only).</td></tr><tr><td id=\"file-1-txt-L19\" data-line-number=\"19\"></td><td id=\"file-1-txt-LC19\">Learn about HTTPS: https://aka.ms/dotnet-https</td></tr><tr><td id=\"file-1-txt-L20\" data-line-number=\"20\"></td><td id=\"file-1-txt-LC20\">----------------</td></tr><tr><td id=\"file-1-txt-L21\" data-line-number=\"21\"></td><td id=\"file-1-txt-LC21\">Write your first app: https://aka.ms/dotnet-hello-world</td></tr><tr><td id=\"file-1-txt-L22\" data-line-number=\"22\"></td><td id=\"file-1-txt-LC22\">Find out what's new: https://aka.ms/dotnet-whats-new</td></tr><tr><td id=\"file-1-txt-L23\" data-line-number=\"23\"></td><td id=\"file-1-txt-LC23\">Explore documentation: https://aka.ms/dotnet-docs</td></tr><tr><td id=\"file-1-txt-L24\" data-line-number=\"24\"></td><td id=\"file-1-txt-LC24\">Report issues and find source on GitHub: https://github.com/dotnet/core</td></tr><tr><td id=\"file-1-txt-L25\" data-line-number=\"25\"></td><td id=\"file-1-txt-LC25\">Use 'dotnet --help' to see available commands or visit: https://aka.ms/dotnet-cli</td></tr><tr><td id=\"file-1-txt-L26\" data-line-number=\"26\"></td><td id=\"file-1-txt-LC26\">--------------------------------------------------------------------------------------</td></tr><tr><td id=\"file-1-txt-L27\" data-line-number=\"27\"></td><td id=\"file-1-txt-LC27\">Getting ready...</td></tr></tbody></table></div><p>ไฟล์ C# ที่สร้างมาคือ Program.cs เป็นไฟล์หลักของระบบงาน</p><div itemprop=\"text\" id=\"gist109782677\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-program-cs-L1\" data-line-number=\"1\"></td><td id=\"file-program-cs-LC1\"><span>using</span> <span>System</span>;</td></tr><tr><td id=\"file-program-cs-L2\" data-line-number=\"2\"></td><td id=\"file-program-cs-LC2\"><span>using</span> <span>Microsoft</span>.<span>AspNetCore</span>.<span>Builder</span>;</td></tr><tr><td id=\"file-program-cs-L3\" data-line-number=\"3\"></td><td id=\"file-program-cs-LC3\"><span>using</span> <span>Microsoft</span>.<span>Extensions</span>.<span>Hosting</span>;</td></tr><tr><td id=\"file-program-cs-L4\" data-line-number=\"4\"></td><td id=\"file-program-cs-LC4\"></td></tr><tr><td id=\"file-program-cs-L5\" data-line-number=\"5\"></td><td id=\"file-program-cs-LC5\"><span>var</span> <span>builder</span> <span>=</span> <span>WebApplication</span>.<span>CreateBuilder</span>(<span>args</span>);</td></tr><tr><td id=\"file-program-cs-L6\" data-line-number=\"6\"></td><td id=\"file-program-cs-LC6\"><span>await</span> <span>using</span> <span>var</span> <span>app</span> <span>=</span> <span>builder</span>.<span>Build</span>();</td></tr><tr><td id=\"file-program-cs-L7\" data-line-number=\"7\"></td><td id=\"file-program-cs-LC7\"></td></tr><tr><td id=\"file-program-cs-L8\" data-line-number=\"8\"></td><td id=\"file-program-cs-LC8\"><span>if</span> (<span>app</span>.<span>Environment</span>.<span>IsDevelopment</span>())</td></tr><tr><td id=\"file-program-cs-L9\" data-line-number=\"9\"></td><td id=\"file-program-cs-LC9\">{</td></tr><tr><td id=\"file-program-cs-L10\" data-line-number=\"10\"></td><td id=\"file-program-cs-LC10\"><span>app</span>.<span>UseDeveloperExceptionPage</span>();</td></tr><tr><td id=\"file-program-cs-L11\" data-line-number=\"11\"></td><td id=\"file-program-cs-LC11\">}</td></tr><tr><td id=\"file-program-cs-L12\" data-line-number=\"12\"></td><td id=\"file-program-cs-LC12\"></td></tr><tr><td id=\"file-program-cs-L13\" data-line-number=\"13\"></td><td id=\"file-program-cs-LC13\"><span>app</span>.<span>MapGet</span>(<span><span>\"</span>/<span>\"</span></span>, (Func&lt;string&gt;)(() <span>=&gt;</span> <span><span>\"</span>Hello World<span>\"</span></span>));</td></tr><tr><td id=\"file-program-cs-L14\" data-line-number=\"14\"></td><td id=\"file-program-cs-LC14\"></td></tr><tr><td id=\"file-program-cs-L15\" data-line-number=\"15\"></td><td id=\"file-program-cs-LC15\"><span>await</span> <span>app</span>.<span>RunAsync</span>();</td></tr></tbody></table></div><p><strong>จากนั้นทำการ run แบบ <a href=\"https://devblogs.microsoft.com/dotnet/introducing-net-hot-reload/\" target=\"_blank\" rel=\"noreferrer noopener\">Hot Reload</a> ได้เลย</strong></p><p>จะทำการ detect change เฉพาะไฟล์ C# เท่านั้น<br>ด้วยการกดปุ่ม Control/Ctrl + R ได้เลย<br>ทำให้การพัฒนาสะดวกขึ้นมาพอสมควร</p><div itemprop=\"text\" id=\"gist109782677\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-2-txt-L1\" data-line-number=\"1\"></td><td id=\"file-2-txt-LC1\">$dotnet watch run</td></tr><tr><td id=\"file-2-txt-L2\" data-line-number=\"2\"></td><td id=\"file-2-txt-LC2\"></td></tr><tr><td id=\"file-2-txt-L3\" data-line-number=\"3\"></td><td id=\"file-2-txt-LC3\">watch : Hot reload enabled. For a list of supported edits, see https://aka.ms/dotnet/hot-reload. Press \"Ctrl + R\" to restart.</td></tr><tr><td id=\"file-2-txt-L4\" data-line-number=\"4\"></td><td id=\"file-2-txt-LC4\">watch : Building...</td></tr><tr><td id=\"file-2-txt-L5\" data-line-number=\"5\"></td><td id=\"file-2-txt-LC5\">Determining projects to restore...</td></tr><tr><td id=\"file-2-txt-L6\" data-line-number=\"6\"></td><td id=\"file-2-txt-LC6\">All projects are up-to-date for restore.</td></tr><tr><td id=\"file-2-txt-L7\" data-line-number=\"7\"></td><td id=\"file-2-txt-LC7\">You are using a preview version of .NET. See: https://aka.ms/dotnet-core-preview</td></tr><tr><td id=\"file-2-txt-L8\" data-line-number=\"8\"></td><td id=\"file-2-txt-LC8\">hello -&gt; /Users/dotnet/v6/hello/bin/Debug/net6.0/hello.dll</td></tr><tr><td id=\"file-2-txt-L9\" data-line-number=\"9\"></td><td id=\"file-2-txt-LC9\">watch : Started</td></tr><tr><td id=\"file-2-txt-L10\" data-line-number=\"10\"></td><td id=\"file-2-txt-LC10\">info: Microsoft.Hosting.Lifetime[14]</td></tr><tr><td id=\"file-2-txt-L11\" data-line-number=\"11\"></td><td id=\"file-2-txt-LC11\">Now listening on: https://localhost:5001</td></tr><tr><td id=\"file-2-txt-L12\" data-line-number=\"12\"></td><td id=\"file-2-txt-LC12\">info: Microsoft.Hosting.Lifetime[14]</td></tr><tr><td id=\"file-2-txt-L13\" data-line-number=\"13\"></td><td id=\"file-2-txt-LC13\">Now listening on: http://localhost:5000</td></tr><tr><td id=\"file-2-txt-L14\" data-line-number=\"14\"></td><td id=\"file-2-txt-LC14\">info: Microsoft.Hosting.Lifetime[0]</td></tr><tr><td id=\"file-2-txt-L15\" data-line-number=\"15\"></td><td id=\"file-2-txt-LC15\">Application started. Press Ctrl+C to shut down.</td></tr><tr><td id=\"file-2-txt-L16\" data-line-number=\"16\"></td><td id=\"file-2-txt-LC16\">info: Microsoft.Hosting.Lifetime[0]</td></tr><tr><td id=\"file-2-txt-L17\" data-line-number=\"17\"></td><td id=\"file-2-txt-LC17\">Hosting environment: Development</td></tr><tr><td id=\"file-2-txt-L18\" data-line-number=\"18\"></td><td id=\"file-2-txt-LC18\">info: Microsoft.Hosting.Lifetime[0]</td></tr><tr><td id=\"file-2-txt-L19\" data-line-number=\"19\"></td><td id=\"file-2-txt-LC19\">Content root path: /Users/dotnet/v6/hello</td></tr><tr><td id=\"file-2-txt-L20\" data-line-number=\"20\"></td><td id=\"file-2-txt-LC20\">watch : File changed: /Users/dotnet/v6/hello/Program.cs.</td></tr><tr><td id=\"file-2-txt-L21\" data-line-number=\"21\"></td><td id=\"file-2-txt-LC21\">watch : Hot reload of changes succeeded.</td></tr><tr><td id=\"file-2-txt-L22\" data-line-number=\"22\"></td><td id=\"file-2-txt-LC22\">watch : File changed: /Users/dotnet/v6/hello/Program.cs.</td></tr><tr><td id=\"file-2-txt-L23\" data-line-number=\"23\"></td><td id=\"file-2-txt-LC23\">watch : Hot reload of changes succeeded.</td></tr><tr><td id=\"file-2-txt-L24\" data-line-number=\"24\"></td><td id=\"file-2-txt-LC24\">watch : Shutdown requested. Press Ctrl+C again to force exit.</td></tr><tr><td id=\"file-2-txt-L25\" data-line-number=\"25\"></td><td id=\"file-2-txt-LC25\">info: Microsoft.Hosting.Lifetime[0]</td></tr><tr><td id=\"file-2-txt-L26\" data-line-number=\"26\"></td><td id=\"file-2-txt-LC26\">Application is shutting down...</td></tr></tbody></table></div><p><strong>ลองทำการยิง load test เบา ๆ ดูหน่อย สำหรับ Hello World</strong></p><p>ถือว่าแจ่มเลยนะ</p><div itemprop=\"text\" id=\"gist109782677\"><table data-tab-size=\"8\" data-paste-markdown-skip=\"\"><tbody><tr><td id=\"file-3-txt-L1\" data-line-number=\"1\"></td><td id=\"file-3-txt-LC1\">$wrk -t 5 -c 100 -d 10s http://localhost:5000</td></tr><tr><td id=\"file-3-txt-L2\" data-line-number=\"2\"></td><td id=\"file-3-txt-LC2\"></td></tr><tr><td id=\"file-3-txt-L3\" data-line-number=\"3\"></td><td id=\"file-3-txt-LC3\">Running 10s test @ http://localhost:5000</td></tr><tr><td id=\"file-3-txt-L4\" data-line-number=\"4\"></td><td id=\"file-3-txt-LC4\">5 threads and 100 connections</td></tr><tr><td id=\"file-3-txt-L5\" data-line-number=\"5\"></td><td id=\"file-3-txt-LC5\">Thread Stats Avg Stdev Max +/- Stdev</td></tr><tr><td id=\"file-3-txt-L6\" data-line-number=\"6\"></td><td id=\"file-3-txt-LC6\">Latency 1.68ms 4.67ms 160.80ms 98.80%</td></tr><tr><td id=\"file-3-txt-L7\" data-line-number=\"7\"></td><td id=\"file-3-txt-LC7\">Req/Sec 15.39k 2.53k 26.67k 92.40%</td></tr><tr><td id=\"file-3-txt-L8\" data-line-number=\"8\"></td><td id=\"file-3-txt-LC8\">766174 requests in 10.09s, 89.87MB read</td></tr><tr><td id=\"file-3-txt-L9\" data-line-number=\"9\"></td><td id=\"file-3-txt-LC9\">Requests/sec: 75898.08</td></tr><tr><td id=\"file-3-txt-L10\" data-line-number=\"10\"></td><td id=\"file-3-txt-LC10\">Transfer/sec: 8.90MB</td></tr></tbody></table></div><p>ใครว่าง ๆ ลองไป <strong><a href=\"https://dotnet.microsoft.com/download/dotnet/6.0\" target=\"_blank\" rel=\"noreferrer noopener\">Download</a></strong> มาเล่นกันดูครับ</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"a795d0e6d1ad574307fbd08680c978af1ec4e32955a1e5c2631f7f6c08466be0","category":"Thai"}