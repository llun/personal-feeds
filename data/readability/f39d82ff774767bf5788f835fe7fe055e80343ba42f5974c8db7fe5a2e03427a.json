{"title":"Bitflips when PCs try to reach windows.com: what could possibly go wrong?","link":"https://arstechnica.com/?p=1747156","date":1614889241000,"content":"<div id=\"readability-page-1\" class=\"page\"><div><h4>FLIP YOUR BITS —</h4><h2 itemprop=\"description\">Researcher obtains 14 bitsquatted domains and gets a flood of traffic.</h2></div><div itemprop=\"articleBody\"><figure><img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/03/bits-800x450.jpg\" alt=\"Stock photo of ones and zeros displayed across a computer screen.\"><figcaption></figcaption></figure><p>Bit flips are events that cause individual bits stored in an electronic device to flip, turning a 0 to a 1 or vice versa. Cosmic radiation and fluctuations in power or temperature are the most common naturally occurring causes. <a href=\"http://lambda-diode.com/opinion/ecc-memory\">Research from 2010</a> estimated that a computer with 4GB of commodity RAM has a 96 percent chance of experiencing a bit flip within three days.</p><p>An independent researcher recently demonstrated how bitflips can come back to bite Windows users when their PCs reach out to Microsoft’s windows.com domain. Windows devices do this regularly to do things like making sure the time shown in the computer clock is accurate, connecting to Microsoft’s cloud-based services, and recovering from crashes.</p><p>Remy, as the researcher asked to be referred to, mapped the 32 valid domain names that were one bitflip away from windows.com. He provided the following to help readers understand how these flips can cause the domain to change to whndows.com:</p><table><thead><tr><th>01110111</th><th>01101001</th><th>01101110</th><th>01100100</th><th>01101111</th><th>01110111</th><th>01110011</th></tr></thead><tbody><tr><td>w</td><td>i</td><td>n</td><td>d</td><td>o</td><td>w</td><td>s</td></tr></tbody></table><table><thead><tr><th>01110111</th><th>01101000</th><th>01101110</th><th>01100100</th><th>01101111</th><th>01110111</th><th>01110011</th></tr></thead><tbody><tr><td>w</td><td><strong>h</strong></td><td>n</td><td>d</td><td>o</td><td>w</td><td>s</td></tr></tbody></table><p>Of the 32 bit-flipped values that were valid domain names, Remy found that 14 of them were still available for purchase. This was surprising because, normally, Microsoft and other companies buy these types of one-off domains to protect customers against phishing attacks. He bought them for $126 and set out to see what would happen. The domains were:</p><ul><li>windnws.com</li><li>windo7s.com</li><li>windkws.com</li><li>windmws.com</li><li>winlows.com</li><li>windgws.com</li><li>wildows.com</li><li>wintows.com</li><li>wijdows.com</li><li>wiodows.com</li><li>wifdows.com</li><li>whndows.com</li><li>wkndows.com</li><li>wmndows.com</li></ul><h2>No inherent verification</h2><p>Over the course of two weeks, Remy’s server received 199,180 connections from 626 unique IP addresses that were trying to contact ntp.windows.com. By default, Windows machines will connect to this domain once per week to check that the time shown in the device clock is correct. What the researcher found next was even more surprising.</p><p>“The NTP client for windows OS has no inherent verification of authenticity, so there is nothing stopping a malicious person from telling all these computers that it’s after <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\">03:14:07 on Tuesday, 19 January 2038</a> and wreaking unknown havoc as the memory storing the signed 32-bit integer for time overflows,” he wrote in a <a href=\"https://remyhax.xyz/posts/bitsquatting-windows/\">post</a> summarizing his findings. “As it turns out though, for ~30% of these computers doing that would make little to no difference at all to those users because their clock is already <em>broken</em>.”</p><p>The researcher observed machines trying to make connections to other windows.com subdomains, including sg2p.w.s.windows.com, client.wns.windows.com, skydrive.wns.windows.com, windows.com/stopcode, and windows.com/?fbclid.</p><p>Remy said that not all of the domain mismatches were the result of bitflips. In some cases, they were caused by typos by people behind the keyboard, and in at least one case, the keyboard was on an Android device, as it attempted to diagnose a blue-screen-of-death crash that had occurred on a Windows machine.</p><p>To capture the traffic devices sent to the mismatched domains, Remy rented a virtual private server and created wildcard domain lookup entries to point to them. The wildcard records allow traffic destined for different subdomains of the same domain—say, ntp.whndows.com, abs.xyz.whndows.com, or client.wns.whndows.com—to map to the same IP address.</p><p>“Due to the nature of this research dealing with bits being flipped, this allows me to capture any DNS lookup for a subdomain of windows.com where multiple bits have flipped.”</p><p>Remy said he’s willing to transfer the 14 domains to a “verifiably responsible party” and, in the meantime, will simply sinkhole them, meaning he will hold onto the addresses and configure the DNS records so they are unreachable.</p><h2>“Hopefully this spawns more research”</h2><p>I asked Microsoft representatives if they’re aware of the findings and the offer to transfer the domains. The representatives are working on getting a response. Readers should remember, though, that the threats the research identifies aren't limited to Windows.</p><p>In a <a href=\"https://resources.bishopfox.com/files/slides/2019/Kaspersky%20SAS-Ghost-in-the-Browser-Broad-Scale-Espionage-with-Bitsquatting-10Apr2019-%20Slides.pdf\">2019 presentation</a> at the Kaspersky Security Analysts Summit, for instance, researchers from security firm Bishop Fox obtained some eye-opening results after registering hundreds of bitflipped variations of skype.com, symantec.com, and other widely visited sites.</p><p>Remy said the findings are important because they suggest that bitflip-induced domain mismatches occur at a scale that’s higher than many people realized.</p><p>“Prior research primarily dealt with HTTP/HTTPS, but my research shows that even with a small handful of bitsquatted domains you can still siphon up ill-destined traffic from other default network protocols that are constantly running, such as NTP,” Remy said in a direct message. “Hopefully this spawns more research into this area as it relates to the threat model of default OS services.”</p></div></div>","author":"Dan Goodin","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"f39d82ff774767bf5788f835fe7fe055e80343ba42f5974c8db7fe5a2e03427a","category":"Tech"}