{"title":"★ ‘Secure Intent’ on Apple Devices","link":"https://daringfireball.net/2021/06/secure_intent_on_apple_devices","date":1622675137000,"content":"\n<p>Interesting new document in the May update to Apple’s Platform Security guide: “<a href=\"https://support.apple.com/guide/security/secure-intent-connections-enclave-sec7a94f7d1e/web\">Secure Intent and Connections to the Secure Enclave</a>”. (<a href=\"https://twitter.com/GlennF/status/1398370585734836224\">Spotted by Glenn Fleishman</a>.) It’s short, so I’m quoting it in its entirety:</p>\n\n<blockquote>\n  <p>Secure intent provides a way to confirm a user’s intent without\nany interaction with the operating system or Application\nProcessor. The connection is a physical link — from a physical\nbutton to the Secure Enclave — that’s available in the following:</p>\n\n<ul>\n<li>iPhone X or later</li>\n<li>Apple Watch Series 1 or later</li>\n<li>iPad Pro (all models)</li>\n<li>iPad Air (2020)</li>\n<li>Mac computers with Apple Silicon</li>\n</ul>\n\n<p>With this link, users can confirm their intent to complete an\noperation in a way designed such that even software running with\nroot privileges or in the kernel can’t spoof.</p>\n\n<p>This feature is used to confirm user intent during Apple Pay\ntransactions and when finalizing pairing Magic Keyboard with Touch\nID to a Mac with Apple silicon. A double-press on the appropriate\nbutton when prompted by the user interface signals confirmation of\nuser intent. For more information, see <a href=\"https://support.apple.com/guide/security/uses-for-touch-id-and-face-id-secc5227ff3c/1/web/\">Securing purchases with\nApple Pay</a>. A similar mechanism — based on the Secure Enclave\nand T2 firmware — is supported on MacBook models with the Apple\nT2 Security Chip and no Touch Bar.</p>\n</blockquote>\n\n<p>First things first, this sentence seems to be outdated/wrong:</p>\n\n<blockquote>\n  <p>A double-press on the appropriate\nbutton when prompted by the user interface signals confirmation of\nuser intent.</p>\n</blockquote>\n\n<p>because some of the devices on this list don’t require double-pressing a button. The double-press rule is only for Face ID devices. Touch ID devices on this list only require a fingerprint scan — that includes MacBooks, M1 Macs with the new Magic Keyboard, and older iPad Pros.</p>\n\n<p>In broad strokes, we can classify Apple devices into five categories with regard to authentication and secure intent:</p>\n\n<ol>\n<li><p>Devices that support neither Face ID nor Touch ID in any way. On such devices (old iOS devices, and Intel Macs without a Touch Bar or Touch ID button) you can only authenticate by entering passcodes / passwords.</p></li>\n<li><p>iOS devices with Touch ID on the home button. Most such devices are not included in this list. See below.</p></li>\n<li><p>Devices with Touch ID support <em>not</em> on a home button. This includes the new iPad Air (which has Touch ID on the power button), and recent MacBook  models with a Touch Bar or with a Touch ID power button. (The above-quoted support document from Apple mentions “Mac computers with Apple Silicon”, and also says “a similar mechanism … is supported on MacBook models with the Apple T2 Security Chip and no Touch Bar”. That seemingly omits Intel-based MacBook Pros with a Touch Bar, but I think that’s a mistake. Any MacBook Pro with a T2 security chip should, I think, be eligible for the same “similar mechanism” as the ones without a Touch Bar.)</p></li>\n<li><p>Face ID devices: iPhones X or later, and all iPad Pros.<sup><a href=\"#fn1-2021-06-02\">1</a></sup></p></li>\n<li><p>Apple Watch, which has neither Face ID nor Touch ID, but knows when it has been removed from your wrist <em>after</em> it’s been unlocked via passcode or via unlocking the iPhone to which it is paired. (A lot of Apple Watch owners are not aware that you don’t have to enter your passcode when you put it on — you can just put it on and the Watch will unlock when next you unlock your iPhone.) Once unlocked, as long as it remains on your wrist, your Apple Watch is trusted.</p></li>\n</ol>\n\n<p>The desktop Macs eligible for secure intent — the new M1 iMac and the M1 Mac Mini that launched last November — do not qualify without a trusted peripheral. Neither of them have Touch ID <em>on the computer itself</em>. To use Touch ID, they need to be paired with one of Apple’s new Magic Keyboards. This still qualifies for secure intent, despite the fact that secure intent requires “a physical link from a physical button to the Secure Enclave”, <em>because the keyboard itself contains its own Secure Enclave</em>.</p>\n\n<p>Likewise, for several years now, <em>any</em> modern Mac has been able to use an Apple Watch paired to the same iCloud account as a “secure intent” device, very much like using a paired Touch ID Magic Keyboard. You can use a double-click of your Apple Watch side button to confirm purchases and administrator-privileged actions like moving protected files to the Trash. Same thing for <a href=\"https://support.apple.com/en-us/HT206995\">unlocking your Mac</a>: your Watch counts as a secure authentication method (but with no interaction required, only proximity).</p>\n\n<p>Conspicuously absent from the list of “secure intent” devices are <s>all</s> <em>most</em> iOS devices with Touch ID on the home button. The exceptions are <a href=\"https://support.apple.com/en-us/HT201471#ipadpro\">the early iPad Pro models from 2016 and 2017</a>. I have no idea why those early iPad Pros qualify but Touch ID iPhones and non-Pro iPads do not.</p>\n\n<p>One factor — but a factor that wouldn’t explain why home button iPad Pro models qualify for secure intent — might be that the home button is overloaded on those devices. There have been <a href=\"https://www.wired.com/story/iphone-touch-id-scam-apps/\">a handful of scam apps</a> that pop up “surprise” in-app purchase prompts, and if the user tries to press the Touch ID home button with the intention of just getting out of the app and back to the home screen, they risk <em>confirming</em> the unwanted purchase as soon as they put their finger on the home button. If all software were trustworthy, Touch ID on the home button would be ideal. With the potential for untrustworthy software, it’s not an ideal design to use the same button for “<em>get me out of here with a press</em>” and for “<em>just touch this to confirm</em>”. In the shift from home button Touch ID to Face ID on iPhones and iPads, Apple has recalibrated the balance between convenience and security to be a little more secure but a little less convenient.</p>\n\n<p>But perhaps the reason Touch ID home button devices don’t qualify for this list is simply that those home buttons don’t have the direct “physical link” to the Secure Enclave that the new Touch ID buttons do (on MacBook keyboards and the new iPad Air’s side button). Perhaps they work in a way such that malware with root privileges could potentially spoof them? And, somehow, the early iPad Pro models were designed with a more secure connection between the home button and Secure Enclave?</p>\n\n<p>Face ID by itself is a good and convenient authentication system for low-security authentication. Unlocking your device, opening up a locked note in Apple Notes, viewing passwords in your Keychain, etc. But for actions that should require extra confirmation, Face ID alone isn’t enough. Consider in-app purchases — it’s not feasible to <em>just</em> use Face ID to confirm a purchase, because if you see the purchase confirmation on screen, you’re already looking at your iPhone or iPad.</p>\n\n<p>The extra confirmation for Face ID <em>could</em> be something on screen that you tap or click, but then it would be susceptible to malware that, in theory, might be on your device. Anything on screen is only as secure as iOS or MacOS itself. That’s why Apple made double-clicking the side button the confirmation for Face ID — the software running on your device cannot spoof a double-click of the side button, and the side button has a direct physical connection to the Secure Enclave that doesn’t go through the OS.</p>\n\n<p>I think this is why Face ID on Macs might prove a little tricky. If a future iMac, say, has Face ID built in, that should work fine for low-security authentications like unlocking your Mac when it wakes from sleep. But for “secure intent”, where does the physical button connected directly to a Secure Enclave go? The iMac <em>could</em> use its power button, like iOS devices do, but the power button on iMacs is on the back of the display. It’s not meant to be convenient. You want the confirmation button to be built into a keyboard, and that keyboard needs to have its own Secure Enclave to have a physical connection to the button. Bluetooth and USB are out — they both go through the OS, so they’re not secure enough. And if you need a Magic Keyboard or Apple Watch for secure intent confirmation, would it really be that convenient to have Face ID on iMacs just for unlocking the screen on wake? Maybe. But like I said, it’s tricky.</p>\n\n<p>This is true for MacBooks too. They could (and I hope someday will) add Face ID, but if they do, Face ID will likely only be used for low-security authentication, and “secure intent” will necessitate that there still be a Touch ID button <em>in addition to</em> Face ID, or that the user be wearing a trusted Apple Watch.<sup><a href=\"#fn2-2021-06-02\">2</a></sup></p>\n\n<p>In short, I suspect Apple’s biometric authentication future will be multi-sensor.</p>\n\n<div>\n<hr />\n<ol>\n\n<li>\n<p>The 2nd generation iPhone SE came after the iPhone X, and does not have Face ID, but because it shipped after the iPhone X, it should qualify for “iPhone X or later” — but it’s unclear to me if it qualifies for secure intent. I think now that the list is growing, Apple ought to list each supported device specifically. <a href=\"#fnr1-2021-06-02\">↩︎︎</a></p>\n</li>\n\n<li>\n<p>And again, think about how these confirmations work on Apple Watch: you don’t OK them on screen, you OK them with a double-click of the hardware side button, something software in WatchOS cannot spoof. <a href=\"#fnr2-2021-06-02\">↩︎</a></p>\n</li>\n\n</ol>\n</div>\n\n\n\n    ","author":"John Gruber","siteTitle":"Daring Fireball","siteHash":"fc569638025dadf22a867470f8215f38855cf50e975782a6c989909474292a36","entryHash":"40c98a40f1d2b01f4192e7109ce77d45735e2365f476aedca66aa691f725d535","category":"Tech"}