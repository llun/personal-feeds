{"title":"NodeJS :: บันทึก code แบบ blocking และ non-blocking ไว้นิดหน่อย","link":"https://www.somkiat.cc/nodejs-blocking-vs-non-blocking/","date":1612686136000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2021/02/Event-Loop-150x150.png\" class=\"attachment-post-thumbnail size-post-thumbnail wp-post-image\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/02/Event-Loop-150x150.png 150w, https://www.somkiat.cc/wp-content/uploads/2021/02/Event-Loop-75x75.png 75w\" sizes=\"(max-width: 150px) 100vw, 150px\" /></p><!-- wp:image {\"id\":21426,\"width\":548,\"height\":355,\"sizeSlug\":\"large\"} -->\n<figure class=\"wp-block-image size-large is-resized\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/02/Event-Loop-1024x664.png\" alt=\"\" class=\"wp-image-21426\" width=\"548\" height=\"355\"/></figure>\n<!-- /wp:image -->\n\n<!-- wp:paragraph -->\n<p>พอดีได้คุยเรื่องของ code ที่พัฒนาด้วย NodeJS + Express เล็กน้อย<br>ซึ่งมี code บางตัวที่น่าสนใจ<br>เนื่องจากเป็น code ที่ทำให้การทำงานมันเป็น Blocking IO ซะงั้น<br>เลยสรุปตัวอย่างไว้นิดหน่อย<br>เพื่อทำให้เห็นว่ NodeJS มันทำงานอย่างไร<br>เมื่อมีจำนวน concurrent ของผู้ใช้งานเยอะ ๆ</p>\n<!-- /wp:paragraph -->\n\n\n<span id=\"more-21421\"></span>\n\n\n<!-- wp:paragraph {\"fontSize\":\"medium\"} -->\n<p class=\"has-medium-font-size\"><strong>ตัวอย่าง code ง่าย ๆ</strong></p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p>แยกเป็น</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:list -->\n<ul><li>/ คือ router หลัก</li><li>/block คือ code ที่ทำงานแบบ blocking ซึ่งจะรอไปจบกว่าเวลาจะเกิน 1 วินาที</li><li>/non-block คือ code ที่ทำงานแบบ non-blocking แน่นอนว่าจะรอ 1 วินาทีเช่นเดียวกัน</li></ul>\n<!-- /wp:list -->\n\n<!-- wp:shortcode -->\n[gist id=\"25cdb90dded559236ad6f079ab5cfcf4\" file=\"server.js\"]\n<!-- /wp:shortcode -->\n\n<!-- wp:paragraph {\"fontSize\":\"medium\"} -->\n<p class=\"has-medium-font-size\"><strong>คำอธิบาย</strong></p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p>ระหว่าง /block และ /non-block จะได้ผลการทำงานที่แตกต่างกัน<br>เนื่องจาก NodeJS นั้นทำงานแบบ Single thread นั่นเอง<br>ถ้าเจอ code แบบ blocking เข้าไปแล้ว<br>request อื่น ๆ ก็ต้องรอเข้าคิวนั่นเอง<br>ทำให้การทำงานช้ามาก ๆ</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p><strong>ผลการทดสอบแบบง่าย ๆ</strong></p>\n<!-- /wp:paragraph -->\n\n<!-- wp:shortcode -->\n[gist id=\"25cdb90dded559236ad6f079ab5cfcf4\" file=\"result.txt\"]\n<!-- /wp:shortcode -->\n\n<!-- wp:paragraph -->\n<p>เขียน code เพื่อดูผล จะทำให้เข้าใจมากขึ้นเยอะเลย<br>ดังนั้นรูปแบบการเขียน code จึงสำคัญมากเช่นกัน</p>\n<!-- /wp:paragraph -->","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"bf2f4f6a341668453745ff2e875e06e0b7eff9918df40e556ae062f46ce81ffa","category":"Thai"}