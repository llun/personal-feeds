{"title":"Add local registry mirror to docker daemon on systemd ubuntu (after 15.04)","link":"http://visibletrap.blogspot.com/2016/05/add-local-registry-mirror-to-docker.html","date":1463646420001,"content":"After <a href=\"https://docs.docker.com/engine/installation/linux/ubuntulinux/\">docker installation</a>, follow this steps<br /><br /><ul><li>Create directory&nbsp;<span style=\"font-family: Courier New, Courier, monospace;\">/etc/systemd/system/docker.service.d</span> if not exist</li><li>Create mirror.conf file inside that directory. The name \"mirror\" can be changed to anything.</li><li>In the file, add this lines</li></ul><div><div><span style=\"font-family: Courier New, Courier, monospace; font-size: x-small;\">[Service]</span></div><div><span style=\"font-family: Courier New, Courier, monospace; font-size: x-small;\">ExecStart=</span></div><div><span style=\"font-family: Courier New, Courier, monospace; font-size: x-small;\">ExecStart=/usr/bin/docker daemon -H fd:// --registry-mirror=http://registry-host:registry-port</span></div></div><div><ul><li>registry-host is hostname/ip of your local registry mirror</li><li>registry-port is port of your local registry mirror</li><li>Flush the change with <span style=\"font-family: 'Courier New', Courier, monospace;\">$&nbsp;sudo systemctl daemon-reload</span></li><li>Restart docker with <span style=\"font-family: Courier New, Courier, monospace;\">$&nbsp;sudo systemctl restart docker</span></li><li><span style=\"font-family: Times, Times New Roman, serif;\">Check if the change is successfully applied with </span><span style=\"font-family: Courier New, Courier, monospace;\">$&nbsp;systemctl status docker</span><span style=\"font-family: Times, Times New Roman, serif;\">, &nbsp;your config should appear somewhere in the command output.</span></li></ul><div><span style=\"font-family: Times, Times New Roman, serif;\">Tested on Docker 1.11, Ubuntu 15.10 &amp; 16.04</span></div></div><div><span style=\"font-family: Times, Times New Roman, serif;\"><br /></span></div><div><span style=\"font-family: Times, Times New Roman, serif;\">If you want more explanations about these commands, please refer to follow links. Thank you for all of them for providing me a direction to solve the issue and also come up with this post.</span></div><div><ul><li><span style=\"font-family: Times, 'Times New Roman', serif;\"><a href=\"https://docs.docker.com/engine/admin/systemd/\">Control and configure Docker with systemd</a></span></li><li><a href=\"http://nknu.net/how-to-configure-docker-on-ubuntu-15-04/\">How to configure Docker on Ubuntu 15.04 (workaround)</a></li><li><a href=\"https://docs.docker.com/v1.6/articles/registry_mirror/\">Run a local registry mirror</a></li></ul></div>","author":"Tap","siteTitle":"tAp's blog","siteHash":"ec0b5758aa5280680c8b6839677ce27021dd9d4295725ce4f0e9f298aad77c91","entryHash":"48f861a4576facdcd1d168e373b8a69485c9403570fde3ebdd667e92d26e425d","category":"Tech"}