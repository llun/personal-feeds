{"title":"Announcing the Packer Data Source Component Type","link":"https://www.hashicorp.com/blog/announcing-the-packer-data-source-component-type","date":1618844400000,"content":"<p>The HashiCorp Packer team is excited to announce the release of Data Source, a new component type to fetch or compute data for use elsewhere in a Packer configuration.</p>\n<p>Starting in Packer 1.7.0, users and plugin developers will use data source plugins within HCL2-enabled build templates. As we continue to focus on favoring HCL2 over <a href=\"https://packer.io/docs/templates/legacy_json_templates\">legacy JSON templates</a>, data source components will be the first Packer feature exclusively available to HCL2.</p>\n<p>Data sources in Packer function similarly to Terraform’s data sources. Data source components fetch data from outside Packer and make detailed information about that data available to Packer HCL configuration blocks. A data source runs before any build. This allows build sources in your configuration to access the result of the data source.</p>\n<h2><a href=\"#amazon-web-services-data-sources\">»</a><a></a>Amazon Web Services Data Sources</h2>\n<p>Packer 1.7.0 includes two data sources: the <a href=\"https://www.packer.io/docs/datasources/amazon/ami\">Amazon AMI data source</a> and <a href=\"https://www.packer.io/docs/datasources/amazon/secretsmanager\">Amazon Secrets Manager data source</a>.</p>\n<p>The Amazon AMI data source filters images from the marketplace, similar to the <a href=\"https://www.packer.io/docs/builders/amazon/ebs#source_ami_filter\">source_ami_filter</a> configuration. The Amazon Secrets Manager data source retrieves secrets for the build configuration, similar to the <a href=\"https://www.packer.io/docs/templates/hcl_templates/functions/contextual/aws_secretsmanager\">aws_secretsmanager</a> configuration. Both configuration parameters will remain available for use in Packer build configuration. However, we encourage you to update your configuration to the new data source configuration for future stability.</p>\n<p>You can upgrade from legacy JSON to HCL2 with the <a href=\"https://www.packer.io/docs/commands/hcl2_upgrade\">hcl2_upgrade</a> command. This will upgrade the <code>source_ami_filter</code> and <code>aws_secretsmanager</code> options to their respective data sources.</p>\n<h2><a href=\"#using-data-sources\">»</a><a></a>Using Data Sources</h2>\n<p>You can reference a data source in <code>locals</code> and <code>sources</code> as <code>data.&lt;TYPE&gt;.&lt;NAME&gt;.&lt;ATTRIBUTE&gt;</code>. For example, you can use the Amazon Secrets Manager data source as a local variable to store the value and version of a secret.</p><pre><code>data \"amazon-secretsmanager\" \"basic-example\" {\n  name = \"my_super_secret\"\n  key  = \"my_secret_key\"\n}\n \n# usage example of the data source output\nlocals {\n  secret_value         = data.amazon-secretsmanager.basic-example.value\n  secret_version_id = data.amazon-secretsmanager.basic-example.version_id\n}</code></pre><p>You can then use the <code>local.secret_value</code> and <code>local.secret_version_id</code> anywhere in your configuration. For more information, review our documentation on <a href=\"https://www.packer.io/docs/templates/hcl_templates/datasources#using-data-sources\">using data sources</a>.</p>\n<h2><a href=\"#developing-a-data-source\">»</a><a></a>Developing a Data Source</h2>\n<p>You can write your own data source. Follow the instructions for <a href=\"https://www.packer.io/docs/plugins/creation/custom-datasources\">Custom Data Sources</a>.</p>\n<h2><a href=\"#upcoming-data-sources\">»</a><a></a>Upcoming Data Sources</h2>\n<p>In an upcoming Packer release, we plan to roll out two more data sources as a replacement for two of our existent functions:</p>\n<ul>\n<li><a href=\"https://www.packer.io/docs/templates/hcl_templates/functions/contextual/consul\">Consul</a></li>\n<li><a href=\"https://www.packer.io/docs/templates/hcl_templates/functions/contextual/vault\">Vault</a></li>\n</ul>\n<p>If you have any questions or feedback on Packer data sources, you can do so in our <a href=\"https://discuss.hashicorp.com/c/packer/23\">Discuss forum</a>, or <a href=\"https://github.com/hashicorp/packer/issues\">submit an issue</a>.</p>","author":"Sylvia Moss Martinez","siteTitle":"HashiCorp Blog","siteHash":"219aa6310b3388f2335eba49871f4df9581f2c58eaeb5e498363b54e835b7001","entryHash":"747d7771f09339fcb2b6369d692f9f93f8fe5daa6eaa21817f6515589514aeb0","category":"Tech"}