{"title":"0243 | upgrade centos 7 เป็น centos 8","link":"https://www.icez.net/blog/167388/upgrade-centos-7-to-centos-8","date":1581527208000,"content":"<ul>\n<li>อาจไม่ได้ผลในกรณีที่ลง software จาก repository ภายนอก</li>\n<li>ตรวจสอบให้แน่ใจว่าทุก repository ที่ใช้งานอยู่ รองรับ centos 8 ก่อนอัพเกรด</li>\n<li>backup ก่อนเสมอ</li>\n</ul>\n<p>reference: <a href=\"https://www.tecmint.com/upgrade-centos-7-to-centos-8/\">https://www.tecmint.com/upgrade-centos-7-to-centos-8/</a></p>\n<p>1) ลง epel repository</p>\n<pre>yum install epel-release -y</pre>\n<p>2) ลง package yum-utils กับ rpmconf</p>\n<pre>yum install yum-utils rpmconf</pre>\n<p>3) check ไฟล์ config ว่ามีอะไรเปลี่ยนบ้าง ให้ revert กลับมาที่ default rpm ก่อน ** ระวัง</p>\n<pre>rpmconf -a</pre>\n<p>4) cleanup package ที่ซ้ำซ้อน</p>\n<pre>package-cleanup --leaves\npackage-cleanup --orphans</pre>\n<p>5) ติดตั้ง dnf แล้วลบ yum ทิ้ง (package manager ตัวใหม่ที่มาแทน yum)</p>\n<pre>yum install dnf\ndnf -y remove yum yum-metadata-parser\nrm -Rf /etc/yum</pre>\n<p>6) upgrade package ทั้งหมดของ centos 7 ให้เป็น version ล่าสุด</p>\n<pre>dnf upgrade</pre>\n<p>7) ติดตั้ง centos release ของ centos 8 <u>ถ้าวันไหน centos 8 ออก update ก็ต้องแก้ version package ตาม</u></p>\n<pre>dnf install \\\n    http://mirror.centos.org/centos/8/BaseOS/x86_64/os/Packages/centos-repos-8.1-1.1911.0.8.el8.x86_64.rpm \\\n    http://mirror.centos.org/centos/8/BaseOS/x86_64/os/Packages/centos-gpg-keys-8.1-1.1911.0.8.el8.noarch.rpm \\\n    http://mirror.centos.org/centos/8/BaseOS/x86_64/os/Packages/centos-release-8.1-1.1911.0.8.el8.x86_64.rpm\n</pre>\n<p>8) upgrade epel repository และ repository อื่นๆ ให้เป็น package ของ centos 8</p>\n<pre>dnf -y upgrade https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</pre>\n<p>** ถ้ามีใช้งาน repository ภายนอก เช่น remi ก็ไล่ upgrade release package ของแต่ละ repository ให้หมด<br />\n9) ลบ kernel เก่าของ centos 7 ออก</p>\n<pre>rpm -e `rpm -q kernel`</pre>\n<p>10) ลบ conflict package ระหว่าง centos 7 กับ 8 (อาจมีอีก ถ้า error ตอน upgrade ในขั้นถัดไปก็มาไล่ลบ)</p>\n<pre>rpm -e --nodeps sysvinit-tools</pre>\n<p>11) <em>upgrade เป็น centos 8</em></p>\n<pre>dnf -y --releasever=8 --allowerasing --setopt=deltarpm=false distro-sync</pre>\n<p>12) ติดตั้ง kernel ใหม่</p>\n<pre>dnf -y install kernel-core</pre>\n<p>13) ติดตั้ง package ใน group minimal ของ centos 8 เพิ่มให้ครบ</p>\n<pre>dnf -y groupupdate \"Core\" \"Minimal Install\"</pre>\n<p>14) <strong>สำคัญมาก</strong> ตรวจสอบให้แน่ใจว่า SELINUX ปิดไปแล้ว (ในไฟล์ /etc/selinux/config)</p>\n<p>เสร็จแล้วก็ reboot แล้วก็สวดภาวนาได้เลยครับ</p>","author":"icez","siteTitle":"icez network","siteHash":"88787adba55f9deb5660f47c4b8baf580eb765815e4a6d536737656e8ab8bde4","entryHash":"d27c250b26a39fccd9a26384fca0d9ccd6185b07e4ed1f6907666f82affca764","category":"Thai"}