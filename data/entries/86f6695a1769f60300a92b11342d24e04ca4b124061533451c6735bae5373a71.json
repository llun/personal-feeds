{"title":"How To Port Your Web App To Microsoft Teams","link":"https://smashingmagazine.com/2021/02/port-web-app-microsoft-teams/","date":1612267200000,"content":"<p>Perhaps you are using Microsoft Teams at work and want to build an app that runs inside Teams. Or maybe you‚Äôve already published an app on another platform and want to gain more users on Teams. In this article, we‚Äôll see how to build a new web application in Teams, and how to integrate an existing one ‚Äî with just a few lines of code.</p>\n<p>You don‚Äôt need any prior experience to get started. We‚Äôll use bare-minimum HTML code and toolsets to build a Teams tab (the simplest version of an app in Teams). While you‚Äôre walking through this tutorial, if you want to dive deeper, check out the on-demand videos from <a href=\"https://aka.ms/learntogether-smashing\">Learn Together: Developing Apps for Teams</a>. It turns out that making your web application accessible where your users are already working has some benefits, including a reach of over 115 million daily active users. Let‚Äôs dive in!</p>\n<h3>Microsoft Teams as a platform</h3>\n<p>You may be familiar with Teams as a collaborative communication tool, but as a developer, you could also view it as a <strong>development platform</strong>. In fact, Teams provides an alternative way to interact with and distribute your existing web applications. This is primarily because the tool has always been designed with the web in mind. One of the <a href=\"https://channel9.msdn.com/Events/Microsoft-Learn/Learn-Together-Developing-Apps-for-Teams/Key-Benefits-of-Integrating-Web-Applications-into-Microsoft-Teams/?WT.mc_id=m365-11737-cxa\">key benefits of integrating web apps into Teams</a> is providing a more productive way for users ‚Äî your colleagues and Teams users around the world ‚Äî to get the work done.</p>\n<h3>Integration through tabs, embedded web apps</h3>\n<p>While there are many different paths to building and deploying Teams apps, one of the easiest is to integrate your existing web apps with Teams through what is called ‚Äútabs.‚Äù Tabs are basically embedded web apps created using HTML, TypeScript (or JavaScript), client-side frameworks such as React, or any server-side framework such as .NET.</p>\n<p>Tabs allow you to <strong>surface content in your app</strong> by essentially embedding a web page in Teams using <code>&lt;iframes&gt;</code>. The application was specifically designed with this capability in mind, so you can integrate existing web apps to create custom experiences for yourself, your team, and your app users.</p>\n<p>One useful feature about integrating your web apps with Teams is that you can pretty much use the developer tools you‚Äôre likely already familiar with: Git, Node.js, npm, and Visual Studio Code. To expand your apps with additional capabilities, you can use specialized tools such as the <a href=\"https://github.com/pnp/generator-teams\">Teams Yeoman generator command line tool</a> or <a href=\"https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension\">Teams Toolkit Visual Studio Code extension</a> and the <a href=\"https://docs.microsoft.com/en-us/javascript/api/overview/msteams-client?view=msteams-client-js-latest/?WT.mc_id=m365-11737-cxa\">Microsoft Teams JavaScript client SDK</a>. They allow you to retrieve additional information and enhance the content you display in your Teams tab.</p>\n<h3>Build a tab with an existing code sample</h3>\n<p>Let‚Äôs get started with the basics. (If you want to take it a step further to actually deploy your app, you can jump to the <a href=\"https://channel9.msdn.com/Events/Microsoft-Learn/Learn-Together-Developing-Apps-for-Teams/?WT.mc_id=m365-11737-cxa\">Learn Together videos</a>) to learn more.</p>\n<p>To simplify the steps, let‚Äôs take a look at a code sample, so instead of the tooling outlined above, the only things you‚Äôll need are:</p>\n<ul>\n<li>Permission to develop on Teams or a developer tenant, which you can get for free through the <a href=\"https://developer.microsoft.com/en-us/microsoft-365/dev-program/?WT.mc_id=m365-11737-cxa\">M365 Developer Program</a>,</li>\n<li>App Studio: <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/app-studio-overview?WT.mc_id=m365-11737-cxa\">install the App Studio app</a> in your Teams client</li>\n<li>Basic web development skills</li>\n</ul>\n<p>In this article, we‚Äôre going to use a web-based IDE called <a href=\"https://glitch.com/\">Glitch</a>, which allows you to host and run this project quickly in the browser, so you don‚Äôt have to worry about the tunneling or deployment at this time. For the full-scale approach from start to finish, you can check out a <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/build-your-first-app/build-first-app-overview/?WT.mc_id=m365-11737-cxa\">comprehensive tutorial on Microsoft Docs</a>, which includes examples of a slightly more advanced <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/build-your-first-app/build-messaging-extension\">messaging extension</a> or a <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/build-your-first-app/build-bot\">bot</a>.</p>\n<p>Although Glitch is a great tool for tutorial purposes, this is not a scalable environment so, in reality, you'll also need a way to deploy and host your web services. In a nutshell, while you are developing, you need to set up a local development with a localhost tunneling, such as the 3rd party tool <a href=\"https://ngrok.com/\">ngrok</a>, and for production, you'll need to deploy your app to a cloud service provider, for example, <a href=\"https://azure.microsoft.com/en-us/free/cloud-services/?WT.mc_id=m365-11737-cxa\">Microsoft Azure Web Services</a>.</p>\n<p>Also, you can use on-premises infrastructure to host your web services, but they must be publicly accessible (not behind a firewall). For this article, we will focus on how to make your web app available on Teams, so let‚Äôs go back to Glitch for now!</p>\n<p>First, let‚Äôs go to the <a href=\"https://glitch.com/~msteams-tab-minimum\">sample code page</a> and <strong>remix the project</strong>. Remixing is like forking a repo on GitHub, so it generates a copy of the project for you, letting you modify the code however you want without messing with the original.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/b8fda5fb-e33f-4306-9325-e0e3fab7cc44/6-port-web-app-microsoft-teams.png\" /></p>\n<p>Once you have your own project repo, you‚Äôll also automatically get your own web server URL. For example, if your generated project name is <code>achieved-diligent-bell</code>, your web server URL would be <a href=\"https://achieved-diligent-bell.glitch.me\">https://achieved-diligent-bell.glitch.me</a>. Of course, you can customize the name if you want.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/8688370a-8e0e-4e8b-a709-2f2f6176374a/8-port-web-app-microsoft-teams.png\" /></p>\n<p>Web services up and running, you'll need to create an <strong>app package</strong> that can be distributed and installed in Teams. The app package to be installed to the Teams client contains two icons and a JSON manifest file describe the metadata for your app, the extension points your app is using, and pointers to the services powering those extension points.</p>\n<h3>Create an app package</h3>\n<p>Now, you will need to create an app package to make your web app available in Teams. The package includes:</p>\n<pre><code>üìÅ your-app-package\n ‚îî‚îÄ‚îÄ üìÑ manifest.json\n ‚îî‚îÄ‚îÄ üñº color.png (192x192)\n ‚îî‚îÄ‚îÄ üñº outline.png (32x32)\n</code></pre>\n\n<p>When creating your app package, you can choose to create it manually or use <strong><a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/app-studio-overview/?WT.mc_id=m365-11737-cxa\">App Studio</a></strong>, which is a useful app inside Teams that helps developers make Teams apps (yes, meta indeed). App Studio will guide you through the configuration of the app and create your app manifest automatically.</p>\n<p>Once you have installed the App Studio app in your Teams client, open the app. You can launch it by clicking the three dots in the left menu bar.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/14430cc0-fc75-41c9-b0f1-2342fcd1b569/7-port-web-app-microsoft-teams.png\" /></p>\n<p>Then, click the <strong>Manifest Editor</strong> tab from the top and select <strong>Create a new app</strong>.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/f928edf0-90b4-42b6-95a8-247a92188c46/10-port-web-app-microsoft-teams.png\" /></p>\n<p>You are going to need to fill out all the required fields including the app names, descriptions, etc.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e12d1ed8-b66d-4537-8409-edf6db3c78f6/9-port-web-app-microsoft-teams.png\" /></p>\n<p>In the App URLs section, fill out your privacy and TOU web pages. In this example, we are just using the placeholder URL, <a href=\"https://example.com\">https://example.com</a>.</p>\n<p>Configure your personal tab by selecting <strong>Capabilities &gt; Tabs</strong> from the left menu.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/7631ce0b-49d3-4f8d-b052-d378c6b59e4f/2-port-web-app-microsoft-teams.png\" /></p>\n<p>Click the <strong>Add button</strong> under <strong>Add a personal tab</strong> and enter the info. Under Content URL, enter your webpage URL (in this case, it should be <code>https://[your-project-name].glitch.me/index.html</code>).</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/fe1ff88e-ad8f-49cb-b5ed-caea4d90b56e/1-port-web-app-microsoft-teams.png\" /></p>\n<p>In the index.html file has a few lines of static HTML code:</p>\n<pre><code>&lt;h1&gt;Hello world! &lt;/h1&gt;\n&lt;p&gt;This is the bare-minimum setting for MS Teams Tabs.&lt;/p&gt;\n</code></pre>\n\n<p>Feel free to tweak the content in the index.html as you want. This is the content to be displayed in your Teams client. Finally, go to <strong>Finish &gt; Test and distribute</strong>.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/5f7ed630-cbc5-401f-98c1-c032ae43cef9/4-port-web-app-microsoft-teams.png\" /></p>\n<p>If you get any errors, you‚Äôll have to go back and fix them. Otherwise, you can proceed by clicking ‚ÄúInstall‚Äù. And voil√†, now you have your own personal tab!</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/bfe2a513-63a2-46ac-bc00-2ff362cd4514/3-port-web-app-microsoft-teams.png\" /></p>\n<h3>Additional features with Teams SDK</h3>\n<p>This code sample only contains the bare minimal HTML code sample to just show you how to configure Teams to display your web app in Tabs. But of course, your web apps don‚Äôt need to be static, and you can <strong>use web frameworks such as React</strong> if you wish! (There are more deep-dive <a href=\"https://docs.microsoft.com/en-us/learn/modules/embedded-web-experiences/?WT.mc_id=m365-11737-cxa\">examples using React</a> that you can dive into as well.)</p>\n<p>Teams has its own <a href=\"https://docs.microsoft.com/en-us/javascript/api/overview/msteams-client?view=msteams-client-js-latest&amp;WT.mc_id=m365-11737-cxa\">JavaScript SDK</a> to provide additional functionality too, such as loading a configuration popup for teams, get user‚Äôs locale info, etc.</p>\n<p>One useful example is detecting the ‚Äútheme‚Äù of a Teams client ‚Äî Teams has three themes, light (default), dark, and high-contrast mode. You would think CSS should handle the theming, but remember, your web app is displayed inside of the Teams' <code>iframe</code>, so you would need to use the SDK to handle the color change.</p>\n<p>You can include the JavaScript either from <a href=\"https://www.npmjs.com/package/@microsoft/teams-js\">npm</a>:</p>\n<pre><code>npm install --save @microsoft/teams-js\n</code></pre>\n\n<p>Or include in your HTML:</p>\n<pre><code>&lt;script src=\"https://statics.teams.cdn.office.net/sdk/v1.8.0/js/MicrosoftTeams.min.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Now you can detect the current theme with the <code>getContext</code> method. And this is how you can determine the body text color:</p>\n<pre><code>microsoftTeams.initialize();\n\nmicrosoftTeams.getContext((context) =&gt; {\n  if(context.theme !== 'default') {\n    document.body.style.color = '#fff';  }\n});\n</code></pre>\n\n<p>The theme can be changed by a user after loading, so to detect the theme change event, add the following code snippet:</p>\n<pre><code>microsoftTeams.registerOnThemeChangeHandler((theme)=&gt; {\n  if(theme !== 'default') {\n    document.body.style.color = '#fff';\n    document.body.style.color = 'inherit';\n}\n});\n</code></pre>\n\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/cade413a-734b-43cc-b845-1f6a83ffaff0/5-port-web-app-microsoft-teams.png\" /></p>\n<p>Hopefully, this simple tutorial helped you to get started with the first steps. If you‚Äôd like to continue developing for Teams, you can add more capabilities such as adding Teams-native UI components, search features, <strong>messaging extensions</strong>, and conversational bots, to build more interactive applications.</p>\n<p>For a comprehensive guide using the recommended toolsets (Visual Studio Code, Yeoman Generator, etc.), check out <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/overview/?WT.mc_id=m365-11737-cxa\">Teams Developer Docs</a> where you can learn more about tabs, messaging extensions, bots, webhooks, and the other capabilities that the Teams developer platform provides.</p>\n<h3>Next Steps</h3>\n<p>With just a few clicks, you can integrate your apps into Teams and create new experiences for your users. And once you‚Äôve developed apps and deployed them to Teams, you‚Äôll have the potential of reaching a wide audience of users that use Teams daily.</p>\n<p>You can <a href=\"https://docs.microsoft.com/en-us/learn/paths/m365-msteams-associate/?WT.mc_id=m365-11737-cxa\">get started building today</a> or <a href=\"https://aka.ms/learntogether-smashing\">learn more from Learn Together: Developing Apps for Teams</a> with on-demand videos and demos all around building apps for Teams.</p>","author":"","siteTitle":"Articles on Smashing Magazine ‚Äî For Web Designers And Developers","siteHash":"ab069ca35bf300e9db0da36f49701f66485a5b0d2db0471dfeee07cef6204939","entryHash":"86f6695a1769f60300a92b11342d24e04ca4b124061533451c6735bae5373a71","category":"Tech"}