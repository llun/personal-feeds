{"title":"How Redux Reducers Work","link":"https://smashingmagazine.com/2020/12/how-redux-reducers-work/","date":1607958000000,"content":"<p>In this tutorial, we’re going to learn the concept of reducers and how they work, specifically in React applications. In order to understand and better use Redux, a solid understanding of reducers is essential. Reducers provide a way to update an application’s state using an action. It is an integral part of the Redux library. </p>\n<p>This tutorial is for developers who want to learn more about Redux Reducers. An understanding of React and Redux would be beneficial. At the end of the tutorial, you should have a better understanding of the role Reducers play in Redux. We’ll be writing code demos and an application to better understand Reducers and how it affects the state in an application. </p>\n<h3>What Is A Reducer</h3>\n<p>A Reducer is a pure function that takes the state of an application and action as arguments and returns a new state. For example, an authentication reducer can take an initial state of an application in form of an empty object and an action that tells it that a user has logged in and returned a new application state with a logged-in user.</p>\n<p>Pure functions are functions that do not have any side effects and will return the same results if the same arguments are passed in.</p>\n<p>Below is an example of a pure function:</p>\n<pre><code>const add = (x, y) =&gt; x + y;\n\nadd(2, 5);</code></pre>\n\n<p>The example above returns a value based on the inputs, if you pass <code>2</code> and <code>5</code> then you’d always get <code>7</code>, as long as it's the same input nothing else affects the output you get, that’s an example of a pure function. </p>\n<p>Below is an example of a reducer function that takes in a state and an action.</p>\n<pre><code>const initialState = {};\nconst cartReducer = (state = initialState, action) =&gt; {\n  // Do something here\n}</code></pre>\n\n<p>Let’s define the two parameters that a reducer takes in, <code>state</code> and <code>action</code>. </p>\n<h3>State</h3>\n<p>A <strong>state</strong> is the data that your component(s) is working with — it holds the data that a component requires and it dictates what a component renders. Once a <code>state</code> object changes, the component re-renders. If an application state is managed by Redux, then the reducer is where state changes happen.</p>\n<h3>Action</h3>\n<p>An <strong>action,</strong> is an object that contains the payload of information. They are the only source of information for the Redux store to be updated. Reducers update store based on the value of the <code>action.type</code>. Here we will define the <code>action.type</code> as <code>ADD_TO_CART</code>.</p>\n<p>According to the official Redux <a href=\"https://redux.js.org/introduction/getting-started\">documentation</a>, actions are the only things that trigger changes in a Redux application, they contain the payload for changes to an application store. Actions are JavaScript objects that tell Redux the type of action to be performed, usually they’re defined as functions like the one below:</p>\n<pre><code>const action = {\n  type: 'ADD_TO_CART',\n  payload: {\n    product: 'margarine',\n    quantity: 4\n  }\n}</code></pre>\n\n<p>The code above is a typical <code>payload</code> value that contains what a user is sending and it will be used to update the state of the application. As you can see from above, the action object contains the type of action and a payload object that would be necessary for this particular action to be performed.</p>\n<h3>Updating State Using Reducers</h3>\n<p>To show how reducers work, let’s look at the number counter below:</p>\n<pre><code>const increaseAction = {\n  type: 'INCREASE',\n}; \n\nconst decreaseAction = {\n  type: 'DECREASE'\n}; \n\n\nconst countReducer = (state = 0, action) =&gt; {\n  switch(action.type){\n  case INCREASE: \n    return state + 1;\n\n  case DECREASE : \n    return state -1;\n\n  default: \n return state;\n\n  }\n};</code></pre>\n\n<p>In the code above, <code>increaseAction</code> and <code>decreaseAction</code> are actions used in the reducer to determine what the <code>state</code> is updated to. Next, we have a reducer function called <code>countReducer</code>, which takes in an <code>action</code> and an initial <code>state</code> whose value is <code>0</code>. If the value of <code>action.type</code> is <code>INCREASE</code>, we return a new state that is incremented by 1, else if it is <code>DECREASE</code> a new state that is decremented by 1 is returned. In cases where none of those conditions are meant, we return <code>state</code>.</p>\n<h3>Updating State Using Reducers: The Spread Operator</h3>\n<p>State can’t be directly changed, to create or update state, we can use the JavaScript <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax\">spread operator</a> to make sure we don’t change the value of the state directly but instead to return a new object that contains a state passed to it and the payload of the user. </p>\n<pre><code>const contactAction = {\n  type: 'GET_CONTACT',\n  payload: ['0801234567', '0901234567']\n};\n\nconst initialState = {\n  contacts: [],\n  contact: {},\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case GET_CONTACTS: \n      return {\n        ...state,\n        contacts: action.payload,\n    };\n  default: \n    return state;\n  }</code></pre>\n\n<p>In the code above, we are using a spread operator to make sure we don’t change the state value directly, this way we can return a new object that is filled with the state that is passed to it and the payload that’s sent by the user. By using a spread operator, we can make sure that the state stays the same as we add all new items to it and also replace the contacts field in the state if it was present before. </p>\n<h3>Redux Reducers In Action — A Demo</h3>\n<p>To better understand Redux Reducers and how they work, we will be implementing a simple Movie details finder app, the code and working version can be found here on <a href=\"https://codesandbox.io/s/eager-austin-er0th\">Codesandbox</a>. To get started, go to your terminal and initialize a react app using the command below: </p>\n<pre><code>create-react-app movie-detail-finder</code></pre>\n\n<p>Once our project initialized, next let’s install the packages we’d need for our application. </p>\n<pre><code>npm i axios reactstrap react-redux redux redux-thunk</code></pre>\n\n<p>Once, the packages are installed, let’s start our development server using the command:</p>\n<pre><code>npm start</code></pre>\n\n<p>The above command should start our project development server in our browser. Next let’s open our project in our text editor of choice, inside our project <code>src</code> folder, delete the following files: <code>App.css</code>, <code>App.test.js</code>, <code>serviceWorker.js</code> and <code>setupTests.js</code>. Next, let’s delete all code that references the deleted files on our <code>App.js</code>. </p>\n<p>For this project, we will be using Open Movie Database API to get our movie information, content and images for our application, <a href=\"http://www.omdbapi.com/\">here</a> is a link to the API, you’d need to register and get access keys in order to use it for this application, Once you’re done, let’s proceed with our application by building components. </p>\n<h3>Building App Components</h3>\n<p>First, inside of our <code>src</code> folder in our project directory, create a folder called components and inside the folder, let’s create two folders called <code>Movie</code> and <code>Searchbar</code>, our component should look like the image below:</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/68466ef6-ebe4-40dc-98b1-ddd0da5bbe1e/1-redux-reducers-work.png\" /></p>\n<h3>Building Movie Component</h3>\n<p>Let’s build the <code>Movies</code> component, which will outline the structure of the movie details we will be getting from our API. To do this, inside the <code>Movies</code> folder of our component, create a new file <code>Movie.js</code>, next create a class based component for the API results, let’s do that below.</p>\n<div>\n<pre><code>import React, { Component } from 'react';\nimport { Card, CardImg, CardText, CardBody, ListGroup, ListGroupItem, Badge } from 'reactstrap';\nimport styles from './Movie.module.css';\n\nclass Movie extends Component{\n    render(){\n        if(this.props.movie){\n            return (\n                &lt;div className={styles.Movie}&gt;\n                    &lt;h3 className=\"text-center my-4\"&gt;\n                      Movie Name: {this.props.movie.Title}\n                    &lt;/h3&gt;\n                    &lt;Card className=\"text-primary bg-dark\"&gt;\n                        &lt;CardImg className={styles.Img}\n                          top src={this.props.movie.Poster} \n                          alt={this.props.movie.Title}/&gt;\n                        &lt;CardBody&gt;\n                            &lt;ListGroup className=\"bg-dark\"&gt;\n                              &lt;ListGroupItem&gt;\n                                &lt;Badge color=\"primary\"&gt;Actors:&lt;/Badge&gt;\n                                  {this.props.movie.Actors}\n                                  &lt;/ListGroupItem&gt;\n                          &lt;ListGroupItem&gt;\n                            &lt;Badge color=\"primary\"&gt;Genre:&lt;/Badge&gt;\n                            {this.props.movie.Genre}\n                          &lt;/ListGroupItem&gt;\n                          &lt;ListGroupItem&gt;\n                            &lt;Badge color=\"primary\"&gt;Year:&lt;/Badge&gt;\n                            {this.props.movie.Year}\n                          &lt;/ListGroupItem&gt;\n                          &lt;ListGroupItem&gt;\n                            &lt;Badge color=\"primary\"&gt;Writer(s):&lt;/Badge&gt; \n                            {this.props.movie.Writer}\n                          &lt;/ListGroupItem&gt;\n                        &lt;ListGroupItem&gt;\n                          &lt;Badge color=\"primary\"&gt;IMDB Rating:&lt;/Badge&gt; \n                            {this.props.movie.imdbRating}/10\n                        &lt;/ListGroupItem&gt;\n                    &lt;/ListGroup&gt;\n                      &lt;CardText className=\"mt-3 text-white\"&gt;\n                        &lt;Badge color=\"secondary\"&gt;Plot:&lt;/Badge&gt;\n                          {this.props.movie.Plot}\n                        &lt;/CardText&gt;\n                      &lt;/CardBody&gt;\n                    &lt;/Card&gt;\n                &lt;/div&gt;\n            )\n        }\n        return null\n    }\n}\nexport default Movie;</code></pre>\n</div>\n\n<p>In the code above, Using components from the package <code>reactstrap</code>, you can check out the documentation <a href=\"https://reactstrap.github.io/\">here</a>. We built a Card component that includes the movie name, Image, genre, actor, year, movie writer, rating, and plot. To make it easier to pass data from this component, we built data to be as props to other components. Next, let’s build our <code>Searchbar</code> component. </p>\n<h3>Building Our Searchbar Component</h3>\n<p>Our <code>Searchbar</code> component will feature a search bar and a button component for searching movie components, let’s do this below:</p>\n<div>\n<pre><code>import React from 'react';\nimport styles from './Searchbar.module.css';\nimport { connect } from 'react-redux';\nimport { fetchMovie } from '../../actions';\nimport Movie from '../Movie/Movie';\n\nclass Searchbar extends React.Component{\nrender(){\n        return(\n            &lt;div className={styles.Form}&gt;\n                &lt;div&gt;\n                    &lt;form onSubmit={this.formHandler}&gt;\n                        &lt;input \n                            type=\"text\" \n                            placeholder=\"Movie Title\" \n                            onChange={e =&gt; this.setState({title: e.target.value})}\n                            value={this.state.title}/&gt;\n                        &lt;button type=\"submit\"&gt;Search&lt;/button&gt;\n                    &lt;/form&gt;\n                &lt;/div&gt;\n                &lt;Movie movie={this.props.movie}/&gt;\n            &lt;/div&gt;\n        )\n    }\n}</code></pre>\n</div>\n\n<p>In the code above, we are importing <a href=\"https://react-redux.js.org/api/connect\"><code>connect</code></a> from <code>react-redux</code> which is used to connect a React component to the Redux store, provides the component with information from the store and also provides functions used to dispatch actions to the store. Next, we imported the <code>Movie</code> component and a function <code>fetchMovie</code> from actions.</p>\n<p>Next, we have a form tag with an input box for entering our movie titles, using the <code>setState</code> hook from React, we added an <code>onChange</code> event and value that will set the state of <code>title</code> to the value entered in the input box. We have a <code>button</code> tag to search for movie titles and using the <code>Movie</code> component that we imported, we passed the properties of the component as <code>props</code> to the result of the search. </p>\n<p>Next for us is to write a function to submit our movie title to the API in order to send results to us, we also need to set the initial state of the application. let’s do that below.</p>\n<pre><code>class Searchbar extends React.Component{\n\n    state = {\n        title: ''\n    }\n    formHandler = (event) =&gt; {\n        event.preventDefault();\n        this.props.fetchMovie(this.state.title);\n        this.setState({title: ''});\n    }\n</code></pre>\n\n<p>Here, we set the initial state of the application to empty strings, we created a function <code>formHandler</code> that takes in an event parameter and passes the <code>fetchMovie</code> function from action and setting the title as the new state of the application. To complete our application, let’s export this component using the connect property from <code>react-redux</code>, to do this we’d use the react redux <code>mapToStateProps</code> property to select the part of the data our component would need, you can learn more about <code>mapToStateProps</code> <a href=\"https://react-redux.js.org/using-react-redux/connect-mapstate\">here.</a></p>\n<div>\n<pre><code>const mapStateToProps = (state) =&gt; {\n    return { movie: state.movie }\n}\nexport default connect(mapStateToProps, { fetchMovie })(Searchbar)</code></pre>\n</div>\n\n<p>Let’s add styles to our form by creating a file <code>Searchbar.module.css</code> and adding the styles below:</p>\n<pre><code>.Form{\n  margin: 3rem auto;\n  width: 80%;\n  height: 100%;\n}\ninput{\n  display: block;\n  height: 45px;\n  border: none;\n  width: 100%;\n  border-radius: 0.5rem;\n  outline: none;\n  padding: 0 1rem;\n}\ninput:focus, select:focus{\n  border: 2px rgb(16, 204, 179) solid;\n}\n\n.Form button{\n  display: block;\n  background: rgb(16, 204, 179);\n  padding: 0.7rem;\n  border-radius: 0.5rem;\n  width: 20%;\n  margin-top: 0.7rem;\n  color: #FFF;\n  border: none;\n  text-decoration: none;\n  transition: all 0.5s;\n}\nbutton:hover{\n  opacity: 0.6;\n}\n@media(max-width: 700px){\n  input{\n      height: 40px;\n      padding: 0 1rem;\n  }\n  .Form button{\n      width: 40%;\n      padding: 0.6rem;\n  }\n}</code></pre>\n\n<p>Once we’ve done the above, our search bar component should look similar to the image below:</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/c56fdf22-3a46-4bdc-985e-f2e5b25530ae/3-redux-reducers-work.png\" /></p>\n<h3>Creating Actions For Application</h3>\n<p>In this component, we will be setting up Redux actions for our application, First, inside the <code>src</code> directory, create a folder named <code>actions</code> and inside the folder, we’d create an <code>index.js</code> file. Here we’d create a function <code>fetchMovie</code> that takes in a title parameter, and fetches movie from the API using Axios. Let’s do this below:</p>\n<div>\n<pre><code>import axios from 'axios';\n\nexport const fetchMovie = (title) =&gt;\n    async (dispatch) =&gt; {\n        const response = await \n          axios.get(\n            <code>https://cors-anywhere.herokuapp.com/http://www.omdbapi.com/?t=${title}&amp;apikey=APIKEY</code>);\n        dispatch({\n            type: 'FETCH_MOVIE',\n            payload: response.data\n        })\n    }</code></pre>\n</div>\n\n<p>In the code above, we imported <code>axios</code> and created a function called <code>fetchMovie</code> which takes in a <code>title</code> parameter by using async/await so that we can make a request to the API server. We have a <code>dispatch</code> function that dispatches to the Redux the action object that is passed to it. From what we have above, we’re dispatching an action with the type <code>FETCH_MOVIE</code> and the payload that contains the response we got from the API.</p>\n<p><strong>NOTE:</strong> <em>The <code>apikey</code> in the request will be replaced with your own <code>apikey</code> after registering at</em> <a href=\"http://www.omdbapi.com/\"><em>OmdbAPI</em></a>.</p>\n<h3>Creating App Reducers</h3>\n<p>In this section, we are going to create reducers for our application.</p>\n<pre><code>\nconst fetchMovieReducer = (state = null, action) =&gt; {\n    switch(action.type){\n        case 'FETCH_MOVIE':\n            return action.payload;\n        default:\n            return state;\n    }\n}\nconst rootReducer = (state, action) =&gt; {\n    return { \n        movie: fetchMovieReducer(state, action)\n    }\n}\nexport default rootReducer;</code></pre>\n\n<p>In the code above, we created a <code>fetchMovieReducer</code> that takes in a default state of <code>null</code> and an <code>action</code> parameter, using a switch operator, for case <code>FETCH_MOVIE</code> we will return the value of the <code>action.payload</code> which is the movie we got from the API. If the action we tried performing isn’t in the reducer, then we return our default state. </p>\n<p>Next, we created a <code>rootReducer</code> function that will accept the current state and an action as input and returns the <code>fetchMovieReducer</code>.</p>\n<h3>Putting It Together</h3>\n<p>In this section, we’d finish our app by creating our redux store in the <code>index.js</code>, let’s do that below:</p>\n<pre><code>import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './index.css';\nimport reducers from './reducers';\n\nconst store = createStore(reducers, applyMiddleware(thunk))\nReactDOM.render(\n    &lt;Provider store={store}&gt;\n        &lt;&gt;\n          &lt;App/&gt;\n        &lt;/&gt;\n    &lt;/Provider&gt;,\n    document.getElementById('root')\n)</code></pre>\n\n<p>In the code above, we created the application <code>store</code> using the <code>createStore</code> method by passing the reducer we created and a middleware. <a href=\"https://redux.js.org/tutorials/fundamentals/part-4-store#middleware\">Middlewares</a> are addons that allow us to enhance the functionalities of Redux. Here we are making use of the <a href=\"https://github.com/reduxjs/redux-thunk\">Redux Thunk</a> middleware using <a href=\"https://redux.js.org/api/applymiddleware\"><code>applyMiddleware</code></a>. The Redux Thunk middleware is necessary for our store to do asynchronous updates. This is needed because by default, Redux updates the store synchronously.</p>\n<p>To make sure our application knows the exact store to use, we wrapped our application in a <code>Provider</code> component and passed the store as a prop, by doing this, other components in our application can connect and share information with the store. </p>\n<p>Let’s add a bit of style to our <code>index.css</code> file.</p>\n<pre><code>*{\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\nbody{\n  background: rgb(15, 10, 34);\n  color: #FFF;\n  height: 100vh;\n  max-width: 100%;\n}</code></pre>\n\n<h3>Rendering And Testing A Movie Detail Finder</h3>\n<p>In this section, we are going to conclude our application by rendering our application in our <code>App.js</code>, to do this, let’s create a class-based component named <code>App</code> and initialize our Searchbar and input field.</p>\n<pre><code>import React from 'react';\nimport Searchbar from './components/Searchbar/Searchbar';\nimport styles from './App.module.css';\nclass App extends React.Component{\n\n    render(){\n        return(\n            &lt;div className={styles.App}&gt;\n                &lt;h1 className={styles.Title}&gt;Movies Search App&lt;/h1&gt;\n                &lt;Searchbar/&gt;\n            &lt;/div&gt;\n\n        )\n    }\n}\nexport default App;</code></pre>\n\n<p>Here, we created an App class based component with a <code>h1</code> that says Movie Search App and added our <code>Searchbar</code> component. Our application should look like the image below:</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/00999061-70c0-40c1-b872-dc49c64d8e98/2-redux-reducers-work.png\" /></p>\n<p>A working demo is available on Codesandbox.</p>\n\n\n<h3>Conclusion</h3>\n<p>Reducers are an important part of Redux state management, with reducers we can write pure functions to update specific areas of our Redux applications without side effects. We’ve learned the basics of Redux reducers, their uses, and the core concept of reducers, state, and arguments. </p>\n<p>You can take this further by seeing the documentation on Redux reducers <a href=\"https://redux.js.org/basics/reducers\">here</a>. You can take this further and build more on Redux reducers, let me know what you build. </p>\n<h4>Resources</h4>\n<ul>\n<li><a href=\"https://react-redux.js.org/\">React-Redux documentation</a></li>\n<li><a href=\"https://redux.js.org/\">Redux documentation</a></li>\n<li><a href=\"https://react-redux.js.org/api/connect\"><code>connect()</code> function</a></li>\n<li><a href=\"https://redux.js.org/api/applymiddleware\"><code>applyMiddleware</code> function</a></li>\n</ul>","author":"","siteTitle":"Articles on Smashing Magazine — For Web Designers And Developers","siteHash":"ab069ca35bf300e9db0da36f49701f66485a5b0d2db0471dfeee07cef6204939","entryHash":"78406e01d74845202b055ff8b2da28e56011e36e535da98c6905f79ff6eaf368","category":"Tech"}