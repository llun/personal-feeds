{"title":"How to Get Started with Amazon Route 53 Resolver DNS Firewall for Amazon VPC","link":"https://aws.amazon.com/blogs/aws/how-to-get-started-with-amazon-route-53-resolver-dns-firewall-for-amazon-vpc/","date":1617223840000,"content":"<p>A DNS lookup is typically the starting point for establishing outbound connections within a network. Unwanted direct communication between <a href=\"https://aws.amazon.com/vpc/\" title=\"\">Amazon Virtual Private Cloud (VPC)</a> resources and internet services could be prevented using AWS services like security groups, <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html\">network access control lists</a> (ACLs) or <a href=\"https://aws.amazon.com/network-firewall\" title=\"\">AWS Network Firewall</a>. These services filter network traffic, but they do not block outbound DNS requests heading to the <a href=\"https://aws.amazon.com/route53/\" title=\"\">Amazon Route 53</a> <a href=\"https://aws.amazon.com/blogs/aws/new-amazon-route-53-resolver-for-hybrid-clouds/\">Resolver</a> that automatically answers DNS queries for public DNS records, <a href=\"https://aws.amazon.com/vpc/\" title=\"\">Amazon Virtual Private Cloud (VPC)</a> – specific DNS names, and Amazon Route 53 private hosted zones.</p> \n<p>DNS exfiltration could potentially allow a bad actor to extract data through a DNS query to a domain they control. For instance, if a bad actor controlled the domain “example.com” and wanted to exfiltrate “sensitive-data,” they could issue a DNS lookup for “sensitive-data.example.com” from a compromised instance within a VPC. To prevent this, previously customers needed to incur costs to operate their own DNS servers in order to filter DNS lookups for malicious activity.</p> \n<p>Today I am happy to announce <a href=\"https://aws.amazon.com/route53\">Amazon Route 53 Resolver DNS Firewall</a> (DNS Firewall) that enables you to defend against these types of DNS-level threats. With DNS Firewall, you can protect against data exfiltration attempts by defining domain name allowlists that allow resources within your <a href=\"https://aws.amazon.com/vpc/\" title=\"\">Amazon Virtual Private Cloud (VPC)</a> to make outbound DNS requests only for the sites your organization trusts.</p> \n<p>You can block malicious domains, denying DNS requests for known bad names such as phishing domains. DNS Firewall is fully integrated with <a href=\"https://aws.amazon.com/firewall-manager/\" title=\"\">AWS Firewall Manager</a>, giving security administrators a central place to enable, monitor and audit firewall activity across all their VPCs and AWS accounts in <a href=\"https://aws.amazon.com/organizations/\" title=\"\">AWS Organizations</a>. DNS Firewall is also integrated with <a href=\"https://aws.amazon.com/blogs/aws/log-your-vpc-dns-queries-with-route-53-resolver-query-logs/\">Route 53 Resolver Query Logs</a>, <a href=\"https://aws.amazon.com/cloudwatch/\" title=\"\">Amazon CloudWatch</a>, and <a href=\"https://aws.amazon.com/blogs/aws/simplified-time-series-analysis-with-amazon-cloudwatch-contributor-insights/\">CloudWatch Contributor Insights</a> that can analyze your firewall’s logs. You also have access to AWS Managed Domain Lists for protections against common threats like malware and botnets.</p> \n<p><strong><u>How to Use Amazon Route 53 Resolver DNS Firewall</u></strong><br /> You can get started with DNS Firewall in the <a href=\"https://console.aws.amazon.com\" title=\"\">AWS Management Console</a>, <a href=\"https://aws.amazon.com/cli/\" title=\"\">AWS Command Line Interface (CLI)</a>, and <a href=\"https://aws.amazon.com/tools/\" title=\"\">AWS SDKs</a>, where you can create domain lists and rules as well as configure rule actions and enable AWS Managed Rules. In the left navigation pane in the VPC or Route 53 console, expand <strong>DNS Firewall</strong> and then choose <strong>Rule Groups</strong> in the menu.</p> \n<p><img class=\"aligncenter size-full wp-image-50467\" style=\"border: solid 1px #ccc;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-1.png\" alt=\"\" width=\"2310\" height=\"798\" /></p> \n<p>To get started, choose <strong>Add rule group</strong> and input the group name and description.</p> \n<p><img class=\"aligncenter size-full wp-image-50468\" style=\"border: solid 1px #ccc;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-2.png\" alt=\"\" width=\"1918\" height=\"920\" /></p> \n<p>Rules define how to answer DNS requests. They define domain names to look for and the action to take when a DNS query matches one of the names.</p> \n<p>Similar to <a href=\"https://aws.amazon.com/waf\" title=\"\">AWS Web Application Firewall</a> and AWS Network Firewall, a rule group is an object used to store a set of rules. Each rule consists of two key components: (a) a domain list, which is the list of domain names that you wish to block or allow private query resolution for, and (b) an action, which is the response you configure a rule to take if one of the domains within your domain list is queried.</p> \n<p><img class=\"aligncenter size-full wp-image-50470\" style=\"border: solid 1px #ccc; width: 90%;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-3.png\" alt=\"\" width=\"1496\" height=\"1356\" /></p> \n<p>For domain lists, two types of domains are supported: wildcard domains (subdomains of some domain, e.g. *.example.com) and fully qualified domain names (FQDNs) which are the complete domain names for a specific host (e.g. foo.example.com).</p> \n<p>You can configure one action per rule, and it gives you flexibility in configuring the actions most aligned to your organizations’ security posture. For allowlists, you can choose an allow action, and for denylists, you can choose a block action.</p> \n<p>When configuring a block action, by default a NODATA response is chosen, which means there is no response available for the requested domain name. If this default response is not suitable for your use case, you can modify it and select from either an OVERRIDE or NXDOMAIN response. An override allows you to configure the custom DNS record to send the query of a malicious domain to a “sinkhole”<b> </b>and provide a custom message explaining why the action occurred. An NXDOMAIN response is an error message which denotes a domain does not exist.</p> \n<p>For either an allowlist or a denylist, you also have the option to enable an ALERT response which allows you to monitor rule activity. This is useful when you wish to test a rule or rule group before deploying it into production.</p> \n<p>When you finish creating a rule group, you can see details and associate VPCs.</p> \n<p><img class=\"aligncenter size-full wp-image-50471\" style=\"border: solid 1px #ccc;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-5.png\" alt=\"\" width=\"1430\" height=\"1416\" /></p> \n<p>To associate your VPCs, select <strong>Associate VPC</strong>. You will be able to associate up to 5 rule groups with a VPC.</p> \n<p><img class=\"aligncenter size-full wp-image-50465\" style=\"border: solid 1px #ccc; width: 70%;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-6.png\" alt=\"\" width=\"1338\" height=\"690\" /></p> \n<p><strong><u>Enforcing Route 53 Resolver DNS Firewall Rules </u></strong><br /> You are able to create a DNS Firewall policy from within the <a href=\"https://aws.amazon.com/firewall-manager/\">AWS Firewall Manager</a>, a security management service which allows you to centrally configure and manage firewall rules across your accounts and applications in <a href=\"https://aws.amazon.com/organizations/\" title=\"\">AWS Organizations</a>. With Firewall Manager, your security administrator can deploy a baseline set of VPC security group rules for EC2 instances, Application Load Balancers (ALBs) and Elastic Network Interfaces (ENIs) in your AWS accounts and VPCs.</p> \n<p>To get started with Firewall Manager for DNS Firewall, you’ll need to complete the <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/fms-prereq.html\">prerequisites</a> as a security administrator belonging to a central security and compliance team.</p> \n<p><img class=\"aligncenter size-full wp-image-50472\" style=\"border: solid 1px #ccc;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-7.png\" alt=\"\" width=\"2736\" height=\"723\" /></p> \n<p>The DNS Firewall policy you create allows you to specify the rule groups you want to associate to the VPCs within your organization as well as the priority these rule groups should be assigned. You can include or exclude accounts, organizational units (OUs) and VPCs (tagged), from having the DNS Firewall rules. Once this policy is configured and associated to your AWS Organization, all accounts are immediately within its purview.</p> \n<p>If a new account is added to the organization, Firewall Manager automatically applies the policy and the rule group(s) to the VPCs in the account that are under the scope of the policy. Rule groups can be added with a specific priority reserved for Firewall Manager, preventing individual developers/accounts from overriding those rules at the account level.</p> \n<p><img class=\"aligncenter size-full wp-image-50473\" style=\"border: solid 1px #ccc;\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/02/24/2021-dns-firewall-8.png\" alt=\"\" width=\"3274\" height=\"1690\" /></p> \n<p><strong><u>Available Now</u></strong><br /> Amazon Route 53 Resolver DNS Firewall is now available in US East (N. Virginia), US West (Oregon), EU (Ireland), Asia Pacific (Mumbai) with all other AWS commercial regions and AWS GovCloud (US) Regions rolling out over the next few days. <em>(<strong>Update April 7, 2021 –</strong> Amazon Route 53 Resolver DNS Firewall is now available in all AWS commercial regions and AWS GovCloud (US) regions.)</em></p> \n<p>Take a look at the <a href=\"https://aws.amazon.com/route53\">product page</a>, <a href=\"https://aws.amazon.com/route53/pricing\">pricing</a>, and <a href=\"https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html\">documentation</a> to learn more. Give this a try, and please send us feedback either through your usual AWS Support contacts or the <a href=\"https://forums.aws.amazon.com/forum.jspa?forumID=58\">AWS forum</a> for Amazon VPC or Route 53.</p> \n<p><strong>Learn all the details about Amazon Route 53 Resolver DNS Firewall and <a href=\"https://aws.amazon.com/route53/?sc_detail=blog_cta1\">get started</a> with the new feature today.</strong></p> \n<p>— <a href=\"https://twitter.com/channyun\">Channy</a></p>","author":"Channy Yun","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"2967d50fc7029f8e10a37b2e837dd09f8f47c7ded82b5b65b1a3bde44cd68167","category":"Tech"}