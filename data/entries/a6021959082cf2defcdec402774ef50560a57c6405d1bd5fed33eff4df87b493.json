{"title":"How to Use Channel Assembly with AWS Elemental MediaTailor to Launch Virtual Channels from Existing Sources","link":"https://aws.amazon.com/blogs/aws/how-to-use-channel-assembly-with-aws-elemental-mediatailor-to-launch-virtual-channels-from-existing-sources/","date":1615502023000,"content":"<p>If you’re a broadcaster or Over-the-Top (OTT) channel operator, you can now create virtual channels by pulling together programming from multiple existing on-demand sources and blending them into a linear playlist.</p> \n<p>Creating a customized channel for a smaller audience group — such as a category of viewers based on interest, or regional preferences — was traditionally prohibitively expensive due to the cost to transcode the media for online streaming and the complexity of discovering and curating existing media in the catalog.</p> \n<p><a href=\"https://aws.amazon.com/mediatailor/\">AWS Elemental MediaTailor</a> Channel Assembly&nbsp;now allows you to create static or dynamic playlists to stream content to viewers by reusing already transcoded video segments from your existing catalogs. It eliminates the need to re-transcode source content for multiple regional or viewer permutations.</p> \n<p>You can select between multiple scheduling options, such as loop content, or dynamically add programs in the schedule, either manually, or by inserting a program lineup provided by a recommendation engine. You can also schedule ad breaks with intelligent program-aware rules.</p> \n<p><strong><span style=\"text-decoration: underline;\">How to Get Started with AWS Elemental MediaTailor<br /> </span></strong>Let’s assume I want to create a new streaming channel by assembling one HLS- and one DASH-packaged stream using content I already have. The content must be encoded and packaged with similar characteristics, such as the same number of bit-rate tiers and the same parameters at each level (codec, resolution, frame rate etc.). I can use <a href=\"https://aws.amazon.com/mediaconvert/\">AWS Elemental MediaConvert</a> to prepare the content and store it on <a href=\"https://aws.amazon.com/s3/\" title=\"\">Amazon Simple Storage Service (S3)</a>. The source formats supported are HLS, DASH and CMAF (with HLS and DASH manifests). For this example, the content is available through my CDN; without surprise, I am using <a href=\"https://aws.amazon.com/cloudfront/\" title=\"\">Amazon CloudFront</a>.</p> \n<p>The first step is to define the source of my content and to register each individual asset I want to include in the schedule. In the AWS Elemental MediaTailor console, under <strong>Channel Assembly</strong>, I click <strong>Create source location</strong>:</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-21-31.png\"><img class=\"aligncenter size-full wp-image-50651\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-21-31.png\" alt=\"Elemental Channel Assembly - Create Source Location\" width=\"1900\" height=\"1454\" /></a></p> \n<p>and then I add my video sources:</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-52-21.png\"><img class=\"aligncenter size-full wp-image-50652\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-52-21.png\" alt=\"MediaTailor Channel Assembly add VOD source\" width=\"1900\" height=\"1614\" /></a></p> \n<p>or with the <a href=\"https://aws.amazon.com/cli/\" title=\"\">AWS Command Line Interface (CLI)</a></p> \n<pre><code class=\"lang-bash\"># Create a Source Origin\naws mediatailor create-source-location \\\n    --source-location-name NewsBlogSourceLocation\n    --http-configuration \\\n           BaseUrl=https://dyye954rrfxy8.cloudfront.net // &lt;-- this is my CloudFront distribution DNS name\n{\n    &quot;Arn&quot;: &quot;arn:aws:mediatailor:us-west-2:1234567890:sourceLocation/NewsBlogSourceLocation&quot;,\n    &quot;CreationTime&quot;: 1614660822156,\n    &quot;HttpConfiguration&quot;: {\n        &quot;BaseUrl&quot;: &quot;https://dyye954rrfxy8.cloudfront.net&quot;\n    },\n    &quot;LastModifiedTime&quot;: 1614660822156,\n    &quot;Name&quot;: &quot;NewsBlogSourceLocation&quot;\n}\t\t   \n\n# Register two video assets\naws mediatailor create-vod-source \\\n    --source-location-name NewsBlogSourceLocation \\\n    --vod-source-name MyFirstVodSource \\\n    --http-package-configurations \\\n        Id=hls,Path=/out/v1/24247f7e7f2942509058713671dce466/209b7701f2224791a9a44440e6e5b9e0/e2fdd7d6ae5f4e41ac57089be4de2d02/index.m3u8,SourceGroup=hls,Type=HLS \\\n        Id=cmaf,Path=/out/v1/24247f7e7f2942509058713671dce466/d71309185897405383031fd7d4515198/8901ed3df0e842c99fd8523c5b935d2f/index.m3u8,SourceGroup=cmaf,Type=HLS\n{\n    &quot;Arn&quot;: &quot;arn:aws:mediatailor-gamma:us-west-2:898676505562:vodSource/NewsBlogSourceLocation/MyFirstVodSource&quot;,\n    &quot;CreationTime&quot;: 1614661120839,\n    &quot;HttpPackageConfigurations&quot;: [\n        {\n            &quot;Id&quot;: &quot;hls&quot;,\n            &quot;Path&quot;: &quot;/out/v1/24247f7e7f2942509058713671dce466/209b7701f2224791a9a44440e6e5b9e0/e2fdd7d6ae5f4e41ac57089be4de2d02/index.m3u8&quot;,\n            &quot;SourceGroup&quot;: &quot;hls&quot;,\n            &quot;Type&quot;: &quot;HLS&quot;\n        },\n        {\n            &quot;Id&quot;: &quot;cmaf&quot;,\n            &quot;Path&quot;: &quot;/out/v1/24247f7e7f2942509058713671dce466/d71309185897405383031fd7d4515198/8901ed3df0e842c99fd8523c5b935d2f/index.m3u8&quot;,\n            &quot;SourceGroup&quot;: &quot;cmaf&quot;,\n            &quot;Type&quot;: &quot;HLS&quot;\n        }\n    ],\n    &quot;LastModifiedTime&quot;: 1614661120839,\n    &quot;Name&quot;: &quot;MyFirstVodSource&quot;,\n    &quot;SourceLocationName&quot;: &quot;NewsBlogSourceLocation&quot;\n}\n\naws mediatailor create-vod-source \\\n    --source-location-name NewsBlogSourceLocation \\\n    --vod-source-name MySecondVodSource \\\n    --http-package-configurations \\\n        Id=hls,Path=/out/v1/5bc2c7b8a384403681222f703c6dd3ee/209b7701f2224791a9a44440e6e5b9e0/e2fdd7d6ae5f4e41ac57089be4de2d02/index.m3u8,SourceGroup=hls,Type=HLS \\\n        Id=cmaf,Path=/out/v1/5bc2c7b8a384403681222f703c6dd3ee/d71309185897405383031fd7d4515198/8901ed3df0e842c99fd8523c5b935d2f/index.m3u8,SourceGroup=cmaf,Type=HLS\n\n{ ... } \n</code></pre> \n<p>The second step is to create the channel, define the channel outputs, and the channel access permissions.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-52-59.png\"><img class=\"aligncenter size-full wp-image-50653\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-52-59.png\" alt=\"MediaTailor Channel Assembly create channel step 1\" width=\"2544\" height=\"1136\" /></a></p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-54-52.png\"><img class=\"aligncenter size-full wp-image-50654\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-54-52.png\" alt=\"MediaTailor Channel Assembly create channel step 2\" width=\"2524\" height=\"1582\" /></a></p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-56-05.png\"><img class=\"aligncenter size-full wp-image-50655\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-56-05.png\" alt=\"MediaTailor Channel Assembly create channel step 3\" width=\"2508\" height=\"1662\" /></a></p> \n<p>Do not forget to replace your actual AWS Account Id and AWS Region name.</p> \n<p>You can automate the above with the <span title=\"CLI\">CLI</span>:</p> \n<pre><code class=\"lang-bash\"># Create the channel\naws mediatailor create-channel \\\n    --channel-name NewsBlogChannel \\\n    --playback-mode LOOP \\\n    --outputs \\\n        HlsPlaylistSettings={ManifestWindowSeconds=30},ManifestName=index,SourceGroup=hls  \\\n        HlsPlaylistSettings={ManifestWindowSeconds=30},ManifestName=cmaf,SourceGroup=cmaf\n\n{ ... } \n\n# define the channel access permissions\n# do not forget to replace *MY ACCOUNT ID* with your actual AWS Account ID. Also adjust the AWS Region name.\naws mediatailor put-channel-policy \\\n    --channel-name NewsBlogChannel \\\n    --policy &quot;{ \\&quot;Version\\&quot;: \\&quot;2012-10-17\\&quot;, \\&quot;Statement\\&quot;: [ { \\&quot;Sid\\&quot;: \\&quot;AllowAnonymous\\&quot;, \\&quot;Effect\\&quot;: \\&quot;Allow\\&quot;, \\&quot;Principal\\&quot;: \\&quot;*\\&quot;, \\&quot;Action\\&quot;: \\&quot;mediatailor:GetManifest\\&quot;, \\&quot;Resource\\&quot;: \\&quot;arn:aws:mediatailor:us-west-2:*MY ACCOUNT_ID*:channel/NewsBlogChannel\\&quot; } ] }&quot;\n</code></pre> \n<p>The third and last step before starting the channel is to add the video sources. This can be done once for all or adjusted dynamically as viewers are watching the stream. A program is a combination of an asset and a moment in the schedule. I can add programs wherever I need: before or after other programs.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-57-28.png\"><img class=\"aligncenter size-full wp-image-50656\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_09-57-28.png\" alt=\"MediaTailor Channel Assembly create program\" width=\"1908\" height=\"1174\" /></a></p> \n<p>Or I can automate this using the <span title=\"CLI\">CLI</span>:</p> \n<pre><code class=\"lang-bash\">aws mediatailor create-program \\\n    --channel-name NewsBlogChannel \\\n    --schedule-configuration &quot;Transition={Type=RELATIVE,RelativePosition=AFTER_PROGRAM}&quot; \\\n    --program-name MyFirstProgram \\\n    --vod-source-name MyFirstVodSource \\\n    --source-location NewsBlogSourceLocation\n{\n    &quot;AdBreaks&quot;: [],\n    &quot;Arn&quot;: &quot;arn:aws:mediatailor:us-west-2:1234567890:program/NewsBlogChannel/MyFirstProgram&quot;,\n    &quot;ChannelName&quot;: &quot;NewsBlogChannel&quot;,\n    &quot;CreationTime&quot;: 1614661735435,\n    &quot;LastModifiedTime&quot;: 1614661735435,\n    &quot;Name&quot;: &quot;MyFirstProgram&quot;,\n    &quot;SourceLocationName&quot;: &quot;NewsBlogSourceLocation&quot;,\n    &quot;VodSourceName&quot;: &quot;MyFirstVodSource&quot;\n}\n\naws mediatailor create-program \\\n    --channel-name NewsBlogChannel \\\n    --schedule-configuration &quot;Transition={Type=RELATIVE,RelativePosition=AFTER_PROGRAM,RelativeProgram=MyFirstProgram}&quot; \\\n    --program-name MySecondProgram \\\n    --vod-source-name MySecondVodSource \\\n    --source-location NewsBlogSourceLocation \n{ ... }\t\n\n</code></pre> \n<p>Finally, I start the channel. The billing starts at this point.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_10-01-31.png\"><img class=\"aligncenter size-full wp-image-50658\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/03/10/2021-03-10_10-01-31.png\" alt=\"MediaTailor Channel Assembly Start Channel\" width=\"2642\" height=\"904\" /></a></p> \n<p>At any time, I can call describe-channel to get the channel endpoints; one per output format.</p> \n<pre><code class=\"lang-bash\">aws mediatailor start-channel \\\n    --channel-name NewsBlogChannel\n\naws mediatailor describe-channel \\\n    --channel-name NewsBlogChannel\n\n{\n    &quot;Arn&quot;: &quot;arn:aws:mediatailor:us-west-2:1234567890:channel/MyFirstChannel&quot;,\n    &quot;ChannelState&quot;: &quot;RUNNING&quot;,\n    &quot;CreationTime&quot;: 1613709143819,\n    &quot;Name&quot;: &quot;MyFirstChannel&quot;,\n    &quot;Outputs&quot;: [\n        {\n            &quot;HlsPlaylistSettings&quot;: {\n                &quot;ManifestWindowSeconds&quot;: 30\n            },\n            &quot;ManifestName&quot;: &quot;index&quot;,\n            &quot;PlaybackUrl&quot;: &quot;https://abc123.abc123.channel-assembly.mediatailor.us-west-2.amazonaws.com/v1/channel/NewsBlogChannel/index.m3u8&quot;,\n            &quot;SourceGroup&quot;: &quot;hls&quot;\n        },\n        {\n            &quot;HlsPlaylistSettings&quot;: {\n                &quot;ManifestWindowSeconds&quot;: 30\n            },\n            &quot;ManifestName&quot;: &quot;cmaf&quot;,\n            &quot;PlaybackUrl&quot;: &quot;https://abc123.abc123.channel-assembly.mediatailor.us-west-2.amazonaws.com/v1/channel/NewsBlogChannel/cmaf.m3u8&quot;,\n            &quot;SourceGroup&quot;: &quot;cmaf&quot;\n        }\n    ],\n    &quot;PlaybackMode&quot;: &quot;LOOP&quot;\n}\n</code></pre> \n<p>I can test my channel by opening the endpoint in a compatible client, such as a modern web browser (I tested it with Safari) or <a href=\"https://ffmpeg.org/ffplay.html\">ffplay</a>. The <a href=\"https://docs.aws.amazon.com/mediatailor/latest/ug/channel-assembly.html\">documentation</a>&nbsp;has more advanced examples, including how to add ad breaks or how to create a <a href=\"https://aws.amazon.com/cloudfront/\" title=\"\">CloudFront</a> configuration to distribute your stream in one single step.</p> \n<p>If you applied the commands above on your AWS Account, do not forget to stop the channel after your test, to avoid accruing charges.</p> \n<p>As usual, there are no upfront costs; you only pay for what you use. Pricing starts at $0.10 / channel-hour for on-demand assets. This is the equivalent of $73 /channel-month if you run the channel 24/7.</p> \n<p>AWS Elemental MediaTailor Channel Assembly is available in <span title=\"\">US East (N. Virginia)</span>, <span title=\"\">US West (Oregon)</span>, <span title=\"\">Asia Pacific (Singapore)</span>, <span title=\"\">Asia Pacific (Sydney)</span>, <span title=\"\">Asia Pacific (Tokyo)</span>, <span title=\"\">Europe (Frankfurt)</span>, and <span title=\"\">Europe (Ireland)</span>. <strong><a href=\"https://console.aws.amazon.com/mediatailor/home\">You can start to use it today</a></strong>.</p>","author":"Sébastien Stormacq","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"a6021959082cf2defcdec402774ef50560a57c6405d1bd5fed33eff4df87b493","category":"Tech"}